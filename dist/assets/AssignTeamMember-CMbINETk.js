import{r as l,a as R,a3 as E,j as e,L as C,c as T}from"./index-D7vkFnLn.js";import{C as N}from"./circle-alert-BUcyu1XV.js";import{L as F}from"./loader-circle-BXw_pTkx.js";import{S as D}from"./send-B9bxkpkA.js";function q(){const[f,g]=l.useState(""),[v,b]=l.useState(!1),[i,h]=l.useState(""),[u,m]=l.useState(""),[n,y]=l.useState(!1),[w,M]=l.useState([]),[c,S]=l.useState(!1),d=k(),p=R(t=>t.user);function k(){const t=new URLSearchParams(E().search),o={};for(const[a,s]of t.entries())o[a]=s;return o}l.useEffect(()=>{(async()=>{var o;try{if(S(!0),m(""),!p||!p.schema_name)throw new Error("User schema not found. Please log in again.");const a=p.schema_name,j=(await T.post("https://click.wa.expert/api/data/getAllData",{schemaName:a,tableName:"team_member"})).data.data;if(Array.isArray(j))M(j);else throw new Error("Invalid data format received")}catch(a){let s="Failed to load team members. ";a.response?s+=`Server error (${a.response.status}): ${((o=a.response.data)==null?void 0:o.error)||a.response.statusText}`:a.request?s+="Please check if the server is running.":s+=a.message,m(s)}finally{S(!1)}})()},[p]);const I=d.columnName||"assigned_to",L=d.commentColumn||"assigned_to_comment",z=t=>{h(t.target.value),u&&m("")},A=async t=>{var o;if(t.preventDefault(),!i){m("Please select a team member");return}try{y(!0);const s=`https://click.wa.expert/api/data/updateMultiple?${new URLSearchParams({...d,schemaName:p.schema_name,tableName:d.tableName,recordId:d.recordId,ownerId:d.ownerId,col1:I,val1:i,col2:L,val2:f}).toString()}`;await T.get(s),b(!0),setTimeout(()=>{h(""),g(""),b(!1)},2e3)}catch(a){let s="Failed to submit. ";a.response?s+=`Server error: ${((o=a.response.data)==null?void 0:o.error)||a.response.statusText}`:s+="Please try again.",m(s)}finally{y(!1)}};return e.jsxs("div",{style:r.container,children:[e.jsx("img",{src:"https://clicarity.s3.eu-north-1.amazonaws.com/logo.png",alt:"logo",style:r.logo}),e.jsx("h2",{style:r.heading,children:"Assign Team Member"}),u&&!n&&e.jsxs("div",{style:r.errorBanner,children:[e.jsx(N,{size:18}),e.jsx("span",{children:u})]}),e.jsxs("form",{onSubmit:A,style:r.form,children:[e.jsxs("div",{style:r.inputGroup,children:[e.jsxs(C,{htmlFor:"team-member",style:r.inputLabel,children:["Select Team Member ",e.jsx("span",{style:r.required,children:"*"})]}),c?e.jsxs("div",{style:r.loadingContainer,children:[e.jsx(F,{size:20,style:r.loadingIcon}),e.jsx("span",{style:r.loadingText,children:"Loading team members..."})]}):e.jsxs("select",{id:"team-member",value:i,onChange:z,style:{...r.select,...u&&!i&&!n?r.inputError:{}},disabled:n||c,children:[e.jsx("option",{value:"",children:"-- Select Team Member --"}),w.map((t,o)=>e.jsx("option",{value:t.name||t.id,children:t.name?t.name.charAt(0).toUpperCase()+t.name.slice(1):`Member ${o+1}`},t.id||o))]})]}),e.jsxs("div",{style:r.inputGroup,children:[e.jsx(C,{htmlFor:"comment",style:r.inputLabel,children:"Comment / Notes (Optional)"}),e.jsx("textarea",{id:"comment",value:f,onChange:t=>g(t.target.value),placeholder:"Add any additional notes...",style:r.textarea,rows:4,disabled:n})]}),e.jsx("button",{type:"submit",style:{...r.button,...n||!i||c?r.buttonDisabled:{}},disabled:n||!i||c,onMouseEnter:t=>{!n&&i&&!c&&(t.currentTarget.style.backgroundColor="#3182ce",t.currentTarget.style.transform="translateY(-2px)",t.currentTarget.style.boxShadow="0 4px 12px rgba(67, 136, 193, 0.4)")},onMouseLeave:t=>{!n&&i&&!c&&(t.currentTarget.style.backgroundColor="#4388c1",t.currentTarget.style.transform="translateY(0)",t.currentTarget.style.boxShadow="none")},children:e.jsx("div",{style:r.buttonContent,children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:r.spinner}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:16}),"Assign Team Member"]})})})]}),v&&e.jsx("div",{style:r.successMessage,children:e.jsx("p",{style:r.successText,children:"Team member assigned successfully!"})})]})}const r={container:{maxWidth:"540px",margin:"40px auto",padding:"40px",border:"1px solid #e2e8f0",borderRadius:"16px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05), 0 10px 15px rgba(0, 0, 0, 0.05)",display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"#ffffff",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},logo:{width:"20rem",height:"auto",marginBottom:"2rem"},heading:{textAlign:"center",marginBottom:"24px",color:"#2d3748",fontWeight:"700",fontSize:"24px",lineHeight:"1.3"},errorBanner:{width:"100%",padding:"12px 16px",backgroundColor:"#fed7d7",border:"1px solid #fc8181",borderRadius:"8px",color:"#742a2a",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",marginBottom:"24px"},form:{display:"flex",flexDirection:"column",width:"100%",gap:"24px"},inputGroup:{display:"flex",flexDirection:"column",gap:"8px"},inputLabel:{fontSize:"14px",fontWeight:"600",color:"#2d3748",marginBottom:"4px"},required:{color:"#e53e3e",marginLeft:"4px"},loadingContainer:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",borderRadius:"8px",border:"1px solid #cbd5e0",backgroundColor:"#f7fafc"},loadingIcon:{color:"#4388c1",animation:"spin 1s linear infinite"},loadingText:{fontSize:"14px",color:"#718096"},select:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #cbd5e0",fontSize:"15px",transition:"all 0.2s ease",outline:"none",backgroundColor:"#ffffff",cursor:"pointer",color:"#2d3748"},textarea:{padding:"12px 16px",borderRadius:"8px",border:"1px solid #cbd5e0",fontSize:"14px",transition:"border-color 0.2s ease",outline:"none",fontFamily:"inherit",resize:"vertical",lineHeight:"1.5"},inputError:{borderColor:"#fc8181",backgroundColor:"#fff5f5"},button:{padding:"14px 24px",fontSize:"16px",fontWeight:"600",border:"none",borderRadius:"8px",backgroundColor:"#4388c1",color:"#ffffff",cursor:"pointer",transition:"all 0.2s ease",outline:"none",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"52px",marginTop:"8px"},buttonDisabled:{backgroundColor:"#cbd5e0",cursor:"not-allowed",opacity:.6},buttonContent:{display:"flex",alignItems:"center",gap:"8px"},spinner:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 1s linear infinite"},successMessage:{marginTop:"24px",padding:"16px 24px",backgroundColor:"#c6f6d5",border:"1px solid #9ae6b4",borderRadius:"8px",width:"100%"},successText:{color:"#22543d",fontSize:"15px",fontWeight:"600",textAlign:"center",margin:0}},x=document.createElement("style");x.type="text/css";x.innerText=`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`;document.head.appendChild(x);export{q as default};
