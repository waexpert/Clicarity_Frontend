var xs=Object.defineProperty;var bs=(r,a,n)=>a in r?xs(r,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[a]=n;var Tt=(r,a,n)=>bs(r,typeof a!="symbol"?a+"":a,n);import{e as zt,R as tt,j as e,C as Bt,g as qt,h as Ht,k as Vt,B as ee,$ as ws,c as _e,r as l,a0 as W,U as Wt,a5 as _s,V as ys,a7 as Gt,W as Cs,aa as js,ab as Ss,Z as Xe,a as wt,L as qe,I as Fe,y as Ns,i as vs,l as Se,z as Es,P as ks,aW as Rs,A as Ds,p as pt,q as mt,t as gt,v as xt,w as Ke,ac as Kt,ad as Xt,aX as Ts,ae as Yt,af as jt,aY as It,ag as St,aZ as Qt,aU as Is,T as Zt,a_ as Os,aG as Jt,_ as As,ao as Fs}from"./index-CxXEh7ic.js";import{R as es}from"./refresh-cw-DxwKJmGh.js";import{A as Ls}from"./CustomTable-Bj10YSil.js";import{D as vt,b as Et,c as st,d as rt,f as at,e as ht}from"./dialog-CnRl0O6T.js";import{C as ts}from"./checkbox-DU8fzN43.js";import{S as Ps}from"./sliders-horizontal-6_aJrOM2.js";import{T as Ms,a as $s,b as ct,c as Ot,d as Us,e as dt}from"./table-BXv9wrlh.js";import{T as zs}from"./textarea-D3RGGRuG.js";import{C as Bs}from"./chevron-left-CB-7lt7Z.js";import{C as qs}from"./chevron-right-C9TqF1BH.js";import"./index-CSR42yF3.js";/**
 * @license lucide-react v0.574.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M8 3H3v5",key:"15dfkv"}],["path",{d:"M12 22v-8.3a4 4 0 0 0-1.172-2.872L3 3",key:"1qrqzj"}],["path",{d:"m15 9 6-6",key:"ko1vev"}]],Vs=zt("split",Hs);/**
 * @license lucide-react v0.574.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Gs=zt("triangle-alert",Ws);class Ks extends tt.Component{constructor(n){super(n);Tt(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,i){this.setState({error:n,errorInfo:i})}render(){return this.state.hasError?e.jsxs(Bt,{className:"mx-[6rem] mt-8",children:[e.jsx(qt,{children:e.jsxs(Ht,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(Gs,{className:"h-5 w-5"}),"Something went wrong"]})}),e.jsxs(Vt,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"The table encountered an error. Please try refreshing the page."}),!1,e.jsx(ee,{onClick:this.handleReset,children:"Reload Page"})]})]}):this.props.children}}var ft={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var Xs=ft.exports,At;function Ys(){return At||(At=1,function(r,a){((n,i)=>{r.exports=i()})(Xs,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},d,m=!i.document&&!!i.postMessage,h=i.IS_PAPA_WORKER||!1,v={},C=0,o={};function g(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(s){var c=te(s);c.chunkSize=parseInt(c.chunkSize),s.step||s.chunk||(c.chunkSize=null),this._handle=new p(c),(this._handle.streamer=this)._config=c}).call(this,t),this.parseChunk=function(s,c){var b=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<b){let O=this._config.newline;O||(_=this._config.quoteChar||'"',O=this._handle.guessLineEndings(s,_)),s=[...s.split(O).slice(b)].join(O)}this.isFirstChunk&&y(this._config.beforeFirstChunk)&&(_=this._config.beforeFirstChunk(s))!==void 0&&(s=_),this.isFirstChunk=!1,this._halted=!1;var b=this._partialLine+s,_=(this._partialLine="",this._handle.parse(b,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(s=_.meta.cursor,b=(this._finished||(this._partialLine=b.substring(s-this._baseIndex),this._baseIndex=s),_&&_.data&&(this._rowCount+=_.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),h)i.postMessage({results:_,workerId:o.WORKER_ID,finished:b});else if(y(this._config.chunk)&&!c){if(this._config.chunk(_,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=_=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(_.data),this._completeResults.errors=this._completeResults.errors.concat(_.errors),this._completeResults.meta=_.meta),this._completed||!b||!y(this._config.complete)||_&&_.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),b||_&&_.meta.paused||this._nextChunk(),_}this._halted=!0},this._sendError=function(s){y(this._config.error)?this._config.error(s):h&&this._config.error&&i.postMessage({workerId:o.WORKER_ID,error:s,finished:!1})}}function N(t){var s;(t=t||{}).chunkSize||(t.chunkSize=o.RemoteChunkSize),g.call(this,t),this._nextChunk=m?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),m||(s.onload=G(this._chunkLoaded,this),s.onerror=G(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!m),this._config.downloadRequestHeaders){var c,b=this._config.downloadRequestHeaders;for(c in b)s.setRequestHeader(c,b[c])}var _;this._config.chunkSize&&(_=this._start+this._config.chunkSize-1,s.setRequestHeader("Range","bytes="+this._start+"-"+_));try{s.send(this._config.downloadRequestBody)}catch(O){this._chunkError(O.message)}m&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize||s.responseText.length,this._finished=!this._config.chunkSize||this._start>=(c=>(c=c.getResponseHeader("Content-Range"))!==null?parseInt(c.substring(c.lastIndexOf("/")+1)):-1)(s),this.parseChunk(s.responseText)))},this._chunkError=function(c){c=s.statusText||c,this._sendError(new Error(c))}}function P(t){(t=t||{}).chunkSize||(t.chunkSize=o.LocalChunkSize),g.call(this,t);var s,c,b=typeof FileReader<"u";this.stream=function(_){this._input=_,c=_.slice||_.webkitSlice||_.mozSlice,b?((s=new FileReader).onload=G(this._chunkLoaded,this),s.onerror=G(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var _=this._input,O=(this._config.chunkSize&&(O=Math.min(this._start+this._config.chunkSize,this._input.size),_=c.call(_,this._start,O)),s.readAsText(_,this._config.encoding));b||this._chunkLoaded({target:{result:O}})},this._chunkLoaded=function(_){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(_.target.result)},this._chunkError=function(){this._sendError(s.error)}}function k(t){var s;g.call(this,t=t||{}),this.stream=function(c){return s=c,this._nextChunk()},this._nextChunk=function(){var c,b;if(!this._finished)return c=this._config.chunkSize,s=c?(b=s.substring(0,c),s.substring(c)):(b=s,""),this._finished=!s,this.parseChunk(b)}}function u(t){g.call(this,t=t||{});var s=[],c=!0,b=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(_){this._input=_,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){b&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):c=!0},this._streamData=G(function(_){try{s.push(typeof _=="string"?_:_.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(O){this._streamError(O)}},this),this._streamError=G(function(_){this._streamCleanUp(),this._sendError(_)},this),this._streamEnd=G(function(){this._streamCleanUp(),b=!0,this._streamData("")},this),this._streamCleanUp=G(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(t){var s,c,b,_,O=Math.pow(2,53),ue=-O,ye=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ie=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,U=this,Z=0,E=0,xe=!1,M=!1,L=[],j={data:[],errors:[],meta:{}};function oe(T){return t.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function se(){if(j&&b&&(be("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),b=!1),t.skipEmptyLines&&(j.data=j.data.filter(function(A){return!oe(A)})),pe()){let A=function(ce,fe){y(t.transformHeader)&&(ce=t.transformHeader(ce,fe)),L.push(ce)};if(j)if(Array.isArray(j.data[0])){for(var T=0;pe()&&T<j.data.length;T++)j.data[T].forEach(A);j.data.splice(0,1)}else j.data.forEach(A)}function H(A,ce){for(var fe=t.header?{}:[],Y=0;Y<A.length;Y++){var K=Y,B=A[Y],B=((Ee,I)=>(ae=>(t.dynamicTypingFunction&&t.dynamicTyping[ae]===void 0&&(t.dynamicTyping[ae]=t.dynamicTypingFunction(ae)),(t.dynamicTyping[ae]||t.dynamicTyping)===!0))(Ee)?I==="true"||I==="TRUE"||I!=="false"&&I!=="FALSE"&&((ae=>{if(ye.test(ae)&&(ae=parseFloat(ae),ue<ae&&ae<O))return 1})(I)?parseFloat(I):ie.test(I)?new Date(I):I===""?null:I):I)(K=t.header?Y>=L.length?"__parsed_extra":L[Y]:K,B=t.transform?t.transform(B,K):B);K==="__parsed_extra"?(fe[K]=fe[K]||[],fe[K].push(B)):fe[K]=B}return t.header&&(Y>L.length?be("FieldMismatch","TooManyFields","Too many fields: expected "+L.length+" fields but parsed "+Y,E+ce):Y<L.length&&be("FieldMismatch","TooFewFields","Too few fields: expected "+L.length+" fields but parsed "+Y,E+ce)),fe}var le;j&&(t.header||t.dynamicTyping||t.transform)&&(le=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(H),le=j.data.length):j.data=H(j.data,0),t.header&&j.meta&&(j.meta.fields=L),E+=le)}function pe(){return t.header&&L.length===0}function be(T,H,le,A){T={type:T,code:H,message:le},A!==void 0&&(T.row=A),j.errors.push(T)}y(t.step)&&(_=t.step,t.step=function(T){j=T,pe()?se():(se(),j.data.length!==0&&(Z+=T.data.length,t.preview&&Z>t.preview?c.abort():(j.data=j.data[0],_(j,U))))}),this.parse=function(T,H,le){var A=t.quoteChar||'"',A=(t.newline||(t.newline=this.guessLineEndings(T,A)),b=!1,t.delimiter?y(t.delimiter)&&(t.delimiter=t.delimiter(T),j.meta.delimiter=t.delimiter):((A=((ce,fe,Y,K,B)=>{var Ee,I,ae,Ae;B=B||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Pe=0;Pe<B.length;Pe++){for(var ke,Me=B[Pe],me=0,Re=0,we=0,Ce=(ae=void 0,new z({comments:K,delimiter:Me,newline:fe,preview:10}).parse(ce)),Oe=0;Oe<Ce.data.length;Oe++)Y&&oe(Ce.data[Oe])?we++:(ke=Ce.data[Oe].length,Re+=ke,ae===void 0?ae=ke:0<ke&&(me+=Math.abs(ke-ae),ae=ke));0<Ce.data.length&&(Re/=Ce.data.length-we),(I===void 0||me<=I)&&(Ae===void 0||Ae<Re)&&1.99<Re&&(I=me,Ee=Me,Ae=Re)}return{successful:!!(t.delimiter=Ee),bestDelimiter:Ee}})(T,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=A.bestDelimiter:(b=!0,t.delimiter=o.DefaultDelimiter),j.meta.delimiter=t.delimiter),te(t));return t.preview&&t.header&&A.preview++,s=T,c=new z(A),j=c.parse(s,H,le),se(),xe?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return xe},this.pause=function(){xe=!0,c.abort(),s=y(t.chunk)?"":s.substring(c.getCharIndex())},this.resume=function(){U.streamer._halted?(xe=!1,U.streamer.parseChunk(s,!0)):setTimeout(U.resume,3)},this.aborted=function(){return M},this.abort=function(){M=!0,c.abort(),j.meta.aborted=!0,y(t.complete)&&t.complete(j),s=""},this.guessLineEndings=function(ce,A){ce=ce.substring(0,1048576);var A=new RegExp(x(A)+"([^]*?)"+x(A),"gm"),le=(ce=ce.replace(A,"")).split("\r"),A=ce.split(`
`),ce=1<A.length&&A[0].length<le[0].length;if(le.length===1||ce)return`
`;for(var fe=0,Y=0;Y<le.length;Y++)le[Y][0]===`
`&&fe++;return fe>=le.length/2?`\r
`:"\r"}}function x(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function z(t){var s=(t=t||{}).delimiter,c=t.newline,b=t.comments,_=t.step,O=t.preview,ue=t.fastMode,ye=null,ie=!1,U=t.quoteChar==null?'"':t.quoteChar,Z=U;if(t.escapeChar!==void 0&&(Z=t.escapeChar),(typeof s!="string"||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=","),b===s)throw new Error("Comment character same as delimiter");b===!0?b="#":(typeof b!="string"||-1<o.BAD_DELIMITERS.indexOf(b))&&(b=!1),c!==`
`&&c!=="\r"&&c!==`\r
`&&(c=`
`);var E=0,xe=!1;this.parse=function(M,L,j){if(typeof M!="string")throw new Error("Input must be a string");var oe=M.length,se=s.length,pe=c.length,be=b.length,T=y(_),H=[],le=[],A=[],ce=E=0;if(!M)return me();if(ue||ue!==!1&&M.indexOf(U)===-1){for(var fe=M.split(c),Y=0;Y<fe.length;Y++){if(A=fe[Y],E+=A.length,Y!==fe.length-1)E+=c.length;else if(j)return me();if(!b||A.substring(0,be)!==b){if(T){if(H=[],Ae(A.split(s)),Re(),xe)return me()}else Ae(A.split(s));if(O&&O<=Y)return H=H.slice(0,O),me(!0)}}return me()}for(var K=M.indexOf(s,E),B=M.indexOf(c,E),Ee=new RegExp(x(Z)+x(U),"g"),I=M.indexOf(U,E);;)if(M[E]===U)for(I=E,E++;;){if((I=M.indexOf(U,I+1))===-1)return j||le.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:H.length,index:E}),ke();if(I===oe-1)return ke(M.substring(E,I).replace(Ee,U));if(U===Z&&M[I+1]===Z)I++;else if(U===Z||I===0||M[I-1]!==Z){K!==-1&&K<I+1&&(K=M.indexOf(s,I+1));var ae=Pe((B=B!==-1&&B<I+1?M.indexOf(c,I+1):B)===-1?K:Math.min(K,B));if(M.substr(I+1+ae,se)===s){A.push(M.substring(E,I).replace(Ee,U)),M[E=I+1+ae+se]!==U&&(I=M.indexOf(U,E)),K=M.indexOf(s,E),B=M.indexOf(c,E);break}if(ae=Pe(B),M.substring(I+1+ae,I+1+ae+pe)===c){if(A.push(M.substring(E,I).replace(Ee,U)),Me(I+1+ae+pe),K=M.indexOf(s,E),I=M.indexOf(U,E),T&&(Re(),xe))return me();if(O&&H.length>=O)return me(!0);break}le.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:H.length,index:E}),I++}}else if(b&&A.length===0&&M.substring(E,E+be)===b){if(B===-1)return me();E=B+pe,B=M.indexOf(c,E),K=M.indexOf(s,E)}else if(K!==-1&&(K<B||B===-1))A.push(M.substring(E,K)),E=K+se,K=M.indexOf(s,E);else{if(B===-1)break;if(A.push(M.substring(E,B)),Me(B+pe),T&&(Re(),xe))return me();if(O&&H.length>=O)return me(!0)}return ke();function Ae(we){H.push(we),ce=E}function Pe(we){var Ce=0;return Ce=we!==-1&&(we=M.substring(I+1,we))&&we.trim()===""?we.length:Ce}function ke(we){return j||(we===void 0&&(we=M.substring(E)),A.push(we),E=oe,Ae(A),T&&Re()),me()}function Me(we){E=we,Ae(A),A=[],B=M.indexOf(c,E)}function me(we){if(t.header&&!L&&H.length&&!ie){var Ce=H[0],Oe={},He=new Set(Ce);let Ue=!1;for(let De=0;De<Ce.length;De++){let Te=Ce[De];if(Oe[Te=y(t.transformHeader)?t.transformHeader(Te,De):Te]){let ze,Ve=Oe[Te];for(;ze=Te+"_"+Ve,Ve++,He.has(ze););He.add(ze),Ce[De]=ze,Oe[Te]++,Ue=!0,(ye=ye===null?{}:ye)[ze]=Te}else Oe[Te]=1,Ce[De]=Te;He.add(Te)}ie=!0}return{data:H,errors:le,meta:{delimiter:s,linebreak:c,aborted:xe,truncated:!!we,cursor:ce+(L||0),renamedHeaders:ye}}}function Re(){_(me()),H=[],le=[]}},this.abort=function(){xe=!0},this.getCharIndex=function(){return E}}function re(t){var s=t.data,c=v[s.workerId],b=!1;if(s.error)c.userError(s.error,s.file);else if(s.results&&s.results.data){var _={abort:function(){b=!0,D(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:q,resume:q};if(y(c.userStep)){for(var O=0;O<s.results.data.length&&(c.userStep({data:s.results.data[O],errors:s.results.errors,meta:s.results.meta},_),!b);O++);delete s.results}else y(c.userChunk)&&(c.userChunk(s.results,_,s.file),delete s.results)}s.finished&&!b&&D(s.workerId,s.results)}function D(t,s){var c=v[t];y(c.userComplete)&&c.userComplete(s),c.terminate(),delete v[t]}function q(){throw new Error("Not implemented.")}function te(t){if(typeof t!="object"||t===null)return t;var s,c=Array.isArray(t)?[]:{};for(s in t)c[s]=te(t[s]);return c}function G(t,s){return function(){t.apply(s,arguments)}}function y(t){return typeof t=="function"}return o.parse=function(t,s){var c=(s=s||{}).dynamicTyping||!1;if(y(c)&&(s.dynamicTypingFunction=c,c={}),s.dynamicTyping=c,s.transform=!!y(s.transform)&&s.transform,!s.worker||!o.WORKERS_SUPPORTED)return c=null,o.NODE_STREAM_INPUT,typeof t=="string"?(t=(b=>b.charCodeAt(0)!==65279?b:b.slice(1))(t),c=new(s.download?N:k)(s)):t.readable===!0&&y(t.read)&&y(t.on)?c=new u(s):(i.File&&t instanceof File||t instanceof Object)&&(c=new P(s)),c.stream(t);(c=(()=>{var b;return!!o.WORKERS_SUPPORTED&&(b=(()=>{var _=i.URL||i.webkitURL||null,O=n.toString();return o.BLOB_URL||(o.BLOB_URL=_.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",O,")();"],{type:"text/javascript"})))})(),(b=new i.Worker(b)).onmessage=re,b.id=C++,v[b.id]=b)})()).userStep=s.step,c.userChunk=s.chunk,c.userComplete=s.complete,c.userError=s.error,s.step=y(s.step),s.chunk=y(s.chunk),s.complete=y(s.complete),s.error=y(s.error),delete s.worker,c.postMessage({input:t,config:s,workerId:c.id})},o.unparse=function(t,s){var c=!1,b=!0,_=",",O=`\r
`,ue='"',ye=ue+ue,ie=!1,U=null,Z=!1,E=((()=>{if(typeof s=="object"){if(typeof s.delimiter!="string"||o.BAD_DELIMITERS.filter(function(L){return s.delimiter.indexOf(L)!==-1}).length||(_=s.delimiter),typeof s.quotes!="boolean"&&typeof s.quotes!="function"&&!Array.isArray(s.quotes)||(c=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(ie=s.skipEmptyLines),typeof s.newline=="string"&&(O=s.newline),typeof s.quoteChar=="string"&&(ue=s.quoteChar),typeof s.header=="boolean"&&(b=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");U=s.columns}s.escapeChar!==void 0&&(ye=s.escapeChar+ue),s.escapeFormulae instanceof RegExp?Z=s.escapeFormulae:typeof s.escapeFormulae=="boolean"&&s.escapeFormulae&&(Z=/^[=+\-@\t\r].*$/)}})(),new RegExp(x(ue),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return xe(null,t,ie);if(typeof t[0]=="object")return xe(U||Object.keys(t[0]),t,ie)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||U),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),xe(t.fields||[],t.data||[],ie);throw new Error("Unable to serialize unrecognized input");function xe(L,j,oe){var se="",pe=(typeof L=="string"&&(L=JSON.parse(L)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(L)&&0<L.length),be=!Array.isArray(j[0]);if(pe&&b){for(var T=0;T<L.length;T++)0<T&&(se+=_),se+=M(L[T],T);0<j.length&&(se+=O)}for(var H=0;H<j.length;H++){var le=(pe?L:j[H]).length,A=!1,ce=pe?Object.keys(j[H]).length===0:j[H].length===0;if(oe&&!pe&&(A=oe==="greedy"?j[H].join("").trim()==="":j[H].length===1&&j[H][0].length===0),oe==="greedy"&&pe){for(var fe=[],Y=0;Y<le;Y++){var K=be?L[Y]:Y;fe.push(j[H][K])}A=fe.join("").trim()===""}if(!A){for(var B=0;B<le;B++){0<B&&!ce&&(se+=_);var Ee=pe&&be?L[B]:B;se+=M(j[H][Ee],B)}H<j.length-1&&(!oe||0<le&&!ce)&&(se+=O)}}return se}function M(L,j){var oe,se;return L==null?"":L.constructor===Date?JSON.stringify(L).slice(1,25):(se=!1,Z&&typeof L=="string"&&Z.test(L)&&(L="'"+L,se=!0),oe=L.toString().replace(E,ye),(se=se||c===!0||typeof c=="function"&&c(L,j)||Array.isArray(c)&&c[j]||((pe,be)=>{for(var T=0;T<be.length;T++)if(-1<pe.indexOf(be[T]))return!0;return!1})(oe,o.BAD_DELIMITERS)||-1<oe.indexOf(_)||oe.charAt(0)===" "||oe.charAt(oe.length-1)===" ")?ue+oe+ue:oe)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!m&&!!i.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=z,o.ParserHandle=p,o.NetworkStreamer=N,o.FileStreamer=P,o.StringStreamer=k,o.ReadableStreamStreamer=u,i.jQuery&&((d=i.jQuery).fn.parse=function(t){var s=t.config||{},c=[];return this.each(function(O){if(!(d(this).prop("tagName").toUpperCase()==="INPUT"&&d(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var ue=0;ue<this.files.length;ue++)c.push({file:this.files[ue],inputElem:this,instanceConfig:d.extend({},s)})}),b(),this;function b(){if(c.length===0)y(t.complete)&&t.complete();else{var O,ue,ye,ie,U=c[0];if(y(t.before)){var Z=t.before(U.file,U.inputElem);if(typeof Z=="object"){if(Z.action==="abort")return O="AbortError",ue=U.file,ye=U.inputElem,ie=Z.reason,void(y(t.error)&&t.error({name:O},ue,ye,ie));if(Z.action==="skip")return void _();typeof Z.config=="object"&&(U.instanceConfig=d.extend(U.instanceConfig,Z.config))}else if(Z==="skip")return void _()}var E=U.instanceConfig.complete;U.instanceConfig.complete=function(xe){y(E)&&E(xe,U.file,U.inputElem),_()},o.parse(U.file,U.instanceConfig)}}function _(){c.splice(0,1),b()}}),h&&(i.onmessage=function(t){t=t.data,o.WORKER_ID===void 0&&t&&(o.WORKER_ID=t.workerId),typeof t.input=="string"?i.postMessage({workerId:o.WORKER_ID,results:o.parse(t.input,t.config),finished:!0}):(i.File&&t.input instanceof File||t.input instanceof Object)&&(t=o.parse(t.input,t.config))&&i.postMessage({workerId:o.WORKER_ID,results:t,finished:!0})}),(N.prototype=Object.create(g.prototype)).constructor=N,(P.prototype=Object.create(g.prototype)).constructor=P,(k.prototype=Object.create(k.prototype)).constructor=k,(u.prototype=Object.create(g.prototype)).constructor=u,o})}(ft)),ft.exports}var Qs=Ys();const Zs=ws(Qs),de={debug:(...r)=>{},info:(...r)=>{},warn:(...r)=>{},error:(...r)=>{},group:(r,a)=>{}},Be="https://click.wa.expert/api",Le={fetchRecords:async r=>{try{de.debug("Fetching records with params:",r);const a=await _e.post(`${Be}/data/getAllData`,r);return{data:a.data.data||[],columns:a.data.columns||[],pagination:a.data.pagination||null,success:!0}}catch(a){throw de.error("Error fetching records:",a),a}},fetchPaymentRecords:async r=>{try{const a=await _e.get(`${Be}/payment-reminders/list?owner_id=${r}`);return{data:a.data.data||a.data||[],success:!0}}catch(a){throw de.error("Error fetching payment records:",a),a}},fetchRecordById:async(r,a)=>{try{const n=decodeURIComponent(a);return{data:(await _e.post(`${Be}/data/getRecordById`,{schemaName:r.schemaName,tableName:r.tableName,id:n})).data,success:!0}}catch(n){return de.error("Error fetching record by ID:",n),{data:null,success:!1,error:n.message}}},createRecord:async(r,a)=>{try{return{data:(await _e.post(`${Be}/data/createRecord`,{schemaName:r.schemaName,tableName:r.tableName,record:a})).data,success:!0}}catch(n){throw de.error("Error creating record:",n),n}},createPaymentReminder:async r=>{try{return{data:(await _e.post(`${Be}/payment-reminders/add`,r,{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(a){throw de.error("Error creating payment reminder:",a),a}},updateRecord:async(r,a,n,i)=>{try{return{data:(await _e.post(`${Be}/data/updateMultiple`,{schemaName:r.schemaName,tableName:r.tableName,recordId:a,ownerId:n,updates:i},{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(d){throw de.error("Error updating record:",d),d}},deleteRecord:async(r,a)=>{try{const n=new URLSearchParams({id:a,schemaName:r.schemaName,tableName:r.tableName});return{data:(await _e.get(`${Be}/data/deleteRecord?${n.toString()}`)).data,success:!0}}catch(n){throw de.error("Error deleting record:",n),n}},fetchDropdownSetup:async(r,a)=>{try{const n=await _e.get(`${Be}/reference/setup/check?owner_id=${r}&product_name=${a}`);return n.data.exists&&n.data.setup?{mapping:n.data.setup.mapping||{},columnOrder:n.data.setup.columnOrder||{},exists:!0,success:!0}:{mapping:{},columnOrder:{},exists:!1,success:!0}}catch(n){return de.error("Error fetching dropdown setup:",n),{mapping:{},columnOrder:{},exists:!1,success:!1}}}},yt={DEFAULT_PAGE_SIZE:20},je={TEXT:"text",NUMBER:"number",EMAIL:"email",PHONE:"tel",URL:"url",DATE:"date",TEXTAREA:"textarea",CHECKBOX:"checkbox",SELECT_STATUS:"select-status",SELECT_PRIORITY:"select-priority"},Ct={PENDING:"pending",IN_PROGRESS:"in progress",COMPLETED:"completed"},Qe={LOW:"low",MEDIUM:"medium",HIGH:"high"},ss={[Ct.PENDING]:"bg-yellow-100 text-yellow-700 border-yellow-200",[Ct.IN_PROGRESS]:"bg-blue-100 text-blue-700 border-blue-200",[Ct.COMPLETED]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},rs={[Qe.HIGH]:"bg-red-100 text-red-700 border-red-200",[Qe.MEDIUM]:"bg-orange-100 text-orange-700 border-orange-200",[Qe.LOW]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},Js=["invoice","date","due_date","final_due_date","last_overdue_reminder_date","sent_at","created_at","updated_at"],er=["out_webhooks","emails"],ut={PA_ID:"pa_id",US_ID:"us_id"},tr=r=>r.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),sr=(r,a)=>{const n=a.toLowerCase();return n.includes("email")?je.EMAIL:n.includes("phone")?je.PHONE:n.includes("url")||n.includes("link")||n.includes("invoice_url")?je.URL:n==="status"?je.SELECT_STATUS:n==="priority"?je.SELECT_PRIORITY:n.includes("description")||n.includes("notes")||n.includes("comment")?je.TEXTAREA:n.includes("date")||n.includes("created")||n.includes("updated")||n==="invoice"?je.DATE:typeof r=="number"?je.NUMBER:typeof r=="boolean"?je.CHECKBOX:r&&r.length>100?je.TEXTAREA:je.TEXT},Nt=()=>Date.now().toString(),bt=(r,a)=>a[r==null?void 0:r.toLowerCase()]||a.default,Ft=(r,a=null)=>r.filter(n=>{if(n.id==="id"||n.id.includes("_comment")||n.id.includes("created_at")||n.id.includes("updated_at"))return!1;if(a){const i=n.id.toLowerCase(),d=n.name.toLowerCase();if(i.includes("balance")||d.includes("balance"))return!1}return!0}),Lt=(r,a={})=>r.filter(n=>a[n.id]!==0).sort((n,i)=>{const d=a[n.id]||999,m=a[i.id]||999;return d!==m?d-m:n.name.localeCompare(i.name)}),rr=(r,a=[],n=[])=>Object.fromEntries(Object.entries(r).map(([i,d])=>a.includes(i)?[i,d===""?null:d]:n.includes(i)?d===""?[i,null]:[i,d]:[i,d===""?null:d])),ar=(r,a=[])=>Object.fromEntries(Object.entries(r).filter(([n,i])=>i!=null&&i!==""?!0:a.includes(n))),nr=(r,a="normal",n)=>{const[i,d]=l.useState([]),[m,h]=l.useState([]),[v,C]=l.useState([]),[o,g]=l.useState({}),[N,P]=l.useState(!0),[k,u]=l.useState(1),[p,x]=l.useState(yt.DEFAULT_PAGE_SIZE),[z,re]=l.useState({currentPage:1,pageSize:yt.DEFAULT_PAGE_SIZE,totalRecords:0,totalPages:0,hasNextPage:!1,hasPreviousPage:!1}),D=l.useCallback(async(y=k,t=p)=>{try{P(!0),de.debug("Fetching table data",{apiParams:r,type:a,page:y,limit:t});let s;a==="normal"?(s=await Le.fetchRecords({...r,page:y,limit:t}),g(s.columns),s.pagination&&re(s.pagination)):s=await Le.fetchPaymentRecords(n);let c=s.data||[];if(a==="payment"&&(c=c.filter(b=>b.type==="original"||b.type==="Original")),h(c),d(c),c.length>0){const b=c[0],_=Object.keys(b).map(O=>({id:O,name:tr(O),sortable:!0,visible:!0,type:sr(b[O],O)}));C(_)}else y===1&&C([])}catch(s){de.error("Error fetching table data:",s),W.error("Failed to fetch records"),h([]),d([]),C([])}finally{P(!1)}},[r.schemaName,r.tableName,a,n,k,p]);l.useEffect(()=>{D(k,p)},[k,p,r.schemaName,r.tableName,a,n]);const q=l.useCallback(y=>{const t=Math.max(1,Math.min(y,z.totalPages||1));u(t)},[z.totalPages]),te=l.useCallback(y=>{x(y),u(1)},[]),G=l.useCallback(()=>{u(1),x(yt.DEFAULT_PAGE_SIZE)},[]);return{records:i,setRecords:d,originalRecords:m,columns:v,setColumns:C,metaData:o,loading:N,fetchData:D,refreshData:()=>D(k,p),currentPage:k,pageSize:p,paginationInfo:z,goToPage:q,changePageSize:te,resetPagination:G}},Pt="https://click.wa.expert/api",Mt={async fetch(r,a){var n;try{const i=`${r}_${a}`,d=await _e.post(`${Pt}/data/getRecordById`,{id:i,schemaName:"public",tableName:"column_preferences"});let m=d.data.column_visibility;if(typeof m=="string")try{m=JSON.parse(m)}catch{return null}return{...d.data,column_visibility:m}}catch(i){return((n=i.response)==null?void 0:n.status)===404,null}},async save(r,a,n,i){var m;try{const h=`${r}_${a}`,v=JSON.stringify(n),C=`${Pt}/data/createRecord`,o={schemaName:"public",tableName:"column_preferences",record:{us_id:h,owner_id:r,table_name:a,schema_name:i,column_visibility:v,updated_at:new Date().toISOString()}};return{success:!0,data:(await _e.post(C,o)).data}}catch(h){return{success:!1,error:((m=h.response)==null?void 0:m.data)||h.message}}}},ir=(r,a,n,i)=>{const[d,m]=l.useState(i),[h,v]=l.useState(!1),C=l.useCallback(async()=>{try{const u=await Mt.fetch(r,a);return u&&u.column_visibility?(de.debug("Loaded column preferences:",u.column_visibility),u.column_visibility):null}catch(u){return de.error("Error loading column preferences:",u),null}},[r,a]),o=l.useCallback((u,p)=>p?u.map(x=>{const z=p[x.id]!==void 0?p[x.id]:!0;return{...x,visible:z}}):u,[]),g=l.useCallback(async u=>{try{const p={};u.forEach(z=>{p[z.id]=z.visible}),(await Mt.save(r,a,p,n)).success&&(de.debug("Column preferences saved successfully"),W.success("Column preferences saved"))}catch(p){de.error("Error saving column preferences:",p),W.error("Failed to save column preferences")}},[r,a,n]),N=l.useCallback(async u=>{const p=d.map(x=>x.id===u?{...x,visible:!x.visible}:x);m(p),await g(p)},[d,g]),P=l.useCallback(async()=>{const u=d.map(p=>({...p,visible:!0}));m(u),await g(u),W.success("Column visibility reset to default")},[d,g]),k=l.useCallback(async()=>{const u=d.map(p=>({...p,visible:!1}));m(u),await g(u),W.success("All columns hidden")},[d,g]);return l.useEffect(()=>{(async()=>{if(!h&&i.length>0){const p=await C(),x=o(i,p);m(x),v(!0)}})()},[i,h,C,o]),l.useEffect(()=>{i.length>0&&!h&&m(i)},[i,h]),{columns:d,setColumns:m,toggleColumnVisibility:N,resetColumnVisibility:P,hideAllColumns:k,visibleColumns:d.filter(u=>u.visible)}},or=r=>{const[a,n]=l.useState(""),[i,d]=l.useState([]),[m,h]=l.useState([]),v=l.useMemo(()=>{if(!r.length)return[];let u=[...r];if(a.trim()!==""){const p=a.toLowerCase();u=u.filter(x=>Object.values(x).some(z=>String(z).toLowerCase().includes(p)))}return i.length>0&&(u=u.filter(p=>i.includes(p.status))),m.length>0&&(u=u.filter(p=>m.includes(p.priority))),de.debug("Filtered records:",{original:r.length,filtered:u.length,searchTerm:a,statusFilter:i,priorityFilter:m}),u},[r,a,i,m]),C=l.useMemo(()=>Array.from(new Set(r.map(u=>u.status))).filter(Boolean),[r]),o=l.useMemo(()=>Array.from(new Set(r.map(u=>u.priority))).filter(Boolean),[r]),g=l.useCallback(u=>{d(p=>p.includes(u)?p.filter(x=>x!==u):[...p,u])},[]),N=l.useCallback(u=>{h(p=>p.includes(u)?p.filter(x=>x!==u):[...p,u])},[]),P=l.useCallback(()=>{n(""),d([]),h([])},[]),k=l.useMemo(()=>a!==""||i.length>0||m.length>0,[a,i,m]);return{searchTerm:a,setSearchTerm:n,statusFilter:i,setStatusFilter:d,priorityFilter:m,setPriorityFilter:h,filteredRecords:v,uniqueStatuses:C,uniquePriorities:o,toggleStatusFilter:g,togglePriorityFilter:N,clearFilters:P,hasActiveFilters:k}},lr=(r,a,n)=>{const[i,d]=l.useState({}),[m,h]=l.useState(!1),[v,C]=l.useState(!1),o=l.useCallback((p={})=>{d(p)},[]),g=l.useCallback((p,x)=>{d(z=>({...z,[p]:x}))},[]),N=l.useCallback(()=>{d({})},[]),P=l.useCallback(async(p={})=>{try{h(!0);const x={...i,...p};de.debug("Submitting form data:",x);const z=rr(x,Js,er),D=ar(z,["status","type"]);de.debug("Cleaned record data:",D);let q;return a==="payment"?q=await Le.createPaymentReminder(D):q=await Le.createRecord(r,D),W.success("Record created successfully!"),n&&n(q.data),N(),C(!1),q}catch(x){throw de.error("Error submitting form:",x),x.response?W.error(`Failed to create record: ${x.response.data.error||x.response.data.message||"Unknown error"}`):W.error(`Failed to create record: ${x.message}`),x}finally{h(!1)}},[i,r,a,n,N]),k=l.useCallback((p={})=>{o(p),C(!0)},[o]),u=l.useCallback(()=>{C(!1),N()},[N]);return{formData:i,isSubmitting:m,isOpen:v,initializeForm:o,handleFieldChange:g,resetForm:N,submitForm:P,openForm:k,closeForm:u}},cr=(r,a)=>{const[n,i]=l.useState({}),[d,m]=l.useState({}),[h,v]=l.useState(!1),[C,o]=l.useState(!0),g=l.useCallback(async()=>{try{o(!0);const u=await Le.fetchDropdownSetup(r,a);u.exists?(i(u.mapping),m(u.columnOrder),v(!0),de.debug("Dropdown setup loaded:",{mapping:u.mapping,columnOrder:u.columnOrder})):(i({}),m({}),v(!1))}catch(u){de.error("Error fetching dropdown setup:",u),i({}),m({}),v(!1)}finally{o(!1)}},[r,a]),N=l.useCallback(u=>n[u]||[],[n]),P=l.useCallback(u=>{const p=n[u];return Array.isArray(p)&&p.length>0},[n]),k=l.useCallback(u=>d[u]||999,[d]);return l.useEffect(()=>{r&&a&&g()},[r,a,g]),{dropdownSetup:n,columnOrder:d,setupExists:h,loading:C,fetchSetup:g,getDropdownOptions:N,hasDropdown:P,getColumnOrder:k}};var _t="Switch",[dr,Hr]=ys(_t),[ur,hr]=dr(_t),as=l.forwardRef((r,a)=>{const{__scopeSwitch:n,name:i,checked:d,defaultChecked:m,required:h,disabled:v,value:C="on",onCheckedChange:o,form:g,...N}=r,[P,k]=l.useState(null),u=Wt(a,D=>k(D)),p=l.useRef(!1),x=P?g||!!P.closest("form"):!0,[z,re]=_s({prop:d,defaultProp:m??!1,onChange:o,caller:_t});return e.jsxs(ur,{scope:n,checked:z,disabled:v,children:[e.jsx(Gt.button,{type:"button",role:"switch","aria-checked":z,"aria-required":h,"data-state":ls(z),"data-disabled":v?"":void 0,disabled:v,value:C,...N,ref:u,onClick:Cs(r.onClick,D=>{re(q=>!q),x&&(p.current=D.isPropagationStopped(),p.current||D.stopPropagation())})}),x&&e.jsx(os,{control:P,bubbles:!p.current,name:i,value:C,checked:z,required:h,disabled:v,form:g,style:{transform:"translateX(-100%)"}})]})});as.displayName=_t;var ns="SwitchThumb",is=l.forwardRef((r,a)=>{const{__scopeSwitch:n,...i}=r,d=hr(ns,n);return e.jsx(Gt.span,{"data-state":ls(d.checked),"data-disabled":d.disabled?"":void 0,...i,ref:a})});is.displayName=ns;var fr="SwitchBubbleInput",os=l.forwardRef(({__scopeSwitch:r,control:a,checked:n,bubbles:i=!0,...d},m)=>{const h=l.useRef(null),v=Wt(h,m),C=js(n),o=Ss(a);return l.useEffect(()=>{const g=h.current;if(!g)return;const N=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(N,"checked").set;if(C!==n&&k){const u=new Event("click",{bubbles:i});k.call(g,n),g.dispatchEvent(u)}},[C,n,i]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...d,tabIndex:-1,ref:v,style:{...d.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});os.displayName=fr;function ls(r){return r?"checked":"unchecked"}var cs=as,pr=is;const ds=l.forwardRef(({className:r,...a},n)=>e.jsx(cs,{className:Xe("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...a,ref:n,children:e.jsx(pr,{className:Xe("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));ds.displayName=cs.displayName;const mr=({tableName:r="jobstatus",onCounterUpdate:a})=>{const[n,i]=l.useState(0),[d,m]=l.useState(""),[h,v]=l.useState(!1),[C,o]=l.useState(!1),[g,N]=l.useState(!1),[P,k]=l.useState(null),u=wt(D=>D.user),p=u.owner_id===null?u.id:u.owner_id,x=async()=>{try{N(!0);const D="https://click.wa.expert/api/data/getRecordById",te={id:`${p}_${r}`,schemaName:"public",tableName:"counter_setup"},{data:G}=await _e.post(D,te);if(G){const y=parseInt(G.counter,10)||0;i(y),m(G.prefix||""),v(G.is_active||!1),k(G.id),a&&a({counter:y,prefix:G.prefix||"",isActive:G.is_active||!1,recordId:G.id})}}catch{i(1),m(""),v(!1),k(null),await z()}finally{N(!1)}},z=async()=>{try{const D="https://click.wa.expert/api/data/createRecord",te={schemaName:"public",tableName:"counter_setup",record:{us_id:`${p}_${r}`,owner_id:p,table_name:r,prefix:"",counter:1,is_active:!1}},{data:G}=await _e.post(D,te);await x()}catch{}},re=async()=>{try{o(!0);const D=parseInt(n,10),q="https://click.wa.expert/api/data/createRecord",te=`${p}_${r}`,G={schemaName:"public",tableName:"counter_setup",record:{us_id:te,owner_id:p,table_name:r,prefix:d,counter:D,is_active:h,updated_at:new Date().toISOString()}};await _e.post(q,G),W.success("Counter settings saved successfully"),a&&a({counter:D,prefix:d,isActive:h,recordId:P||te}),await x()}catch{W.error("Failed to save counter settings")}finally{o(!1)}};return l.useEffect(()=>{x()},[r]),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(ds,{id:"counter-active",checked:h,onCheckedChange:v}),e.jsx(qe,{htmlFor:"counter-active",className:"text-sm font-medium whitespace-nowrap",children:"Auto Counter"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[120px]",children:[e.jsx(qe,{htmlFor:"prefix",className:"text-sm whitespace-nowrap",children:"Prefix:"}),e.jsx(Fe,{id:"prefix",type:"text",value:d,onChange:D=>m(D.target.value),placeholder:"INV",className:"h-9"})]}),h&&e.jsxs("div",{className:"text-sm bg-blue-50 px-2 py-1.5 rounded border border-blue-200 flex w-[10rem] items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Next : "}),e.jsxs("span",{className:"font-mono font-semibold text-blue-700",children:[d,n]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx(ee,{onClick:re,disabled:C,size:"sm",variant:"default",children:e.jsx(Ns,{className:"h-3.5 w-3.5"})}),e.jsx(ee,{onClick:x,disabled:g,variant:"outline",size:"sm",children:e.jsx(es,{className:`h-3.5 w-3.5 ${g?"animate-spin":""}`})})]})]})})})},gr=({title:r="All Records",description:a="View and manage all database records",searchTerm:n="",onSearchChange:i,tableName:d,onCounterUpdate:m,urlParams:h={},dropdownSetupExists:v=!1,columnOrderExists:C=!1})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{className:"w-[95%]",children:[e.jsxs("div",{className:"flex md:flex-row md:items-center justify-between w-full",children:[e.jsx(Ht,{className:"text-2xl font-semibold text-slate-700",children:r}),e.jsx("div",{className:"lg:flex-1 lg:max-w-[500px]",children:e.jsx(mr,{tableName:d,onCounterUpdate:m})})]}),e.jsxs(vs,{className:"mt-1",children:[a,h.pa_id&&e.jsx("div",{className:"flex gap-2 mt-1",children:e.jsxs(Se,{variant:"outline",className:"text-xs bg-green-50 border-green-200",children:["PA ID: ",h.pa_id]})}),h.process_name&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(Se,{variant:"outline",className:"text-xs bg-purple-50 border-purple-200",children:["Process: ",h.process_name]}),e.jsxs(Se,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[h.process_name,"_balance"]})]}),v&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(Se,{variant:"outline",className:"text-xs",children:"Dropdown Configured"}),C&&e.jsxs(Se,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[e.jsx(Ls,{className:"h-3 w-3 mr-1"}),"Custom Order"]})]})]})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-end gap-3",children:e.jsxs("div",{className:"relative lg:w-[300px]",children:[e.jsx(Es,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(Fe,{type:"text",placeholder:"Search records...",value:n,onChange:i,className:"pl-9"})]})})]}),xr=250,br="https://click.wa.expert/api",wr=({value:r,onChange:a,placeholder:n="Enter the ID"})=>{const[i,d]=l.useState(!1),[m,h]=l.useState("jobstatus"),[v,C]=l.useState([]),[o,g]=l.useState(!1),N=l.useRef(!1),P=wt(x=>x.user),k=(P==null?void 0:P.schema_name)||"default_schema";l.useEffect(()=>{if(!r||!r.trim()){C([]),g(!1);return}if(N.current){N.current=!1;return}if(!o)return;const x=new AbortController,z=setTimeout(async()=>{var re;try{const{data:D}=await _e.post(`${br}/additional/search`,{schemaName:k,tableName:m,query:r,userId:P.id,userEmail:P.email},{signal:x.signal}),q=(D==null?void 0:D.data)||[];C(q),(re=D.data)!=null&&re.table_name&&h(D.data.table_name),g(q.length>0)}catch(D){D.name!=="CanceledError"&&D.name}},xr);return()=>{clearTimeout(z),x.abort()}},[r,m,k,o,P.id,P.email]);const u=l.useCallback((x,z)=>{N.current=!0,a(x),h(z),C([]),g(!1)},[a]),p=l.useCallback(x=>{N.current=!1,a(x.target.value),g(!0)},[a]);return e.jsxs("div",{className:"relative w-full",children:[e.jsx(Fe,{type:"text",value:r,onChange:p,className:"bg-gray-50 text-gray-700",placeholder:n,"aria-label":"Search ID",disabled:i,autoComplete:"off"}),o&&v.length>0&&e.jsx("ul",{className:"absolute z-50 w-full bg-white border border-gray-300 rounded-md mt-1 max-h-48 overflow-y-auto shadow-md",children:v.map((x,z)=>e.jsx("li",{className:"px-3 py-2 cursor-pointer hover:bg-gray-100 text-sm",onClick:()=>u(x.us_id,x.table_name),children:x.us_id},x.us_id||z))})]})},_r=({onRefresh:r,onAddRecord:a,onExportCSV:n,onToggleEdit:i,editEnabled:d=!1,canEdit:m=!0,isLoading:h=!1,splitOptions:v=[],onSplitLoad:C})=>{const[o,g]=tt.useState(!1),[N,P]=tt.useState(""),[k,u]=tt.useState(""),[p,x]=tt.useState(!1),z=()=>{g(!0)},re=()=>{g(!1),P(""),u("")},D=async()=>{if(N&&k.trim()&&C){x(!0);try{await C(N,k.trim()),g(!1),P(""),u("")}catch{}finally{x(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ee,{className:"flex items-center gap-2",onClick:a,disabled:h,children:[e.jsx(ks,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Record"})]}),e.jsxs(ee,{className:"flex items-center gap-2",onClick:z,disabled:h,children:[e.jsx(Vs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Split"})]}),e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:r,disabled:h,children:[e.jsx(es,{className:`h-4 w-4 ${h?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:n,disabled:h,children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]}),m&&e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:i,disabled:h,children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:d?"Editing":"Edit"}),d&&e.jsx(Se,{className:"ml-1 bg-blue-500",children:"ON"})]})]}),e.jsx(vt,{open:o,onOpenChange:g,children:e.jsxs(Et,{className:"sm:max-w-md",children:[e.jsx(st,{children:e.jsx(rt,{children:"Add Split Record"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{className:"text-sm font-medium",children:"Parent ID (pa_id):"}),e.jsx(wr,{value:k,onChange:u,placeholder:"Enter parent ID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(qe,{className:"text-sm font-medium",children:"Select Table:"}),e.jsxs(pt,{value:N,onValueChange:P,disabled:p,children:[e.jsx(mt,{className:"w-full",children:e.jsx(gt,{placeholder:"Select a table"})}),e.jsx(xt,{children:v.length>0?v.map((q,te)=>e.jsx(Ke,{value:q.value||q,children:q.label||q},q.value||te)):e.jsx(Ke,{value:"no-options",disabled:!0,children:"No options available"})})]})]})]}),e.jsxs(at,{className:"gap-2 sm:gap-0",children:[e.jsx(ee,{variant:"outline",onClick:re,disabled:p,children:"Cancel"}),e.jsx(ee,{onClick:D,disabled:!N||!k.trim()||p,children:p?"Loading...":"Load Form"})]})]})})]})},yr=({uniqueStatuses:r=[],uniquePriorities:a=[],statusFilter:n=[],priorityFilter:i=[],onToggleStatus:d,onTogglePriority:m,onClearStatusFilter:h,onClearPriorityFilter:v})=>{const C=n.length+i.length;return e.jsxs(Kt,{children:[e.jsx(Xt,{asChild:!0,children:e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Filters"}),C>0&&e.jsx(Se,{className:"ml-1 py-0 px-1.5 h-5 min-w-5 bg-blue-500 text-white rounded-full",children:C})]})}),e.jsxs(Yt,{align:"start",className:"w-56",children:[e.jsxs(jt,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Status"}),n.length>0&&e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:h,children:"Clear"})]}),r.length>0?r.map(o=>e.jsxs(It,{checked:n.includes(o),onCheckedChange:()=>d(o),children:[e.jsx(Se,{className:`font-medium mr-2 ${bt(o,ss)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(St,{disabled:!0,children:"No statuses available"}),e.jsx(Qt,{}),e.jsxs(jt,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Priority"}),i.length>0&&e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:v,children:"Clear"})]}),a.length>0?a.map(o=>e.jsxs(It,{checked:i.includes(o),onCheckedChange:()=>m(o),children:[e.jsx(Se,{className:`font-medium mr-2 ${bt(o,rs)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(St,{disabled:!0,children:"No priorities available"})]})]})},Cr=({columns:r=[],onToggleColumn:a,onResetVisibility:n,onHideAll:i})=>e.jsxs(Kt,{children:[e.jsx(Xt,{asChild:!0,children:e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Columns"})]})}),e.jsxs(Yt,{align:"start",className:"w-56",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[e.jsx(jt,{className:"p-0",children:"Toggle Columns"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:d=>{d.stopPropagation(),i()},children:"Hide All"}),e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:d=>{d.stopPropagation(),n()},children:"Reset"})]})]}),e.jsx(Qt,{}),r.map(d=>e.jsx(St,{onSelect:m=>{m.preventDefault(),a(d.id)},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(ts,{checked:d.visible,onCheckedChange:()=>a(d.id)}),e.jsx("span",{className:"flex-1",children:d.name}),!d.visible&&e.jsx(Se,{variant:"secondary",className:"text-xs",children:"Hidden"})]})},d.id))]})]}),jr=({records:r=[],columns:a=[],loading:n=!1,editEnabled:i=!1,canDelete:d=!1,onSort:m,onDeleteRecord:h,onEditRecord:v,onSaveRecord:C,sortColumn:o=null,sortDirection:g="asc",emptyMessage:N="No records found",onClearFilters:P})=>{const[k,u]=l.useState(null),[p,x]=l.useState({}),z=l.useCallback(y=>{i&&(u(y.id),x(y),v&&v(y))},[i,v]),re=l.useCallback(()=>{C&&C(k,p),u(null),x({})},[k,p,C]),D=l.useCallback(()=>{u(null),x({})},[]),q=l.useCallback((y,t)=>{x(s=>({...s,[y]:t}))},[]),te=(y,t)=>{const s=y[t.id];return k===y.id&&t.id!=="id"&&i?e.jsx(Fe,{type:"text",value:p[t.id]||"",onChange:c=>q(t.id,c.target.value),className:"border rounded px-2 py-1 w-full",onClick:c=>c.stopPropagation()}):t.id==="status"?e.jsx(Se,{className:`font-medium ${bt(s,ss)}`,children:s}):t.id==="priority"?e.jsx(Se,{className:`font-medium ${bt(s,rs)}`,children:s}):t.id==="task_file"&&s?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Os,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:s})]}):e.jsx("span",{children:s||"â€”"})},G=a.filter(y=>y.visible);return e.jsxs("div",{className:"rounded-md border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ms,{children:[e.jsx($s,{children:e.jsxs(ct,{className:"bg-slate-50",children:[d&&e.jsx(Ot,{className:"w-[60px] text-center",children:"Delete"}),G.map(y=>e.jsx(Ot,{className:`${y.sortable?"cursor-pointer hover:bg-slate-100":""}`,onClick:()=>y.sortable&&m&&m(y.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:y.name}),o===y.id&&e.jsx(Is,{className:`h-4 w-4 transition-transform ${g==="desc"?"rotate-180":""}`})]})},y.id))]})}),e.jsx(Us,{children:n?e.jsx(ct,{children:e.jsx(dt,{colSpan:G.length+(d?1:0),className:"h-24 text-center",children:"Loading records..."})}):r.length===0?e.jsx(ct,{children:e.jsxs(dt,{colSpan:G.length+(d?1:0),className:"h-24 text-center",children:[N,P&&e.jsx(ee,{variant:"link",onClick:P,className:"ml-2",children:"Clear filters?"})]})}):r.map((y,t)=>e.jsxs(ct,{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>z(y),children:[d&&e.jsx(dt,{className:"w-[60px] text-center",children:e.jsx(ee,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:s=>{s.stopPropagation(),h&&h(y)},children:e.jsx(Zt,{className:"h-4 w-4"})})}),G.map(s=>e.jsx(dt,{children:te(y,s)},s.id))]},y.id||t))})]})}),k&&i&&e.jsxs("div",{className:"flex gap-2 p-3 bg-slate-50 border-t",children:[e.jsx(ee,{size:"sm",onClick:re,children:"Save Changes"}),e.jsx(ee,{size:"sm",variant:"ghost",onClick:D,children:"Cancel"})]})]})},$t=({column:r,value:a,onChange:n,dropdownOptions:i=[],isAutoFilled:d=!1,disabled:m=!1})=>{const{id:h,type:v,name:C}=r;if(d)return e.jsx(Fe,{id:h,type:"text",value:a||"",disabled:!0,className:"bg-gray-50 cursor-not-allowed text-gray-600",placeholder:`Auto-filled ${C.toLowerCase()}`});if(i.length>0)return e.jsxs(pt,{value:a||"",onValueChange:o=>n(h,o),disabled:m,children:[e.jsx(mt,{children:e.jsx(gt,{placeholder:`Select ${C.toLowerCase()}`})}),e.jsx(xt,{children:i.map((o,g)=>e.jsx(Ke,{value:o,children:o},g))})]});switch(v){case je.TEXTAREA:return e.jsx(zs,{id:h,value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,rows:3,disabled:m});case je.SELECT_PRIORITY:return e.jsxs(pt,{value:a||"",onValueChange:o=>n(h,o),disabled:m,children:[e.jsx(mt,{children:e.jsx(gt,{placeholder:"Select priority"})}),e.jsxs(xt,{children:[e.jsx(Ke,{value:Qe.LOW,children:"Low"}),e.jsx(Ke,{value:Qe.MEDIUM,children:"Medium"}),e.jsx(Ke,{value:Qe.HIGH,children:"High"})]})]});case je.NUMBER:return e.jsx(Fe,{id:h,type:"number",value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,disabled:m});case je.EMAIL:return e.jsx(Fe,{id:h,type:"email",value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,disabled:m});case je.PHONE:return e.jsx(Fe,{id:h,type:"tel",value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,disabled:m});case je.DATE:return e.jsx(Fe,{id:h,type:"date",value:a||"",onChange:o=>n(h,o.target.value),disabled:m});case je.URL:return e.jsx(Fe,{id:h,type:"url",value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,disabled:m});case je.CHECKBOX:return e.jsx(ts,{id:h,checked:a||!1,onCheckedChange:o=>n(h,o),disabled:m});default:return e.jsx(Fe,{id:h,type:"text",value:a||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${C.toLowerCase()}`,disabled:m})}},Ut=({isOpen:r,onClose:a,onSubmit:n,formData:i,onFieldChange:d,columns:m,metaData:h=[],dropdownSetup:v={},columnOrder:C={},processName:o=null,isSubmitting:g=!1,counterConfig:N,setCounterConfig:P,mode:k="create",itsSplit:u})=>{const p=wt(f=>f.user),x=(p==null?void 0:p.owner_id)??(p==null?void 0:p.id),[z,re]=Jt(),[D,q]=l.useState(!1),[te,G]=l.useState(""),[y,t]=l.useState({}),[s,c]=l.useState([]),[b,_]=l.useState([]),[O,ue]=l.useState({}),[ye,ie]=l.useState({}),[U,Z]=l.useState(null),[E,xe]=l.useState(null),[M,L]=l.useState(!1),[j,oe]=l.useState(!1),[se,pe]=l.useState(!1),[be,T]=l.useState([]),[H,le]=l.useState([]);l.useEffect(()=>{ce()},[]);const A=p.schema_name,ce=async()=>{const f=`https://click.wa.expert/api/data/getAllTables?schemaName=${A}`,{data:$}=await _e.get(f);le($.data)};l.useEffect(()=>{r&&k==="create"&&m.length>0&&m.some($=>$.id==="status"||$.id.toLowerCase()==="status")&&be.length>0&&(!i.status||i.status==="")&&d("status",be[0])},[r,k,m,be,i.status]);const fe=l.useMemo(()=>{const f=Ft(m,o);return Lt(f,C)},[m,o,C]),Y=f=>{const $=h.find(R=>R.column_name===f);return($==null?void 0:$.is_nullable)==="NO"},K=f=>f===ut.PA_ID,B=f=>{const $=v[f];return Array.isArray($)?$:[]},Ee=f=>o&&(f.id.toLowerCase().includes("quantity")||f.name.toLowerCase().includes("quantity")),I=()=>{const f=window.location.pathname.split("/");return f[f.length-2]},ae=(f,$)=>{const R={};return Object.entries(f).forEach(([V,he])=>{if(he===""||he===null||he===void 0)return;const Ie=$.find(X=>X.column_name===V);if(Ie){const X=Ie.data_type.toLowerCase();if(X.includes("int")||X.includes("serial")){const ge=parseInt(he,10);isNaN(ge)||(R[V]=ge)}else if(X.includes("numeric")||X.includes("decimal")||X.includes("float")||X.includes("double")){const ge=parseFloat(he);isNaN(ge)||(R[V]=ge)}else X.includes("bool")?R[V]=he===!0||he==="true"||he==="1":(X.includes("date")||X.includes("time"),R[V]=he)}else R[V]=he}),R},Ae=async f=>{try{const $={schemaName:p.schema_name,tableName:f,userId:p.id,userEmail:p.email},R=await _e.post("https://click.wa.expert/api/data/getAllData",$),V=R.data.data||[],he=R.data.columns||[];let Ie=[];if(V.length>0){const lt=V[0];Ie=Object.keys(lt).map(We=>({id:We,name:Pe(We),accessor:We,sortable:!0,visible:!0,type:ke(lt[We],We)}))}const X=`https://click.wa.expert/api/reference/setup/check?owner_id=${x}&product_name=${f}`,ge=await _e.get(X);let Ne={},ot={},Ze=[];return ge.data.exists&&ge.data.setup&&(Ne=ge.data.setup.mapping||{},ot=ge.data.setup.columnOrder||{},Ze=ge.data.setup.process_steps||[],T(Ze)),{columns:Ie,metaData:he,dropdownSetup:Ne,columnOrder:ot,processName:null,processSteps:Ze}}catch($){throw $}},Pe=f=>f.split("_").map($=>$.charAt(0).toUpperCase()+$.slice(1)).join(" "),ke=(f,$)=>{const R=$.toLowerCase();return R.includes("email")?"email":R.includes("phone")?"tel":R.includes("url")||R.includes("link")?"url":R==="status"?"select-status":R==="priority"?"select-priority":R.includes("description")||R.includes("notes")||R.includes("comment")?"textarea":R.includes("date")||R.includes("created")||R.includes("updated")?"date":typeof f=="number"?"number":typeof f=="boolean"?"checkbox":f&&f.length>100?"textarea":"text"},Me=async f=>{try{const $=I();let R=ae(f,h);const V={process_name:z.get("process_name"),pa_id:z.get("pa_id"),status:z.get("status")};if(V.process_name){const X=`${V.process_name}_balance`,ge=m.find(Ne=>Ne.id.toLowerCase().includes("quantity"));if(ge){const Ne=R[ge.id];Ne&&(R[X]=Ne)}}(V.status&&V.pa_id||V.process_name&&V.pa_id)&&(R.us_id=`${V.pa_id} -S- ${R.us_id}`);const he={schemaName:p.schema_name,tableName:$};return await Le.createRecord(he,R)}catch($){throw $}},me=async(f,$)=>{try{const R=ae(f,b);E&&R.us_id&&(R.us_id=`${E} -S- ${R.us_id}`);const V={schemaName:p.schema_name,tableName:$};return await Le.createRecord(V,R)}catch(R){throw R}},Re=async()=>{await n()},we=async()=>{var f,$,R,V,he,Ie;pe(!0);try{const X=await Me(i);let ge=null;if(($=(f=X==null?void 0:X.data)==null?void 0:f.data)!=null&&$.us_id)ge=X.data.data.us_id;else if(i.us_id)ge=i.us_id;else if((V=(R=X==null?void 0:X.data)==null?void 0:R.data)!=null&&V.us_id&&X.data.data.us_id.includes(" -S- ")){const Ne=X.data.data.us_id.split(" -S- ");ge=Ne[Ne.length-1]}if(N.isActive&&N.recordId)try{await Le.updateRecord({schemaName:"public",tableName:"counter_setup"},N.recordId,x,{counter:N.counter+1}),P(Ne=>({...Ne,counter:Ne.counter+1}))}catch{W.warning("Record created but counter increment failed")}ge?(xe(ge),W.success("Record created successfully"),q(!0)):W.error("Could not get us_id from created record")}catch(X){W.error("Failed to create record: "+(((Ie=(he=X.response)==null?void 0:he.data)==null?void 0:Ie.details)||X.message))}finally{pe(!1)}},Ce=async()=>{if(te){L(!0);try{const f=await Ae(te);c(f.columns||[]),_(f.metaData||[]),ue(f.dropdownSetup||{}),ie(f.columnOrder||{}),Z(f.processName||null);const $={[ut.PA_ID]:E,us_id:Nt()};f.columns.some(V=>V.id==="status"||V.id.toLowerCase()==="status")&&f.processSteps&&f.processSteps.length>0&&($.status=f.processSteps[0]),f.columns.forEach(V=>{$[V.id]||($[V.id]="")}),t($),q(!1)}catch{W.error("Failed to load table structure. Please try again.")}finally{L(!1)}}},Oe=(f,$)=>{t(R=>({...R,[f]:$}))},He=async()=>{oe(!0);try{await me(y,te)&&(W.success("Detail record created successfully"),De(),window.location.reload())}catch{W.error("Failed to create detail record. Please try again.")}finally{oe(!1)}},Ue=async()=>{oe(!0);try{await me(y,te)&&(W.success("Detail record created successfully"),t({}),c([]),_([]),ue({}),ie({}),Z(null),G(""),q(!0))}catch{W.error("Failed to create detail record. Please try again.")}finally{oe(!1)}},De=()=>{q(!1),G(""),t({}),c([]),_([]),ue({}),ie({}),Z(null),xe(null),T([]),a()},Te=()=>e.jsxs(e.Fragment,{children:[e.jsxs(st,{children:[e.jsx(rt,{children:"Select Table for Details"}),e.jsxs(ht,{children:["Choose a table to add detail records linked to the parent record (pa_id: ",E,")"]})]}),e.jsxs("div",{className:"py-6",children:[e.jsx(qe,{htmlFor:"table-select",className:"text-sm font-medium mb-2 block",children:"Select Table"}),e.jsxs(pt,{value:te,onValueChange:G,children:[e.jsx(mt,{id:"table-select",className:"w-full",children:e.jsx(gt,{placeholder:"Choose a table..."})}),e.jsx(xt,{children:H.map(f=>e.jsx(Ke,{value:f.title,children:f.title.charAt(0).toUpperCase()+f.title.slice(1)},f.title))})]})]}),e.jsxs(at,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(ee,{variant:"outline",onClick:De,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(ee,{onClick:Ce,disabled:!te||M,className:"w-full sm:w-auto",children:M?"Loading...":"Load Form"})]})]}),ze=()=>e.jsxs(e.Fragment,{children:[e.jsxs(st,{children:[e.jsx(rt,{children:k==="create"?"Add New Record":"Edit Record"}),e.jsxs(ht,{children:[k==="create"?"Fill in the details to create a new record in the database.":"Update the record details.",o&&e.jsxs("span",{className:"block mt-1 text-blue-600",children:["Note: The ",o,"_balance field will be automatically set to match the quantity value."]})]})]}),e.jsx("div",{className:"space-y-6 py-4",children:fe.map(f=>{const $=C[f.id],R=K(f.id),V=Y(f.id),he=Ee(f);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs(qe,{htmlFor:f.id,className:"font-medium text-sm sm:w-48 sm:text-right sm:flex-shrink-0 flex items-center gap-1 justify-start sm:justify-end",children:[$&&e.jsx(Se,{variant:"secondary",className:"text-xs h-4 px-1 mr-1",children:$}),e.jsx("span",{className:"flex-1 sm:flex-initial",children:f.name}),V&&e.jsx(Se,{variant:"default",className:"text-xs h-4 px-1 text-red-100",children:"*"}),R&&e.jsx(Se,{variant:"default",className:"text-xs h-4 px-1 bg-green-500 ml-1",children:"auto"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx($t,{column:f,value:i[f.id],onChange:d,dropdownOptions:B(f.id),isAutoFilled:R,disabled:g||se}),R&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:f.id===ut.PA_ID?"Automatically filled from URL parameter":"Automatically generated unique identifier"}),he&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["This value will be used to set ",o,"_balance"]})]})]},f.id)})}),e.jsxs(at,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(ee,{variant:"outline",onClick:De,disabled:g||se,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(ee,{onClick:Re,disabled:g||se,className:"w-full sm:w-auto",children:g?k==="create"?"Creating...":"Updating...":k==="create"?"Create Record":"Update Record"}),!u&&e.jsx(ee,{onClick:we,disabled:g||se,variant:"secondary",className:"w-full sm:w-auto",children:se?"Creating...":"Create & Add Details"})]})]}),Ve=l.useMemo(()=>{const f=Ft(s,U);return Lt(f,ye)},[s,U,ye]),it=()=>e.jsxs(e.Fragment,{children:[e.jsxs(st,{children:[e.jsxs(rt,{children:["Add Details - ",te.charAt(0).toUpperCase()+te.slice(1)]}),e.jsxs(ht,{children:["Adding detail record linked to parent (pa_id: ",E,")"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:Ve.map(f=>{var Ie;const $=ye[f.id],R=f.id===ut.PA_ID,V=((Ie=b.find(X=>X.column_name===f.id))==null?void 0:Ie.is_nullable)==="NO",he=Array.isArray(O[f.id])?O[f.id]:[];return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs(qe,{htmlFor:f.id,className:"font-medium text-sm sm:w-48 sm:text-right sm:flex-shrink-0 flex items-center gap-1 justify-start sm:justify-end",children:[$&&e.jsx(Se,{variant:"secondary",className:"text-xs h-4 px-1 mr-1",children:$}),e.jsx("span",{className:"flex-1 sm:flex-initial",children:f.name}),V&&e.jsx(Se,{variant:"default",className:"text-xs h-4 px-1 text-red-100",children:"*"}),R&&e.jsx(Se,{variant:"default",className:"text-xs h-4 px-1 bg-green-500 ml-1",children:"auto"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx($t,{column:f,value:y[f.id],onChange:Oe,dropdownOptions:he,isAutoFilled:R,disabled:j}),R&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Automatically filled from parent record: ",E]})]})]},f.id)})}),e.jsxs(at,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(ee,{variant:"outline",onClick:De,disabled:j,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(ee,{onClick:He,disabled:j,className:"w-full sm:w-auto",children:j?"Creating...":"Create Record"}),e.jsx(ee,{onClick:Ue,disabled:j,variant:"secondary",className:"w-full sm:w-auto",children:j?"Creating...":"Create & Add More Details"})]})]});return e.jsx(vt,{open:r,onOpenChange:a,children:e.jsx(Et,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",onInteractOutside:f=>f.preventDefault(),children:D?Te():s.length>0?it():ze()})})},Sr=({isOpen:r,onClose:a,onConfirm:n,record:i,confirmInput:d,onConfirmInputChange:m,isDeleting:h=!1})=>{const v=d.trim()===(i==null?void 0:i.us_id);return e.jsx(vt,{open:r,onOpenChange:a,children:e.jsxs(Et,{className:"max-w-md",children:[e.jsxs(st,{children:[e.jsxs(rt,{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5 text-red-500"}),"Confirm Deletion"]}),e.jsxs(ht,{children:["This action cannot be undone. Please type the ",e.jsx("strong",{children:"us_id"})," to confirm deletion."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[i&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[e.jsx("p",{className:"text-sm font-medium",children:"Record to delete:"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",i.id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["US_ID: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:i.us_id})]})]}),e.jsxs("div",{children:[e.jsx(qe,{htmlFor:"confirm-us-id",className:"text-sm font-medium",children:"Enter us_id to confirm:"}),e.jsx(Fe,{id:"confirm-us-id",type:"text",placeholder:"Type us_id here",value:d,onChange:C=>m(C.target.value),className:"mt-1",autoFocus:!0,disabled:h})]})]}),e.jsxs(at,{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(ee,{variant:"outline",onClick:a,disabled:h,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(ee,{variant:"destructive",onClick:n,disabled:h||!v,className:"w-full sm:w-auto",children:h?"Deleting...":"Delete Record"})]})]})})};function Nr({className:r,...a}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:Xe("mx-auto flex w-full justify-center",r),...a})}function vr({className:r,...a}){return e.jsx("ul",{"data-slot":"pagination-content",className:Xe("flex flex-row items-center gap-1",r),...a})}function Ge({...r}){return e.jsx("li",{"data-slot":"pagination-item",...r})}function nt({className:r,isActive:a,size:n="icon",...i}){return e.jsx("a",{"aria-current":a?"page":void 0,"data-slot":"pagination-link","data-active":a,className:Xe(As({variant:a?"outline":"ghost",size:n}),r),...i})}function Er({className:r,...a}){return e.jsxs(nt,{"aria-label":"Go to previous page",size:"default",className:Xe("gap-1 px-2.5 sm:pl-2.5",r),...a,children:[e.jsx(Bs,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function kr({className:r,...a}){return e.jsxs(nt,{"aria-label":"Go to next page",size:"default",className:Xe("gap-1 px-2.5 sm:pr-2.5",r),...a,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(qs,{})]})}function Rr(r=640){const[a,n]=l.useState(typeof window<"u"?window.innerWidth<r:!1);return l.useEffect(()=>{function i(){n(window.innerWidth<r)}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[r]),a}function Dr({currentPage:r,setCurrentPage:a,totalPages:n,records:i=[],pageSize:d=10,totalRecords:m=0}){const v=Rr(640)?3:7,C=l.useMemo(()=>{if(n<=v)return[...Array(n)].map((k,u)=>u+1);const o=Math.floor(v/2);let g=Math.max(1,r-o),N=Math.min(n,r+o);r<=o?(g=1,N=v):r+o>=n&&(g=n-v+1,N=n);const P=[];for(let k=g;k<=N;k++)P.push(k);return P},[n,r,v]);return e.jsxs("div",{className:"flex items-center justify-between mt-4 w-full px-4",children:[e.jsxs("div",{className:"hidden sm:block text-sm text-slate-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min(i.length,d)})," of"," ",e.jsx("span",{className:"font-medium",children:m})," records"]}),e.jsx("div",{className:"flex-1 flex justify-center sm:justify-end",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto sm:overflow-visible py-1",children:e.jsx(Nr,{children:e.jsxs(vr,{children:[e.jsx(Ge,{children:e.jsx(Er,{href:"#",onClick:o=>{o.preventDefault(),r>1&&a(r-1)},className:r<=1?"pointer-events-none opacity-50":""})}),C[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{children:e.jsx(nt,{href:"#",onClick:o=>{o.preventDefault(),a(1)},isActive:r===1,children:"1"})}),e.jsx(Ge,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})})]}),C.map(o=>e.jsx(Ge,{children:e.jsx(nt,{href:"#",onClick:g=>{g.preventDefault(),a(o)},isActive:r===o,children:o})},o)),C[C.length-1]<n&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})}),e.jsx(Ge,{children:e.jsx(nt,{href:"#",onClick:o=>{o.preventDefault(),a(n)},isActive:r===n,children:n})})]}),e.jsx(Ge,{children:e.jsx(kr,{href:"#",onClick:o=>{o.preventDefault(),r<n&&a(r+1)},className:r>=n?"pointer-events-none opacity-50":""})})]})})})})]})}const Tr=({type:r="normal"})=>{const[a,n]=Jt(),i=wt(S=>S.user),d=l.useMemo(()=>({pa_id:a.get("pa_id"),us_id:a.get("us_id"),show:a.get("show"),status:a.get("status"),process_name:a.get("process_name")}),[a]),[m,h]=l.useState([]);l.useEffect(()=>{C()},[]);const v=i.schema_name,C=async()=>{const S=`https://click.wa.expert/api/data/getAllTables?schemaName=${v}`,{data:F}=await _e.get(S),Q=F.data.map(J=>J.title);h(Q)},{tableName1:o}=Fs(),g=l.useMemo(()=>({schemaName:i.schema_name,tableName:o,userId:i.id,userEmail:i.email}),[i.schema_name,o,i.id,i.email]),N=(i==null?void 0:i.owner_id)??(i==null?void 0:i.id),[P,k]=l.useState(!1),[u,p]=l.useState(null),[x,z]=l.useState("asc"),[re,D]=l.useState({counter:0,prefix:"",isActive:!1,recordId:null}),[q,te]=l.useState([]),[G,y]=l.useState(!1),[t,s]=l.useState(null),[c,b]=l.useState(""),[_,O]=l.useState(!1),[ue,ye]=l.useState(!1),[ie,U]=l.useState({tableName:"",paId:"",columns:[],metaData:[],dropdownSetup:{},columnOrder:{},formData:{},processSteps:[]}),{originalRecords:Z,columns:E,metaData:xe,loading:M,refreshData:L,currentPage:j,pageSize:oe,paginationInfo:se,goToPage:pe,resetPagination:be}=nr(g,r,N),{columns:T,setColumns:H,toggleColumnVisibility:le,resetColumnVisibility:A,hideAllColumns:ce,visibleColumns:fe}=ir(N,g.tableName,g.schemaName,E),{searchTerm:Y,setSearchTerm:K,statusFilter:B,priorityFilter:Ee,filteredRecords:I,uniqueStatuses:ae,uniquePriorities:Ae,toggleStatusFilter:Pe,togglePriorityFilter:ke,clearFilters:Me,hasActiveFilters:me}=or(Z),Re=l.useCallback(S=>{u===S?z(F=>F==="asc"?"desc":"asc"):(p(S),z("asc"))},[u]),Ce=l.useMemo(()=>u?[...I].sort((S,F)=>{const w=S[u],Q=F[u];if(w&&Q&&typeof w=="string"){const J=Date.parse(w),ne=Date.parse(Q);if(!isNaN(J)&&!isNaN(ne))return x==="asc"?J-ne:ne-J}return typeof w=="string"&&typeof Q=="string"?x==="asc"?w.localeCompare(Q):Q.localeCompare(w):x==="asc"?(w??0)-(Q??0):(Q??0)-(w??0)}):I,[I,u,x]),Oe=se.totalPages,He=se.totalRecords,{formData:Ue,isSubmitting:De,isOpen:Te,handleFieldChange:ze,submitForm:Ve,openForm:it,closeForm:f}=lr(g,r,L),{dropdownSetup:$,columnOrder:R,setupExists:V}=cr(N,g.tableName);l.useEffect(()=>{const S=async()=>{try{const F=`https://click.wa.expert/api/reference/setup/check?owner_id=${N}&product_name=${g.tableName}`,{data:w}=await _e.get(F);w.exists&&w.setup&&w.setup.process_steps?te(w.setup.process_steps):te([])}catch{te([])}};N&&g.tableName&&S()},[N,g.tableName]);const he=async S=>{try{const F={schemaName:i.schema_name,tableName:S,userId:i.id,userEmail:i.email},w=await _e.post("https://click.wa.expert/api/data/getAllData",F),Q=w.data.data||[],J=w.data.columns||[];let ne=[];if(Q.length>0){const Dt=Q[0];ne=Object.keys(Dt).map(et=>({id:et,name:Ie(et),accessor:et,sortable:!0,visible:!0,type:X(Dt[et],et)}))}const Ye=`https://click.wa.expert/api/reference/setup/check?owner_id=${N}&product_name=${S}`,ve=await _e.get(Ye);let $e={},Je={},Rt=[];return ve.data.exists&&ve.data.setup&&($e=ve.data.setup.mapping||{},Je=ve.data.setup.columnOrder||{},Rt=ve.data.setup.process_steps||[]),{columns:ne,metaData:J,dropdownSetup:$e,columnOrder:Je,processName:null,processSteps:Rt}}catch(F){throw F}},Ie=S=>S.split("_").map(F=>F.charAt(0).toUpperCase()+F.slice(1)).join(" "),X=(S,F)=>{const w=F.toLowerCase();return w.includes("email")?"email":w.includes("phone")?"tel":w.includes("url")||w.includes("link")?"url":w==="status"?"select-status":w==="priority"?"select-priority":w.includes("description")||w.includes("notes")||w.includes("comment")?"textarea":w.includes("date")||w.includes("created")||w.includes("updated")?"date":typeof S=="number"?"number":typeof S=="boolean"?"checkbox":S&&S.length>100?"textarea":"text"},ge=async(S,F)=>{try{const w=await he(S),Q={pa_id:F,us_id:Nt()};w.columns.some(ne=>ne.id==="status"||ne.id.toLowerCase()==="status")&&w.processSteps&&w.processSteps.length>0&&(Q.status=w.processSteps[0]),w.columns.forEach(ne=>{Q[ne.id]||(Q[ne.id]="")}),U({tableName:S,paId:F,columns:w.columns,metaData:w.metaData,dropdownSetup:w.dropdownSetup,columnOrder:w.columnOrder,formData:Q,processSteps:w.processSteps||[]}),ye(!0),W.success("Form loaded successfully")}catch(w){throw W.error("Failed to load form"),w}},Ne=(S,F)=>{U(w=>({...w,formData:{...w.formData,[S]:F}}))},ot=async()=>{var S,F;try{const w={};Object.entries(ie.formData).forEach(([J,ne])=>{if(ne!==""&&ne!==null&&ne!==void 0){const Ye=ie.metaData.find(ve=>ve.column_name===J);if(Ye){const ve=Ye.data_type.toLowerCase();if(ve.includes("int")||ve.includes("serial")){const $e=parseInt(ne,10);isNaN($e)||(w[J]=$e)}else if(ve.includes("numeric")||ve.includes("decimal")||ve.includes("float")){const $e=parseFloat(ne);isNaN($e)||(w[J]=$e)}else ve.includes("bool")?w[J]=ne===!0||ne==="true"||ne==="1":w[J]=ne}else w[J]=ne}}),w.us_id&&w.pa_id&&(w.us_id=`${w.pa_id} -S- ${w.us_id}`);const Q={schemaName:i.schema_name,tableName:ie.tableName};await Le.createRecord(Q,w),W.success("Split record created successfully"),ye(!1),U({tableName:"",paId:"",columns:[],metaData:[],dropdownSetup:{},columnOrder:{},formData:{},processSteps:[]}),L()}catch(w){throw W.error("Failed to create split record: "+(((F=(S=w.response)==null?void 0:S.data)==null?void 0:F.details)||w.message)),w}},Ze=()=>{ye(!1),U({tableName:"",paId:"",columns:[],metaData:[],dropdownSetup:{},columnOrder:{},formData:{},processSteps:[]})};l.useEffect(()=>{E.length>0&&T.length===0&&H(E)},[E]),l.useEffect(()=>{const S=a.get("search");S&&K(decodeURIComponent(S))},[a,K]),l.useEffect(()=>{d.show==="true"&&T.length>0&&kt()},[d.show,T]);const lt=l.useCallback(S=>{D(S)},[]),We=l.useCallback(()=>{L(),Me(),be(),W.success("Data refreshed")},[L,Me,be]),us=l.useCallback(S=>{K(S.target.value),be()},[K,be]),hs=l.useCallback(()=>{if(!I.length){W.error("No records to export");return}try{const S=I.map(ve=>{const $e={};return fe.forEach(Je=>{$e[Je.name]=ve[Je.id]}),$e}),F=Zs.unparse(S,{quotes:!0,quoteChar:'"',delimiter:",",header:!0}),w=new Blob([F],{type:"text/csv;charset=utf-8;"}),Q=URL.createObjectURL(w),J=document.createElement("a"),ne=new Date().toISOString().slice(0,10),Ye=`${g.tableName}_export_${ne}.csv`;J.setAttribute("href",Q),J.setAttribute("download",Ye),J.style.display="none",document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(Q),W.success(`Exported ${S.length} records to CSV`)}catch(S){de.error("Error exporting CSV:",S),W.error("Failed to export CSV")}},[I,fe,g.tableName]),kt=l.useCallback(async()=>{const S={};if(T.forEach(F=>{d[F.id]?S[F.id]=d[F.id]:F.id==="us_id"?S[F.id]=re.isActive?`${re.prefix}${re.counter}`:Nt():F.id==="status"&&q.length>0?S[F.id]=q[0]:S[F.id]=""}),it(S),d.show==="true"){const F=new URLSearchParams(a);F.delete("show"),n(F,{replace:!0})}},[T,d,re,it,a,n,q]),fs=l.useCallback(async()=>{try{let S={};if(d.process_name){const F=`${d.process_name}_balance`,w=T.find(Q=>Q.id.toLowerCase().includes("quantity"));if(w){const Q=Ue[w.id];Q&&(S[F]=Q)}}if((d.status&&d.pa_id||d.process_name&&d.pa_id)&&(S.us_id=`${d.pa_id} -S- ${Ue.us_id}`),await Ve(S),re.isActive&&re.recordId)try{await Le.updateRecord({schemaName:"public",tableName:"counter_setup"},re.recordId,N,{counter:re.counter+1}),D(F=>({...F,counter:F.counter+1}))}catch(F){de.error("Counter increment failed:",F),W.warning("Record created but counter increment failed")}n({})}catch(S){de.error("Create record failed:",S)}},[Ue,T,d,re,Ve,N,n]),ps=l.useCallback(S=>{s(S),b(""),y(!0)},[]),ms=l.useCallback(async()=>{if(!t||c.trim()!==t.us_id){W.error("Entered us_id does not match");return}try{O(!0),await Le.deleteRecord(g,t.id),W.success("Record deleted successfully"),y(!1),s(null),b(""),L()}catch(S){de.error("Delete failed:",S),W.error("Failed to delete record")}finally{O(!1)}},[t,c,g,L]),gs=l.useCallback(async(S,F)=>{try{const w=Z.find(J=>J.id===S),Q={};if(Object.entries(F).forEach(([J,ne])=>{ne!==w[J]&&J!=="id"&&J!=="pa_id"&&J!=="us_id"&&(Q[J]=ne)}),Object.keys(Q).length===0){W.warning("No changes to save");return}await Le.updateRecord(g,S,N,Q),W.success("Record updated successfully"),L()}catch(w){de.error("Update failed:",w),W.error("Failed to update record")}},[Z,g,N,L]);return d.show==="true"?null:e.jsxs(Bt,{className:"tableCard shadow-sm border-slate-200 mx-[6rem]",children:[e.jsx(qt,{className:"pb-3",children:e.jsx(gr,{title:"All Records - "+g.tableName,description:"View and manage all database records",searchTerm:Y,onSearchChange:us,tableName:g.tableName,onCounterUpdate:lt,urlParams:d,dropdownSetupExists:V,columnOrderExists:Object.keys(R).length>0})}),e.jsxs(Vt,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(_r,{onRefresh:We,onAddRecord:kt,onExportCSV:hs,onToggleEdit:()=>k(!P),editEnabled:P,canEdit:i.owner_id===null,isLoading:M,splitOptions:m,onSplitLoad:ge}),e.jsx(yr,{uniqueStatuses:ae,uniquePriorities:Ae,statusFilter:B,priorityFilter:Ee,onToggleStatus:Pe,onTogglePriority:ke,onClearStatusFilter:()=>Pe([]),onClearPriorityFilter:()=>ke([])}),e.jsx(Cr,{columns:T,onToggleColumn:le,onResetVisibility:A,onHideAll:ce})]})}),e.jsx(jr,{records:Ce,columns:T,loading:M,editEnabled:P,canDelete:i.owner_id===null,onSort:Re,onDeleteRecord:ps,onSaveRecord:gs,sortColumn:u,sortDirection:x,emptyMessage:me?"No records match filters":"No records found",onClearFilters:me?Me:null}),e.jsx(Dr,{currentPage:j,setCurrentPage:pe,totalPages:Oe,records:Ce,pageSize:oe,totalRecords:He})]}),e.jsx(Ut,{isOpen:Te,onClose:f,onSubmit:fs,formData:Ue,onFieldChange:ze,columns:T,metaData:xe,dropdownSetup:$,columnOrder:R,processName:d.process_name,isSubmitting:De,counterConfig:re,setCounterConfig:D,mode:"create",processSteps:q}),e.jsx(Ut,{isOpen:ue,onClose:Ze,onSubmit:ot,formData:ie.formData,onFieldChange:Ne,columns:ie.columns,metaData:ie.metaData,dropdownSetup:ie.dropdownSetup,columnOrder:ie.columnOrder,processName:null,isSubmitting:De,counterConfig:re,setCounterConfig:D,mode:"create",itsSplit:!0,processSteps:ie.processSteps||[]}),e.jsx(Sr,{isOpen:G,onClose:()=>y(!1),onConfirm:ms,record:t,confirmInput:c,onConfirmInputChange:b,isDeleting:_})]})},Vr=r=>e.jsx(Ks,{children:e.jsx(Tr,{...r})});export{Vr as default};
