var Dt=Object.defineProperty;var Ot=(a,r,n)=>r in a?Dt(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n;var Ye=(a,r,n)=>Ot(a,typeof r!="symbol"?r+"":r,n);import{e as He,R as It,j as e,C as lt,g as ct,h as dt,k as ut,B as Q,a0 as Tt,c as xe,r as u,a1 as te,a as ht,L as Be,I as je,i as At,l as ue,x as Ft,a9 as ft,aa as pt,ab as mt,ac as We,ay as Je,ad as Ge,az as xt,ax as Lt,o as Ze,p as et,q as tt,t as st,v as Pe,_ as Fe,$ as Mt,ao as Pt,av as $t,ak as Ut}from"./index-B9v0YaNK.js";import{S as zt}from"./switch-BiSU51Yw.js";import{S as Bt}from"./save-gfJedgK3.js";import{R as gt}from"./refresh-cw-DQRFPtDX.js";import{A as qt}from"./CustomTable-BSdwSrH9.js";import{P as Ht}from"./plus-CPlSHrD4.js";import{S as Vt}from"./square-pen-DmMf2spB.js";import{C as bt}from"./checkbox-hWLs2Yer.js";import{S as Wt}from"./sliders-horizontal-DN_I4yP1.js";import{T as Gt,a as Kt,b as $e,c as rt,d as Xt,e as Ue}from"./table-B_CrrUnn.js";import{T as yt}from"./trash-2-CeZ11CVa.js";import{D as _t,b as wt,c as Ct,d as jt,e as vt,f as Ke}from"./dialog-CPc3Jo5t.js";import{T as Qt}from"./textarea-Dx-pb8c9.js";import{C as Yt}from"./chevron-left-CNRhi9Xl.js";import"./index--9-JJASu.js";import"./x-BdmiHPv3.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Zt=He("file-spreadsheet",Jt);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ts=He("file-text",es);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],rs=He("funnel",ss);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],as=He("triangle-alert",ns);class is extends It.Component{constructor(n){super(n);Ye(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,i){this.setState({error:n,errorInfo:i})}render(){return this.state.hasError?e.jsxs(lt,{className:"mx-[6rem] mt-8",children:[e.jsx(ct,{children:e.jsxs(dt,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(as,{className:"h-5 w-5"}),"Something went wrong"]})}),e.jsxs(ut,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"The table encountered an error. Please try refreshing the page."}),!1,e.jsx(Q,{onClick:this.handleReset,children:"Reload Page"})]})]}):this.props.children}}var ze={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var os=ze.exports,nt;function ls(){return nt||(nt=1,function(a,r){((n,i)=>{a.exports=i()})(os,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},l,f=!i.document&&!!i.postMessage,h=i.IS_PAPA_WORKER||!1,b={},y=0,o={};function C(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(s){var c=Y(s);c.chunkSize=parseInt(c.chunkSize),s.step||s.chunk||(c.chunkSize=null),this._handle=new p(c),(this._handle.streamer=this)._config=c}).call(this,t),this.parseChunk=function(s,c){var x=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<x){let k=this._config.newline;k||(m=this._config.quoteChar||'"',k=this._handle.guessLineEndings(s,m)),s=[...s.split(k).slice(x)].join(k)}this.isFirstChunk&&g(this._config.beforeFirstChunk)&&(m=this._config.beforeFirstChunk(s))!==void 0&&(s=m),this.isFirstChunk=!1,this._halted=!1;var x=this._partialLine+s,m=(this._partialLine="",this._handle.parse(x,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(s=m.meta.cursor,x=(this._finished||(this._partialLine=x.substring(s-this._baseIndex),this._baseIndex=s),m&&m.data&&(this._rowCount+=m.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),h)i.postMessage({results:m,workerId:o.WORKER_ID,finished:x});else if(g(this._config.chunk)&&!c){if(this._config.chunk(m,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=m=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(m.data),this._completeResults.errors=this._completeResults.errors.concat(m.errors),this._completeResults.meta=m.meta),this._completed||!x||!g(this._config.complete)||m&&m.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),x||m&&m.meta.paused||this._nextChunk(),m}this._halted=!0},this._sendError=function(s){g(this._config.error)?this._config.error(s):h&&this._config.error&&i.postMessage({workerId:o.WORKER_ID,error:s,finished:!1})}}function A(t){var s;(t=t||{}).chunkSize||(t.chunkSize=o.RemoteChunkSize),C.call(this,t),this._nextChunk=f?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),f||(s.onload=U(this._chunkLoaded,this),s.onerror=U(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!f),this._config.downloadRequestHeaders){var c,x=this._config.downloadRequestHeaders;for(c in x)s.setRequestHeader(c,x[c])}var m;this._config.chunkSize&&(m=this._start+this._config.chunkSize-1,s.setRequestHeader("Range","bytes="+this._start+"-"+m));try{s.send(this._config.downloadRequestBody)}catch(k){this._chunkError(k.message)}f&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize||s.responseText.length,this._finished=!this._config.chunkSize||this._start>=(c=>(c=c.getResponseHeader("Content-Range"))!==null?parseInt(c.substring(c.lastIndexOf("/")+1)):-1)(s),this.parseChunk(s.responseText)))},this._chunkError=function(c){c=s.statusText||c,this._sendError(new Error(c))}}function M(t){(t=t||{}).chunkSize||(t.chunkSize=o.LocalChunkSize),C.call(this,t);var s,c,x=typeof FileReader<"u";this.stream=function(m){this._input=m,c=m.slice||m.webkitSlice||m.mozSlice,x?((s=new FileReader).onload=U(this._chunkLoaded,this),s.onerror=U(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var m=this._input,k=(this._config.chunkSize&&(k=Math.min(this._start+this._config.chunkSize,this._input.size),m=c.call(m,this._start,k)),s.readAsText(m,this._config.encoding));x||this._chunkLoaded({target:{result:k}})},this._chunkLoaded=function(m){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(m.target.result)},this._chunkError=function(){this._sendError(s.error)}}function D(t){var s;C.call(this,t=t||{}),this.stream=function(c){return s=c,this._nextChunk()},this._nextChunk=function(){var c,x;if(!this._finished)return c=this._config.chunkSize,s=c?(x=s.substring(0,c),s.substring(c)):(x=s,""),this._finished=!s,this.parseChunk(x)}}function d(t){C.call(this,t=t||{});var s=[],c=!0,x=!1;this.pause=function(){C.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){C.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(m){this._input=m,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){x&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):c=!0},this._streamData=U(function(m){try{s.push(typeof m=="string"?m:m.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(k){this._streamError(k)}},this),this._streamError=U(function(m){this._streamCleanUp(),this._sendError(m)},this),this._streamEnd=U(function(){this._streamCleanUp(),x=!0,this._streamData("")},this),this._streamCleanUp=U(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(t){var s,c,x,m,k=Math.pow(2,53),$=-k,he=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,O=this,K=0,v=0,le=!1,S=!1,T=[],_={data:[],errors:[],meta:{}};function H(I){return t.skipEmptyLines==="greedy"?I.join("").trim()==="":I.length===1&&I[0].length===0}function J(){if(_&&x&&(de("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),x=!1),t.skipEmptyLines&&(_.data=_.data.filter(function(N){return!H(N)})),ae()){let N=function(X,ee){g(t.transformHeader)&&(X=t.transformHeader(X,ee)),T.push(X)};if(_)if(Array.isArray(_.data[0])){for(var I=0;ae()&&I<_.data.length;I++)_.data[I].forEach(N);_.data.splice(0,1)}else _.data.forEach(N)}function L(N,X){for(var ee=t.header?{}:[],z=0;z<N.length;z++){var P=z,R=N[z],R=((pe,E)=>(G=>(t.dynamicTypingFunction&&t.dynamicTyping[G]===void 0&&(t.dynamicTyping[G]=t.dynamicTypingFunction(G)),(t.dynamicTyping[G]||t.dynamicTyping)===!0))(pe)?E==="true"||E==="TRUE"||E!=="false"&&E!=="FALSE"&&((G=>{if(he.test(G)&&(G=parseFloat(G),$<G&&G<k))return 1})(E)?parseFloat(E):fe.test(E)?new Date(E):E===""?null:E):E)(P=t.header?z>=T.length?"__parsed_extra":T[z]:P,R=t.transform?t.transform(R,P):R);P==="__parsed_extra"?(ee[P]=ee[P]||[],ee[P].push(R)):ee[P]=R}return t.header&&(z>T.length?de("FieldMismatch","TooManyFields","Too many fields: expected "+T.length+" fields but parsed "+z,v+X):z<T.length&&de("FieldMismatch","TooFewFields","Too few fields: expected "+T.length+" fields but parsed "+z,v+X)),ee}var W;_&&(t.header||t.dynamicTyping||t.transform)&&(W=1,!_.data.length||Array.isArray(_.data[0])?(_.data=_.data.map(L),W=_.data.length):_.data=L(_.data,0),t.header&&_.meta&&(_.meta.fields=T),v+=W)}function ae(){return t.header&&T.length===0}function de(I,L,W,N){I={type:I,code:L,message:W},N!==void 0&&(I.row=N),_.errors.push(I)}g(t.step)&&(m=t.step,t.step=function(I){_=I,ae()?J():(J(),_.data.length!==0&&(K+=I.data.length,t.preview&&K>t.preview?c.abort():(_.data=_.data[0],m(_,O))))}),this.parse=function(I,L,W){var N=t.quoteChar||'"',N=(t.newline||(t.newline=this.guessLineEndings(I,N)),x=!1,t.delimiter?g(t.delimiter)&&(t.delimiter=t.delimiter(I),_.meta.delimiter=t.delimiter):((N=((X,ee,z,P,R)=>{var pe,E,G,we;R=R||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Ne=0;Ne<R.length;Ne++){for(var ge,Re=R[Ne],ie=0,be=0,se=0,ce=(G=void 0,new B({comments:P,delimiter:Re,newline:ee,preview:10}).parse(X)),Ce=0;Ce<ce.data.length;Ce++)z&&H(ce.data[Ce])?se++:(ge=ce.data[Ce].length,be+=ge,G===void 0?G=ge:0<ge&&(ie+=Math.abs(ge-G),G=ge));0<ce.data.length&&(be/=ce.data.length-se),(E===void 0||ie<=E)&&(we===void 0||we<be)&&1.99<be&&(E=ie,pe=Re,we=be)}return{successful:!!(t.delimiter=pe),bestDelimiter:pe}})(I,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=N.bestDelimiter:(x=!0,t.delimiter=o.DefaultDelimiter),_.meta.delimiter=t.delimiter),Y(t));return t.preview&&t.header&&N.preview++,s=I,c=new B(N),_=c.parse(s,L,W),J(),le?{meta:{paused:!0}}:_||{meta:{paused:!1}}},this.paused=function(){return le},this.pause=function(){le=!0,c.abort(),s=g(t.chunk)?"":s.substring(c.getCharIndex())},this.resume=function(){O.streamer._halted?(le=!1,O.streamer.parseChunk(s,!0)):setTimeout(O.resume,3)},this.aborted=function(){return S},this.abort=function(){S=!0,c.abort(),_.meta.aborted=!0,g(t.complete)&&t.complete(_),s=""},this.guessLineEndings=function(X,N){X=X.substring(0,1048576);var N=new RegExp(w(N)+"([^]*?)"+w(N),"gm"),W=(X=X.replace(N,"")).split("\r"),N=X.split(`
`),X=1<N.length&&N[0].length<W[0].length;if(W.length===1||X)return`
`;for(var ee=0,z=0;z<W.length;z++)W[z][0]===`
`&&ee++;return ee>=W.length/2?`\r
`:"\r"}}function w(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function B(t){var s=(t=t||{}).delimiter,c=t.newline,x=t.comments,m=t.step,k=t.preview,$=t.fastMode,he=null,fe=!1,O=t.quoteChar==null?'"':t.quoteChar,K=O;if(t.escapeChar!==void 0&&(K=t.escapeChar),(typeof s!="string"||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=","),x===s)throw new Error("Comment character same as delimiter");x===!0?x="#":(typeof x!="string"||-1<o.BAD_DELIMITERS.indexOf(x))&&(x=!1),c!==`
`&&c!=="\r"&&c!==`\r
`&&(c=`
`);var v=0,le=!1;this.parse=function(S,T,_){if(typeof S!="string")throw new Error("Input must be a string");var H=S.length,J=s.length,ae=c.length,de=x.length,I=g(m),L=[],W=[],N=[],X=v=0;if(!S)return ie();if($||$!==!1&&S.indexOf(O)===-1){for(var ee=S.split(c),z=0;z<ee.length;z++){if(N=ee[z],v+=N.length,z!==ee.length-1)v+=c.length;else if(_)return ie();if(!x||N.substring(0,de)!==x){if(I){if(L=[],we(N.split(s)),be(),le)return ie()}else we(N.split(s));if(k&&k<=z)return L=L.slice(0,k),ie(!0)}}return ie()}for(var P=S.indexOf(s,v),R=S.indexOf(c,v),pe=new RegExp(w(K)+w(O),"g"),E=S.indexOf(O,v);;)if(S[v]===O)for(E=v,v++;;){if((E=S.indexOf(O,E+1))===-1)return _||W.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:L.length,index:v}),ge();if(E===H-1)return ge(S.substring(v,E).replace(pe,O));if(O===K&&S[E+1]===K)E++;else if(O===K||E===0||S[E-1]!==K){P!==-1&&P<E+1&&(P=S.indexOf(s,E+1));var G=Ne((R=R!==-1&&R<E+1?S.indexOf(c,E+1):R)===-1?P:Math.min(P,R));if(S.substr(E+1+G,J)===s){N.push(S.substring(v,E).replace(pe,O)),S[v=E+1+G+J]!==O&&(E=S.indexOf(O,v)),P=S.indexOf(s,v),R=S.indexOf(c,v);break}if(G=Ne(R),S.substring(E+1+G,E+1+G+ae)===c){if(N.push(S.substring(v,E).replace(pe,O)),Re(E+1+G+ae),P=S.indexOf(s,v),E=S.indexOf(O,v),I&&(be(),le))return ie();if(k&&L.length>=k)return ie(!0);break}W.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:L.length,index:v}),E++}}else if(x&&N.length===0&&S.substring(v,v+de)===x){if(R===-1)return ie();v=R+ae,R=S.indexOf(c,v),P=S.indexOf(s,v)}else if(P!==-1&&(P<R||R===-1))N.push(S.substring(v,P)),v=P+J,P=S.indexOf(s,v);else{if(R===-1)break;if(N.push(S.substring(v,R)),Re(R+ae),I&&(be(),le))return ie();if(k&&L.length>=k)return ie(!0)}return ge();function we(se){L.push(se),X=v}function Ne(se){var ce=0;return ce=se!==-1&&(se=S.substring(E+1,se))&&se.trim()===""?se.length:ce}function ge(se){return _||(se===void 0&&(se=S.substring(v)),N.push(se),v=H,we(N),I&&be()),ie()}function Re(se){v=se,we(N),N=[],R=S.indexOf(c,v)}function ie(se){if(t.header&&!T&&L.length&&!fe){var ce=L[0],Ce={},Te=new Set(ce);let Le=!1;for(let ke=0;ke<ce.length;ke++){let ye=ce[ke];if(Ce[ye=g(t.transformHeader)?t.transformHeader(ye,ke):ye]){let De,Me=Ce[ye];for(;De=ye+"_"+Me,Me++,Te.has(De););Te.add(De),ce[ke]=De,Ce[ye]++,Le=!0,(he=he===null?{}:he)[De]=ye}else Ce[ye]=1,ce[ke]=ye;Te.add(ye)}fe=!0}return{data:L,errors:W,meta:{delimiter:s,linebreak:c,aborted:le,truncated:!!se,cursor:X+(T||0),renamedHeaders:he}}}function be(){m(ie()),L=[],W=[]}},this.abort=function(){le=!0},this.getCharIndex=function(){return v}}function ne(t){var s=t.data,c=b[s.workerId],x=!1;if(s.error)c.userError(s.error,s.file);else if(s.results&&s.results.data){var m={abort:function(){x=!0,j(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:q,resume:q};if(g(c.userStep)){for(var k=0;k<s.results.data.length&&(c.userStep({data:s.results.data[k],errors:s.results.errors,meta:s.results.meta},m),!x);k++);delete s.results}else g(c.userChunk)&&(c.userChunk(s.results,m,s.file),delete s.results)}s.finished&&!x&&j(s.workerId,s.results)}function j(t,s){var c=b[t];g(c.userComplete)&&c.userComplete(s),c.terminate(),delete b[t]}function q(){throw new Error("Not implemented.")}function Y(t){if(typeof t!="object"||t===null)return t;var s,c=Array.isArray(t)?[]:{};for(s in t)c[s]=Y(t[s]);return c}function U(t,s){return function(){t.apply(s,arguments)}}function g(t){return typeof t=="function"}return o.parse=function(t,s){var c=(s=s||{}).dynamicTyping||!1;if(g(c)&&(s.dynamicTypingFunction=c,c={}),s.dynamicTyping=c,s.transform=!!g(s.transform)&&s.transform,!s.worker||!o.WORKERS_SUPPORTED)return c=null,o.NODE_STREAM_INPUT,typeof t=="string"?(t=(x=>x.charCodeAt(0)!==65279?x:x.slice(1))(t),c=new(s.download?A:D)(s)):t.readable===!0&&g(t.read)&&g(t.on)?c=new d(s):(i.File&&t instanceof File||t instanceof Object)&&(c=new M(s)),c.stream(t);(c=(()=>{var x;return!!o.WORKERS_SUPPORTED&&(x=(()=>{var m=i.URL||i.webkitURL||null,k=n.toString();return o.BLOB_URL||(o.BLOB_URL=m.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",k,")();"],{type:"text/javascript"})))})(),(x=new i.Worker(x)).onmessage=ne,x.id=y++,b[x.id]=x)})()).userStep=s.step,c.userChunk=s.chunk,c.userComplete=s.complete,c.userError=s.error,s.step=g(s.step),s.chunk=g(s.chunk),s.complete=g(s.complete),s.error=g(s.error),delete s.worker,c.postMessage({input:t,config:s,workerId:c.id})},o.unparse=function(t,s){var c=!1,x=!0,m=",",k=`\r
`,$='"',he=$+$,fe=!1,O=null,K=!1,v=((()=>{if(typeof s=="object"){if(typeof s.delimiter!="string"||o.BAD_DELIMITERS.filter(function(T){return s.delimiter.indexOf(T)!==-1}).length||(m=s.delimiter),typeof s.quotes!="boolean"&&typeof s.quotes!="function"&&!Array.isArray(s.quotes)||(c=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(fe=s.skipEmptyLines),typeof s.newline=="string"&&(k=s.newline),typeof s.quoteChar=="string"&&($=s.quoteChar),typeof s.header=="boolean"&&(x=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");O=s.columns}s.escapeChar!==void 0&&(he=s.escapeChar+$),s.escapeFormulae instanceof RegExp?K=s.escapeFormulae:typeof s.escapeFormulae=="boolean"&&s.escapeFormulae&&(K=/^[=+\-@\t\r].*$/)}})(),new RegExp(w($),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return le(null,t,fe);if(typeof t[0]=="object")return le(O||Object.keys(t[0]),t,fe)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||O),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),le(t.fields||[],t.data||[],fe);throw new Error("Unable to serialize unrecognized input");function le(T,_,H){var J="",ae=(typeof T=="string"&&(T=JSON.parse(T)),typeof _=="string"&&(_=JSON.parse(_)),Array.isArray(T)&&0<T.length),de=!Array.isArray(_[0]);if(ae&&x){for(var I=0;I<T.length;I++)0<I&&(J+=m),J+=S(T[I],I);0<_.length&&(J+=k)}for(var L=0;L<_.length;L++){var W=(ae?T:_[L]).length,N=!1,X=ae?Object.keys(_[L]).length===0:_[L].length===0;if(H&&!ae&&(N=H==="greedy"?_[L].join("").trim()==="":_[L].length===1&&_[L][0].length===0),H==="greedy"&&ae){for(var ee=[],z=0;z<W;z++){var P=de?T[z]:z;ee.push(_[L][P])}N=ee.join("").trim()===""}if(!N){for(var R=0;R<W;R++){0<R&&!X&&(J+=m);var pe=ae&&de?T[R]:R;J+=S(_[L][pe],R)}L<_.length-1&&(!H||0<W&&!X)&&(J+=k)}}return J}function S(T,_){var H,J;return T==null?"":T.constructor===Date?JSON.stringify(T).slice(1,25):(J=!1,K&&typeof T=="string"&&K.test(T)&&(T="'"+T,J=!0),H=T.toString().replace(v,he),(J=J||c===!0||typeof c=="function"&&c(T,_)||Array.isArray(c)&&c[_]||((ae,de)=>{for(var I=0;I<de.length;I++)if(-1<ae.indexOf(de[I]))return!0;return!1})(H,o.BAD_DELIMITERS)||-1<H.indexOf(m)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?$+H+$:H)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!f&&!!i.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=B,o.ParserHandle=p,o.NetworkStreamer=A,o.FileStreamer=M,o.StringStreamer=D,o.ReadableStreamStreamer=d,i.jQuery&&((l=i.jQuery).fn.parse=function(t){var s=t.config||{},c=[];return this.each(function(k){if(!(l(this).prop("tagName").toUpperCase()==="INPUT"&&l(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var $=0;$<this.files.length;$++)c.push({file:this.files[$],inputElem:this,instanceConfig:l.extend({},s)})}),x(),this;function x(){if(c.length===0)g(t.complete)&&t.complete();else{var k,$,he,fe,O=c[0];if(g(t.before)){var K=t.before(O.file,O.inputElem);if(typeof K=="object"){if(K.action==="abort")return k="AbortError",$=O.file,he=O.inputElem,fe=K.reason,void(g(t.error)&&t.error({name:k},$,he,fe));if(K.action==="skip")return void m();typeof K.config=="object"&&(O.instanceConfig=l.extend(O.instanceConfig,K.config))}else if(K==="skip")return void m()}var v=O.instanceConfig.complete;O.instanceConfig.complete=function(le){g(v)&&v(le,O.file,O.inputElem),m()},o.parse(O.file,O.instanceConfig)}}function m(){c.splice(0,1),x()}}),h&&(i.onmessage=function(t){t=t.data,o.WORKER_ID===void 0&&t&&(o.WORKER_ID=t.workerId),typeof t.input=="string"?i.postMessage({workerId:o.WORKER_ID,results:o.parse(t.input,t.config),finished:!0}):(i.File&&t.input instanceof File||t.input instanceof Object)&&(t=o.parse(t.input,t.config))&&i.postMessage({workerId:o.WORKER_ID,results:t,finished:!0})}),(A.prototype=Object.create(C.prototype)).constructor=A,(M.prototype=Object.create(C.prototype)).constructor=M,(D.prototype=Object.create(D.prototype)).constructor=D,(d.prototype=Object.create(C.prototype)).constructor=d,o})}(ze)),ze.exports}var cs=ls();const ds=Tt(cs),V={debug:(...a)=>{},info:(...a)=>{},warn:(...a)=>{},error:(...a)=>{},group:(a,r)=>{}},Se="https://click.wa.expert/api",Ee={fetchRecords:async a=>{try{V.debug("Fetching records with params:",a);const r=await xe.post(`${Se}/data/getAllData`,a);return{data:r.data.data||[],columns:r.data.columns||[],success:!0}}catch(r){throw V.error("Error fetching records:",r),r}},fetchPaymentRecords:async a=>{try{const r=await xe.get(`${Se}/payment-reminders/list?owner_id=${a}`);return{data:r.data.data||r.data||[],success:!0}}catch(r){throw V.error("Error fetching payment records:",r),r}},fetchRecordById:async(a,r)=>{try{const n=decodeURIComponent(r);return{data:(await xe.post(`${Se}/data/getRecordById`,{schemaName:a.schemaName,tableName:a.tableName,id:n})).data,success:!0}}catch(n){return V.error("Error fetching record by ID:",n),{data:null,success:!1,error:n.message}}},createRecord:async(a,r)=>{try{return{data:(await xe.post(`${Se}/data/createRecord`,{schemaName:a.schemaName,tableName:a.tableName,record:r})).data,success:!0}}catch(n){throw V.error("Error creating record:",n),n}},createPaymentReminder:async a=>{try{return{data:(await xe.post(`${Se}/payment-reminders/add`,a,{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(r){throw V.error("Error creating payment reminder:",r),r}},updateRecord:async(a,r,n,i)=>{try{return{data:(await xe.post(`${Se}/data/updateMultiple`,{schemaName:a.schemaName,tableName:a.tableName,recordId:r,ownerId:n,updates:i},{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(l){throw V.error("Error updating record:",l),l}},deleteRecord:async(a,r)=>{try{const n=new URLSearchParams({id:r,schemaName:a.schemaName,tableName:a.tableName});return{data:(await xe.get(`${Se}/data/deleteRecord?${n.toString()}`)).data,success:!0}}catch(n){throw V.error("Error deleting record:",n),n}},fetchDropdownSetup:async(a,r)=>{try{const n=await xe.get(`${Se}/reference/setup/check?owner_id=${a}&product_name=${r}`);return n.data.exists&&n.data.setup?{mapping:n.data.setup.mapping||{},columnOrder:n.data.setup.columnOrder||{},exists:!0,success:!0}:{mapping:{},columnOrder:{},exists:!1,success:!0}}catch(n){return V.error("Error fetching dropdown setup:",n),{mapping:{},columnOrder:{},exists:!1,success:!1}}}},us={DEFAULT_PAGE_SIZE:20},oe={TEXT:"text",NUMBER:"number",EMAIL:"email",PHONE:"tel",URL:"url",DATE:"date",TEXTAREA:"textarea",CHECKBOX:"checkbox",SELECT_STATUS:"select-status",SELECT_PRIORITY:"select-priority"},Ve={PENDING:"pending",IN_PROGRESS:"in progress",COMPLETED:"completed"},Ie={LOW:"low",MEDIUM:"medium",HIGH:"high"},Nt={[Ve.PENDING]:"bg-yellow-100 text-yellow-700 border-yellow-200",[Ve.IN_PROGRESS]:"bg-blue-100 text-blue-700 border-blue-200",[Ve.COMPLETED]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},kt={[Ie.HIGH]:"bg-red-100 text-red-700 border-red-200",[Ie.MEDIUM]:"bg-orange-100 text-orange-700 border-orange-200",[Ie.LOW]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},hs=["invoice","date","due_date","final_due_date","last_overdue_reminder_date","sent_at","created_at","updated_at"],fs=["out_webhooks","emails"],at={PA_ID:"pa_id"},ps=a=>a.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),ms=(a,r)=>{const n=r.toLowerCase();return n.includes("email")?oe.EMAIL:n.includes("phone")?oe.PHONE:n.includes("url")||n.includes("link")||n.includes("invoice_url")?oe.URL:n==="status"?oe.SELECT_STATUS:n==="priority"?oe.SELECT_PRIORITY:n.includes("description")||n.includes("notes")||n.includes("comment")?oe.TEXTAREA:n.includes("date")||n.includes("created")||n.includes("updated")||n==="invoice"?oe.DATE:typeof a=="number"?oe.NUMBER:typeof a=="boolean"?oe.CHECKBOX:a&&a.length>100?oe.TEXTAREA:oe.TEXT},xs=()=>Date.now().toString(),qe=(a,r)=>r[a==null?void 0:a.toLowerCase()]||r.default,gs=(a,r=null)=>a.filter(n=>{if(n.id==="id"||n.id.includes("_comment")||n.id.includes("created_at")||n.id.includes("updated_at"))return!1;if(r){const i=n.id.toLowerCase(),l=n.name.toLowerCase();if(i.includes("balance")||l.includes("balance"))return!1}return!0}),bs=(a,r={})=>a.filter(n=>r[n.id]!==0).sort((n,i)=>{const l=r[n.id]||999,f=r[i.id]||999;return l!==f?l-f:n.name.localeCompare(i.name)}),ys=(a,r=[],n=[])=>Object.fromEntries(Object.entries(a).map(([i,l])=>r.includes(i)?[i,l===""?null:l]:n.includes(i)?l===""?[i,null]:[i,l]:[i,l===""?null:l])),_s=(a,r=[])=>Object.fromEntries(Object.entries(a).filter(([n,i])=>i!=null&&i!==""?!0:r.includes(n))),ws=(a,r="normal",n)=>{const[i,l]=u.useState([]),[f,h]=u.useState([]),[b,y]=u.useState([]),[o,C]=u.useState({}),[A,M]=u.useState(!0),D=u.useCallback(async()=>{try{M(!0),V.debug("Fetching table data",{apiParams:a,type:r});let d;r==="normal"?(d=await Ee.fetchRecords(a),C(d.columns)):d=await Ee.fetchPaymentRecords(n);let p=d.data||[];if(r==="payment"&&(p=p.filter(w=>w.type==="original"||w.type==="Original")),h(p),l(p),p.length>0){const w=p[0],B=Object.keys(w).map(ne=>({id:ne,name:ps(ne),sortable:!0,visible:!0,type:ms(w[ne],ne)}));y(B)}else y([])}catch(d){V.error("Error fetching table data:",d),te.error("Failed to fetch records"),h([]),l([]),y([])}finally{M(!1)}},[a.schemaName,a.tableName,r,n]);return u.useEffect(()=>{D()},[D]),{records:i,setRecords:l,originalRecords:f,columns:b,setColumns:y,metaData:o,loading:A,fetchData:D,refreshData:D}},it="https://click.wa.expert/api",ot={async fetch(a,r){var n;try{const i=`${a}_${r}`,l=await xe.post(`${it}/data/getRecordById`,{id:i,schemaName:"public",tableName:"column_preferences"});let f=l.data.column_visibility;if(typeof f=="string")try{f=JSON.parse(f)}catch{return null}return{...l.data,column_visibility:f}}catch(i){return((n=i.response)==null?void 0:n.status)===404,null}},async save(a,r,n,i){var f;try{const h=`${a}_${r}`,b=JSON.stringify(n),y=`${it}/data/createRecord`,o={schemaName:"public",tableName:"column_preferences",record:{us_id:h,owner_id:a,table_name:r,schema_name:i,column_visibility:b,updated_at:new Date().toISOString()}};return{success:!0,data:(await xe.post(y,o)).data}}catch(h){return{success:!1,error:((f=h.response)==null?void 0:f.data)||h.message}}}},Cs=(a,r,n,i)=>{const[l,f]=u.useState(i),[h,b]=u.useState(!1),y=u.useCallback(async()=>{try{const d=await ot.fetch(a,r);return d&&d.column_visibility?(V.debug("Loaded column preferences:",d.column_visibility),d.column_visibility):null}catch(d){return V.error("Error loading column preferences:",d),null}},[a,r]),o=u.useCallback((d,p)=>p?d.map(w=>{const B=p[w.id]!==void 0?p[w.id]:!0;return{...w,visible:B}}):d,[]),C=u.useCallback(async d=>{try{const p={};d.forEach(B=>{p[B.id]=B.visible}),(await ot.save(a,r,p,n)).success&&(V.debug("Column preferences saved successfully"),te.success("Column preferences saved"))}catch(p){V.error("Error saving column preferences:",p),te.error("Failed to save column preferences")}},[a,r,n]),A=u.useCallback(async d=>{const p=l.map(w=>w.id===d?{...w,visible:!w.visible}:w);f(p),await C(p)},[l,C]),M=u.useCallback(async()=>{const d=l.map(p=>({...p,visible:!0}));f(d),await C(d),te.success("Column visibility reset to default")},[l,C]),D=u.useCallback(async()=>{const d=l.map(p=>({...p,visible:!1}));f(d),await C(d),te.success("All columns hidden")},[l,C]);return u.useEffect(()=>{(async()=>{if(!h&&i.length>0){const p=await y(),w=o(i,p);f(w),b(!0)}})()},[i,h,y,o]),u.useEffect(()=>{i.length>0&&!h&&f(i)},[i,h]),{columns:l,setColumns:f,toggleColumnVisibility:A,resetColumnVisibility:M,hideAllColumns:D,visibleColumns:l.filter(d=>d.visible)}},js=a=>{const[r,n]=u.useState(""),[i,l]=u.useState([]),[f,h]=u.useState([]),b=u.useMemo(()=>{if(!a.length)return[];let d=[...a];if(r.trim()!==""){const p=r.toLowerCase();d=d.filter(w=>Object.values(w).some(B=>String(B).toLowerCase().includes(p)))}return i.length>0&&(d=d.filter(p=>i.includes(p.status))),f.length>0&&(d=d.filter(p=>f.includes(p.priority))),V.debug("Filtered records:",{original:a.length,filtered:d.length,searchTerm:r,statusFilter:i,priorityFilter:f}),d},[a,r,i,f]),y=u.useMemo(()=>Array.from(new Set(a.map(d=>d.status))).filter(Boolean),[a]),o=u.useMemo(()=>Array.from(new Set(a.map(d=>d.priority))).filter(Boolean),[a]),C=u.useCallback(d=>{l(p=>p.includes(d)?p.filter(w=>w!==d):[...p,d])},[]),A=u.useCallback(d=>{h(p=>p.includes(d)?p.filter(w=>w!==d):[...p,d])},[]),M=u.useCallback(()=>{n(""),l([]),h([])},[]),D=u.useMemo(()=>r!==""||i.length>0||f.length>0,[r,i,f]);return{searchTerm:r,setSearchTerm:n,statusFilter:i,setStatusFilter:l,priorityFilter:f,setPriorityFilter:h,filteredRecords:b,uniqueStatuses:y,uniquePriorities:o,toggleStatusFilter:C,togglePriorityFilter:A,clearFilters:M,hasActiveFilters:D}},vs=(a,r=us.DEFAULT_PAGE_SIZE)=>{const[n,i]=u.useState(1),[l,f]=u.useState(r),h=a.length,b=Math.ceil(h/l),y=u.useMemo(()=>{const d=n*l,p=d-l;return a.slice(p,d)},[a,n,l]),o=u.useCallback(d=>{const p=Math.max(1,Math.min(d,b));i(p)},[b]),C=u.useCallback(()=>{n<b&&i(d=>d+1)},[n,b]),A=u.useCallback(()=>{n>1&&i(d=>d-1)},[n]),M=u.useCallback(d=>{f(d),i(1)},[]),D=u.useCallback(()=>{i(1),f(r)},[r]);return{currentPage:n,pageSize:l,totalRecords:h,totalPages:b,currentRecords:y,setCurrentPage:o,nextPage:C,previousPage:A,changePageSize:M,resetPagination:D}},Ns=(a,r,n)=>{const[i,l]=u.useState({}),[f,h]=u.useState(!1),[b,y]=u.useState(!1),o=u.useCallback((p={})=>{l(p)},[]),C=u.useCallback((p,w)=>{l(B=>({...B,[p]:w}))},[]),A=u.useCallback(()=>{l({})},[]),M=u.useCallback(async(p={})=>{try{h(!0);const w={...i,...p};V.debug("Submitting form data:",w);const B=ys(w,hs,fs),j=_s(B,["status","type"]);V.debug("Cleaned record data:",j);let q;return r==="payment"?q=await Ee.createPaymentReminder(j):q=await Ee.createRecord(a,j),te.success("Record created successfully!"),n&&n(q.data),A(),y(!1),q}catch(w){throw V.error("Error submitting form:",w),w.response?te.error(`Failed to create record: ${w.response.data.error||w.response.data.message||"Unknown error"}`):te.error(`Failed to create record: ${w.message}`),w}finally{h(!1)}},[i,a,r,n,A]),D=u.useCallback((p={})=>{o(p),y(!0)},[o]),d=u.useCallback(()=>{y(!1),A()},[A]);return{formData:i,isSubmitting:f,isOpen:b,initializeForm:o,handleFieldChange:C,resetForm:A,submitForm:M,openForm:D,closeForm:d}},ks=(a,r)=>{const[n,i]=u.useState({}),[l,f]=u.useState({}),[h,b]=u.useState(!1),[y,o]=u.useState(!0),C=u.useCallback(async()=>{try{o(!0);const d=await Ee.fetchDropdownSetup(a,r);d.exists?(i(d.mapping),f(d.columnOrder),b(!0),V.debug("Dropdown setup loaded:",{mapping:d.mapping,columnOrder:d.columnOrder})):(i({}),f({}),b(!1))}catch(d){V.error("Error fetching dropdown setup:",d),i({}),f({}),b(!1)}finally{o(!1)}},[a,r]),A=u.useCallback(d=>n[d]||[],[n]),M=u.useCallback(d=>{const p=n[d];return Array.isArray(p)&&p.length>0},[n]),D=u.useCallback(d=>l[d]||999,[l]);return u.useEffect(()=>{a&&r&&C()},[a,r,C]),{dropdownSetup:n,columnOrder:l,setupExists:h,loading:y,fetchSetup:C,getDropdownOptions:A,hasDropdown:M,getColumnOrder:D}},Ss=({tableName:a="jobstatus",onCounterUpdate:r})=>{const[n,i]=u.useState(0),[l,f]=u.useState(""),[h,b]=u.useState(!1),[y,o]=u.useState(!1),[C,A]=u.useState(!1),[M,D]=u.useState(null),d=ht(j=>j.user),p=d.owner_id===null?d.id:d.owner_id,w=async()=>{try{A(!0);const j="https://click.wa.expert/api/data/getRecordById",Y={id:`${p}_${a}`,schemaName:"public",tableName:"counter_setup"},{data:U}=await xe.post(j,Y);if(U){const g=parseInt(U.counter,10)||0;i(g),f(U.prefix||""),b(U.is_active||!1),D(U.id),r&&r({counter:g,prefix:U.prefix||"",isActive:U.is_active||!1,recordId:U.id})}}catch{i(1),f(""),b(!1),D(null),await B()}finally{A(!1)}},B=async()=>{try{const j="https://click.wa.expert/api/data/createRecord",Y={schemaName:"public",tableName:"counter_setup",record:{us_id:`${p}_${a}`,owner_id:p,table_name:a,prefix:"",counter:1,is_active:!1}},{data:U}=await xe.post(j,Y);await w()}catch{}},ne=async()=>{try{o(!0);const j=parseInt(n,10),q="https://click.wa.expert/api/data/createRecord",Y=`${p}_${a}`,U={schemaName:"public",tableName:"counter_setup",record:{us_id:Y,owner_id:p,table_name:a,prefix:l,counter:j,is_active:h,updated_at:new Date().toISOString()}};await xe.post(q,U),te.success("Counter settings saved successfully"),r&&r({counter:j,prefix:l,isActive:h,recordId:M||Y}),await w()}catch{te.error("Failed to save counter settings")}finally{o(!1)}};return u.useEffect(()=>{w()},[a]),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(zt,{id:"counter-active",checked:h,onCheckedChange:b}),e.jsx(Be,{htmlFor:"counter-active",className:"text-sm font-medium whitespace-nowrap",children:"Auto Counter"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[120px]",children:[e.jsx(Be,{htmlFor:"prefix",className:"text-sm whitespace-nowrap",children:"Prefix:"}),e.jsx(je,{id:"prefix",type:"text",value:l,onChange:j=>f(j.target.value),placeholder:"INV",className:"h-9"})]}),h&&e.jsxs("div",{className:"text-sm bg-blue-50 px-2 py-1.5 rounded border border-blue-200 flex w-[10rem] items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Next : "}),e.jsxs("span",{className:"font-mono font-semibold text-blue-700",children:[l,n]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx(Q,{onClick:ne,disabled:y,size:"sm",variant:"default",children:e.jsx(Bt,{className:"h-3.5 w-3.5"})}),e.jsx(Q,{onClick:w,disabled:C,variant:"outline",size:"sm",children:e.jsx(gt,{className:`h-3.5 w-3.5 ${C?"animate-spin":""}`})})]})]})})})},Es=({title:a="All Records",description:r="View and manage all database records",searchTerm:n="",onSearchChange:i,tableName:l,onCounterUpdate:f,urlParams:h={},dropdownSetupExists:b=!1,columnOrderExists:y=!1})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{className:"w-[95%]",children:[e.jsxs("div",{className:"flex md:flex-row md:items-center justify-between w-full",children:[e.jsx(dt,{className:"text-2xl font-semibold text-slate-700",children:a}),e.jsx("div",{className:"lg:flex-1 lg:max-w-[500px]",children:e.jsx(Ss,{tableName:l,onCounterUpdate:f})})]}),e.jsxs(At,{className:"mt-1",children:[r,h.pa_id&&e.jsx("div",{className:"flex gap-2 mt-1",children:e.jsxs(ue,{variant:"outline",className:"text-xs bg-green-50 border-green-200",children:["PA ID: ",h.pa_id]})}),h.process_name&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(ue,{variant:"outline",className:"text-xs bg-purple-50 border-purple-200",children:["Process: ",h.process_name]}),e.jsxs(ue,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[h.process_name,"_balance"]})]}),b&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(ue,{variant:"outline",className:"text-xs",children:"Dropdown Configured"}),y&&e.jsxs(ue,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-3 w-3 mr-1"}),"Custom Order"]})]})]})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-end gap-3",children:e.jsxs("div",{className:"relative lg:w-[300px]",children:[e.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(je,{type:"text",placeholder:"Search records...",value:n,onChange:i,className:"pl-9"})]})})]}),Rs=({onRefresh:a,onAddRecord:r,onExportCSV:n,onToggleEdit:i,editEnabled:l=!1,canEdit:f=!0,isLoading:h=!1})=>e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(Q,{className:"flex items-center gap-2",onClick:r,disabled:h,children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Record"})]}),e.jsxs(Q,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:a,disabled:h,children:[e.jsx(gt,{className:`h-4 w-4 ${h?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),e.jsxs(Q,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:n,disabled:h,children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]}),f&&e.jsxs(Q,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:i,disabled:h,children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:l?"Editing":"Edit"}),l&&e.jsx(ue,{className:"ml-1 bg-blue-500",children:"ON"})]})]}),Ds=({uniqueStatuses:a=[],uniquePriorities:r=[],statusFilter:n=[],priorityFilter:i=[],onToggleStatus:l,onTogglePriority:f,onClearStatusFilter:h,onClearPriorityFilter:b})=>{const y=n.length+i.length;return e.jsxs(ft,{children:[e.jsx(pt,{asChild:!0,children:e.jsxs(Q,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Filters"}),y>0&&e.jsx(ue,{className:"ml-1 py-0 px-1.5 h-5 min-w-5 bg-blue-500 text-white rounded-full",children:y})]})}),e.jsxs(mt,{align:"start",className:"w-56",children:[e.jsxs(We,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Status"}),n.length>0&&e.jsx(Q,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:h,children:"Clear"})]}),a.length>0?a.map(o=>e.jsxs(Je,{checked:n.includes(o),onCheckedChange:()=>l(o),children:[e.jsx(ue,{className:`font-medium mr-2 ${qe(o,Nt)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(Ge,{disabled:!0,children:"No statuses available"}),e.jsx(xt,{}),e.jsxs(We,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Priority"}),i.length>0&&e.jsx(Q,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:b,children:"Clear"})]}),r.length>0?r.map(o=>e.jsxs(Je,{checked:i.includes(o),onCheckedChange:()=>f(o),children:[e.jsx(ue,{className:`font-medium mr-2 ${qe(o,kt)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(Ge,{disabled:!0,children:"No priorities available"})]})]})},Os=({columns:a=[],onToggleColumn:r,onResetVisibility:n,onHideAll:i})=>e.jsxs(ft,{children:[e.jsx(pt,{asChild:!0,children:e.jsxs(Q,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Columns"})]})}),e.jsxs(mt,{align:"start",className:"w-56",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[e.jsx(We,{className:"p-0",children:"Toggle Columns"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Q,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:l=>{l.stopPropagation(),i()},children:"Hide All"}),e.jsx(Q,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:l=>{l.stopPropagation(),n()},children:"Reset"})]})]}),e.jsx(xt,{}),a.map(l=>e.jsx(Ge,{onSelect:f=>{f.preventDefault(),r(l.id)},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(bt,{checked:l.visible,onCheckedChange:()=>r(l.id)}),e.jsx("span",{className:"flex-1",children:l.name}),!l.visible&&e.jsx(ue,{variant:"secondary",className:"text-xs",children:"Hidden"})]})},l.id))]})]}),Is=({records:a=[],columns:r=[],loading:n=!1,editEnabled:i=!1,canDelete:l=!1,onSort:f,onDeleteRecord:h,onEditRecord:b,onSaveRecord:y,sortColumn:o=null,sortDirection:C="asc",emptyMessage:A="No records found",onClearFilters:M})=>{const[D,d]=u.useState(null),[p,w]=u.useState({}),B=u.useCallback(g=>{i&&(d(g.id),w(g),b&&b(g))},[i,b]),ne=u.useCallback(()=>{y&&y(D,p),d(null),w({})},[D,p,y]),j=u.useCallback(()=>{d(null),w({})},[]),q=u.useCallback((g,t)=>{w(s=>({...s,[g]:t}))},[]),Y=(g,t)=>{const s=g[t.id];return D===g.id&&t.id!=="id"&&i?e.jsx(je,{type:"text",value:p[t.id]||"",onChange:c=>q(t.id,c.target.value),className:"border rounded px-2 py-1 w-full",onClick:c=>c.stopPropagation()}):t.id==="status"?e.jsx(ue,{className:`font-medium ${qe(s,Nt)}`,children:s}):t.id==="priority"?e.jsx(ue,{className:`font-medium ${qe(s,kt)}`,children:s}):t.id==="task_file"&&s?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ts,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:s})]}):e.jsx("span",{children:s||"â€”"})},U=r.filter(g=>g.visible);return e.jsxs("div",{className:"rounded-md border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Gt,{children:[e.jsx(Kt,{children:e.jsxs($e,{className:"bg-slate-50",children:[l&&e.jsx(rt,{className:"w-[60px] text-center",children:"Delete"}),U.map(g=>e.jsx(rt,{className:`${g.sortable?"cursor-pointer hover:bg-slate-100":""}`,onClick:()=>g.sortable&&f&&f(g.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:g.name}),o===g.id&&e.jsx(Lt,{className:`h-4 w-4 transition-transform ${C==="desc"?"rotate-180":""}`})]})},g.id))]})}),e.jsx(Xt,{children:n?e.jsx($e,{children:e.jsx(Ue,{colSpan:U.length+(l?1:0),className:"h-24 text-center",children:"Loading records..."})}):a.length===0?e.jsx($e,{children:e.jsxs(Ue,{colSpan:U.length+(l?1:0),className:"h-24 text-center",children:[A,M&&e.jsx(Q,{variant:"link",onClick:M,className:"ml-2",children:"Clear filters?"})]})}):a.map((g,t)=>e.jsxs($e,{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>B(g),children:[l&&e.jsx(Ue,{className:"w-[60px] text-center",children:e.jsx(Q,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:s=>{s.stopPropagation(),h&&h(g)},children:e.jsx(yt,{className:"h-4 w-4"})})}),U.map(s=>e.jsx(Ue,{children:Y(g,s)},s.id))]},g.id||t))})]})}),D&&i&&e.jsxs("div",{className:"flex gap-2 p-3 bg-slate-50 border-t",children:[e.jsx(Q,{size:"sm",onClick:ne,children:"Save Changes"}),e.jsx(Q,{size:"sm",variant:"ghost",onClick:j,children:"Cancel"})]})]})},Ts=({column:a,value:r,onChange:n,dropdownOptions:i=[],isAutoFilled:l=!1,disabled:f=!1})=>{const{id:h,type:b,name:y}=a;if(l)return e.jsx(je,{id:h,type:"text",value:r||"",disabled:!0,className:"bg-gray-50 cursor-not-allowed text-gray-600",placeholder:`Auto-filled ${y.toLowerCase()}`});if(i.length>0)return e.jsxs(Ze,{value:r||"",onValueChange:o=>n(h,o),disabled:f,children:[e.jsx(et,{children:e.jsx(tt,{placeholder:`Select ${y.toLowerCase()}`})}),e.jsx(st,{children:i.map((o,C)=>e.jsx(Pe,{value:o,children:o},C))})]});switch(b){case oe.TEXTAREA:return e.jsx(Qt,{id:h,value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,rows:3,disabled:f});case oe.SELECT_PRIORITY:return e.jsxs(Ze,{value:r||"",onValueChange:o=>n(h,o),disabled:f,children:[e.jsx(et,{children:e.jsx(tt,{placeholder:"Select priority"})}),e.jsxs(st,{children:[e.jsx(Pe,{value:Ie.LOW,children:"Low"}),e.jsx(Pe,{value:Ie.MEDIUM,children:"Medium"}),e.jsx(Pe,{value:Ie.HIGH,children:"High"})]})]});case oe.NUMBER:return e.jsx(je,{id:h,type:"number",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,disabled:f});case oe.EMAIL:return e.jsx(je,{id:h,type:"email",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,disabled:f});case oe.PHONE:return e.jsx(je,{id:h,type:"tel",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,disabled:f});case oe.DATE:return e.jsx(je,{id:h,type:"date",value:r||"",onChange:o=>n(h,o.target.value),disabled:f});case oe.URL:return e.jsx(je,{id:h,type:"url",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,disabled:f});case oe.CHECKBOX:return e.jsx(bt,{id:h,checked:r||!1,onCheckedChange:o=>n(h,o),disabled:f});default:return e.jsx(je,{id:h,type:"text",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${y.toLowerCase()}`,disabled:f})}},As=()=>e.jsx("div",{children:"SplitComponent"}),Fs=({isOpen:a,onClose:r,onSubmit:n,formData:i,onFieldChange:l,columns:f,metaData:h=[],dropdownSetup:b={},columnOrder:y={},processName:o=null,isSubmitting:C=!1,mode:A="create"})=>{const[M,D]=u.useState(!1),d=u.useMemo(()=>{const j=gs(f,o);return bs(j,y)},[f,o,y]),p=j=>{const q=h.find(Y=>Y.column_name===j);return(q==null?void 0:q.is_nullable)==="NO"},w=j=>j===at.PA_ID,B=j=>{const q=b[j];return Array.isArray(q)?q:[]},ne=j=>o&&(j.id.toLowerCase().includes("quantity")||j.name.toLowerCase().includes("quantity"));return e.jsx(_t,{open:a,onOpenChange:r,children:e.jsxs(wt,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",onInteractOutside:j=>j.preventDefault(),children:[e.jsxs(Ct,{children:[e.jsx(jt,{children:A==="create"?"Add New Record":"Edit Record"}),e.jsxs(vt,{children:[A==="create"?"Fill in the details to create a new record in the database.":"Update the record details.",o&&e.jsxs("span",{className:"block mt-1 text-blue-600",children:["Note: The ",o,"_balance field will be automatically set to match the quantity value."]})]})]}),M?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-4",children:e.jsx(As,{})}),e.jsxs(Ke,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(Q,{onClick:()=>D(!1),variant:"outline",className:"w-full sm:w-auto",children:"Back to Form"}),e.jsx(Q,{onClick:n,disabled:C,className:"w-full sm:w-auto",children:C?"Submitting...":"Submit All"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-6 py-4",children:d.map(j=>{const q=y[j.id];B(j.id).length>0;const Y=w(j.id),U=p(j.id),g=ne(j);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs(Be,{htmlFor:j.id,className:"font-medium text-sm sm:w-48 sm:text-right sm:flex-shrink-0 flex items-center gap-1 justify-start sm:justify-end",children:[q&&e.jsx(ue,{variant:"secondary",className:"text-xs h-4 px-1 mr-1",children:q}),e.jsx("span",{className:"flex-1 sm:flex-initial",children:j.name}),U&&e.jsx(ue,{variant:"default",className:"text-xs h-4 px-1 text-red-100",children:"*"}),Y&&e.jsx(ue,{variant:"default",className:"text-xs h-4 px-1 bg-green-500 ml-1",children:"auto"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ts,{column:j,value:i[j.id],onChange:l,dropdownOptions:B(j.id),isAutoFilled:Y,disabled:C}),Y&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.id===at.PA_ID?"Automatically filled from URL parameter":"Automatically generated unique identifier"}),g&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["This value will be used to set ",o,"_balance"]})]})]},j.id)})}),e.jsxs(Ke,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(Q,{onClick:n,disabled:C,className:"w-full sm:w-auto order-1 sm:order-2",children:C?A==="create"?"Creating...":"Updating...":A==="create"?"Create Record":"Update Record"}),e.jsx(Q,{onClick:()=>{D(!0)},disabled:C,className:"w-full sm:w-auto order-1 sm:order-2",children:"Add Details"})]})]})]})})},Ls=({isOpen:a,onClose:r,onConfirm:n,record:i,confirmInput:l,onConfirmInputChange:f,isDeleting:h=!1})=>{const b=l.trim()===(i==null?void 0:i.us_id);return e.jsx(_t,{open:a,onOpenChange:r,children:e.jsxs(wt,{className:"max-w-md",children:[e.jsxs(Ct,{children:[e.jsxs(jt,{className:"flex items-center gap-2",children:[e.jsx(yt,{className:"h-5 w-5 text-red-500"}),"Confirm Deletion"]}),e.jsxs(vt,{children:["This action cannot be undone. Please type the ",e.jsx("strong",{children:"us_id"})," to confirm deletion."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[i&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[e.jsx("p",{className:"text-sm font-medium",children:"Record to delete:"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",i.id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["US_ID: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:i.us_id})]})]}),e.jsxs("div",{children:[e.jsx(Be,{htmlFor:"confirm-us-id",className:"text-sm font-medium",children:"Enter us_id to confirm:"}),e.jsx(je,{id:"confirm-us-id",type:"text",placeholder:"Type us_id here",value:l,onChange:y=>f(y.target.value),className:"mt-1",autoFocus:!0,disabled:h})]})]}),e.jsxs(Ke,{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(Q,{variant:"outline",onClick:r,disabled:h,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(Q,{variant:"destructive",onClick:n,disabled:h||!b,className:"w-full sm:w-auto",children:h?"Deleting...":"Delete Record"})]})]})})};function Ms({className:a,...r}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:Fe("mx-auto flex w-full justify-center",a),...r})}function Ps({className:a,...r}){return e.jsx("ul",{"data-slot":"pagination-content",className:Fe("flex flex-row items-center gap-1",a),...r})}function Oe({...a}){return e.jsx("li",{"data-slot":"pagination-item",...a})}function Ae({className:a,isActive:r,size:n="icon",...i}){return e.jsx("a",{"aria-current":r?"page":void 0,"data-slot":"pagination-link","data-active":r,className:Fe(Mt({variant:r?"outline":"ghost",size:n}),a),...i})}function $s({className:a,...r}){return e.jsxs(Ae,{"aria-label":"Go to previous page",size:"default",className:Fe("gap-1 px-2.5 sm:pl-2.5",a),...r,children:[e.jsx(Yt,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function Us({className:a,...r}){return e.jsxs(Ae,{"aria-label":"Go to next page",size:"default",className:Fe("gap-1 px-2.5 sm:pr-2.5",a),...r,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(Pt,{})]})}function zs(a=640){const[r,n]=u.useState(typeof window<"u"?window.innerWidth<a:!1);return u.useEffect(()=>{function i(){n(window.innerWidth<a)}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[a]),r}function Bs({currentPage:a,setCurrentPage:r,totalPages:n,records:i=[],pageSize:l=10,totalRecords:f=0}){const b=zs(640)?3:7,y=u.useMemo(()=>{if(n<=b)return[...Array(n)].map((D,d)=>d+1);const o=Math.floor(b/2);let C=Math.max(1,a-o),A=Math.min(n,a+o);a<=o?(C=1,A=b):a+o>=n&&(C=n-b+1,A=n);const M=[];for(let D=C;D<=A;D++)M.push(D);return M},[n,a,b]);return e.jsxs("div",{className:"flex items-center justify-between mt-4 w-full px-4",children:[e.jsxs("div",{className:"hidden sm:block text-sm text-slate-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min(i.length,l)})," of"," ",e.jsx("span",{className:"font-medium",children:f})," records"]}),e.jsx("div",{className:"flex-1 flex justify-center sm:justify-end",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto sm:overflow-visible py-1",children:e.jsx(Ms,{children:e.jsxs(Ps,{children:[e.jsx(Oe,{children:e.jsx($s,{href:"#",onClick:o=>{o.preventDefault(),a>1&&r(a-1)},className:a<=1?"pointer-events-none opacity-50":""})}),y[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:o=>{o.preventDefault(),r(1)},isActive:a===1,children:"1"})}),e.jsx(Oe,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})})]}),y.map(o=>e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:C=>{C.preventDefault(),r(o)},isActive:a===o,children:o})},o)),y[y.length-1]<n&&e.jsxs(e.Fragment,{children:[e.jsx(Oe,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})}),e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:o=>{o.preventDefault(),r(n)},isActive:a===n,children:n})})]}),e.jsx(Oe,{children:e.jsx(Us,{href:"#",onClick:o=>{o.preventDefault(),a<n&&r(a+1)},className:a>=n?"pointer-events-none opacity-50":""})})]})})})})]})}const qs=({type:a="normal"})=>{const[r,n]=$t(),i=ht(F=>F.user),l=u.useMemo(()=>({pa_id:r.get("pa_id"),us_id:r.get("us_id"),show:r.get("show"),status:r.get("status"),process_name:r.get("process_name")}),[r]),{tableName1:f}=Ut(),h=u.useMemo(()=>({schemaName:i.schema_name,tableName:f,userId:i.id,userEmail:i.email}),[i.schema_name,f,i.id,i.email]),b=(i==null?void 0:i.owner_id)??(i==null?void 0:i.id),[y,o]=u.useState(!1),[C,A]=u.useState(null),[M,D]=u.useState("asc"),[d,p]=u.useState({counter:0,prefix:"",isActive:!1,recordId:null}),[w,B]=u.useState(!1),[ne,j]=u.useState(null),[q,Y]=u.useState(""),[U,g]=u.useState(!1),{setRecords:t,originalRecords:s,columns:c,metaData:x,loading:m,refreshData:k}=ws(h,a,b),{columns:$,setColumns:he,toggleColumnVisibility:fe,resetColumnVisibility:O,hideAllColumns:K,visibleColumns:v}=Cs(b,h.tableName,h.schemaName,c),{searchTerm:le,setSearchTerm:S,statusFilter:T,priorityFilter:_,filteredRecords:H,uniqueStatuses:J,uniquePriorities:ae,toggleStatusFilter:de,togglePriorityFilter:I,clearFilters:L,hasActiveFilters:W}=js(s),{currentPage:N,totalPages:X,currentRecords:ee,setCurrentPage:z,resetPagination:P}=vs(H),{formData:R,isSubmitting:pe,isOpen:E,handleFieldChange:G,submitForm:we,openForm:Ne,closeForm:ge}=Ns(h,a,k),{dropdownSetup:Re,columnOrder:ie,setupExists:be}=ks(b,h.tableName);u.useEffect(()=>{c.length>0&&$.length===0&&he(c)},[c]),u.useEffect(()=>{const F=r.get("search");F&&S(decodeURIComponent(F))},[r,S]),u.useEffect(()=>{l.show==="true"&&$.length>0&&ke()},[l.show,$]);const se=u.useCallback(F=>{p(F)},[]),ce=u.useCallback(()=>{k(),L(),P(),te.success("Data refreshed")},[k,L,P]),Ce=u.useCallback(F=>{S(F.target.value),P()},[S,P]),Te=u.useCallback(F=>{C===F?D(_e=>_e==="asc"?"desc":"asc"):(A(F),D("asc"));const Z=[...H].sort((_e,me)=>{const re=_e[F]||"",ve=me[F]||"";return typeof re=="string"&&typeof ve=="string"?M==="asc"?re.localeCompare(ve):ve.localeCompare(re):M==="asc"?re-ve:ve-re});t(Z)},[C,M,H,t]),Le=u.useCallback(()=>{if(!H.length){te.error("No records to export");return}try{const F=H.map(Rt=>{const Xe={};return v.forEach(Qe=>{Xe[Qe.name]=Rt[Qe.id]}),Xe}),Z=ds.unparse(F,{quotes:!0,quoteChar:'"',delimiter:",",header:!0}),_e=new Blob([Z],{type:"text/csv;charset=utf-8;"}),me=URL.createObjectURL(_e),re=document.createElement("a"),ve=new Date().toISOString().slice(0,10),Et=`${h.tableName}_export_${ve}.csv`;re.setAttribute("href",me),re.setAttribute("download",Et),re.style.display="none",document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(me),te.success(`Exported ${F.length} records to CSV`)}catch(F){V.error("Error exporting CSV:",F),te.error("Failed to export CSV")}},[H,v,h.tableName]),ke=u.useCallback(async()=>{const F={};if($.forEach(Z=>{l[Z.id]?F[Z.id]=l[Z.id]:Z.id==="us_id"?F[Z.id]=d.isActive?`${d.prefix}${d.counter}`:xs():F[Z.id]=""}),Ne(F),l.show==="true"){const Z=new URLSearchParams(r);Z.delete("show"),n(Z,{replace:!0})}},[$,l,d,Ne,r,n]),ye=u.useCallback(async()=>{try{let F={};if(l.process_name){const Z=`${l.process_name}_balance`,_e=$.find(me=>me.id.toLowerCase().includes("quantity"));if(_e){const me=R[_e.id];me&&(F[Z]=me)}}if((l.status&&l.pa_id||l.process_name&&l.pa_id)&&(F.us_id=`${l.pa_id} -S- ${R.us_id}`),await we(F),d.isActive&&d.recordId)try{await Ee.updateRecord({schemaName:"public",tableName:"counter_setup"},d.recordId,b,{counter:d.counter+1}),p(Z=>({...Z,counter:Z.counter+1}))}catch(Z){V.error("Counter increment failed:",Z),te.warning("Record created but counter increment failed")}n({})}catch(F){V.error("Create record failed:",F)}},[R,$,l,d,we,b,n]),De=u.useCallback(F=>{j(F),Y(""),B(!0)},[]),Me=u.useCallback(async()=>{if(!ne||q.trim()!==ne.us_id){te.error("Entered us_id does not match");return}try{g(!0),await Ee.deleteRecord(h,ne.id),te.success("Record deleted successfully"),B(!1),j(null),Y(""),k()}catch(F){V.error("Delete failed:",F),te.error("Failed to delete record")}finally{g(!1)}},[ne,q,h,k]),St=u.useCallback(async(F,Z)=>{try{const _e=s.find(re=>re.id===F),me={};if(Object.entries(Z).forEach(([re,ve])=>{ve!==_e[re]&&re!=="id"&&re!=="pa_id"&&re!=="us_id"&&(me[re]=ve)}),Object.keys(me).length===0){te.warning("No changes to save");return}await Ee.updateRecord(h,F,b,me),te.success("Record updated successfully"),k()}catch(_e){V.error("Update failed:",_e),te.error("Failed to update record")}},[s,h,b,k]);return l.show==="true"?null:e.jsxs(lt,{className:"tableCard shadow-sm border-slate-200 mx-[6rem]",children:[e.jsx(ct,{className:"pb-3",children:e.jsx(Es,{title:"All Records",description:"View and manage all database records",searchTerm:le,onSearchChange:Ce,tableName:h.tableName,onCounterUpdate:se,urlParams:l,dropdownSetupExists:be,columnOrderExists:Object.keys(ie).length>0})}),e.jsxs(ut,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rs,{onRefresh:ce,onAddRecord:ke,onExportCSV:Le,onToggleEdit:()=>o(!y),editEnabled:y,canEdit:i.owner_id===null,isLoading:m}),e.jsx(Ds,{uniqueStatuses:J,uniquePriorities:ae,statusFilter:T,priorityFilter:_,onToggleStatus:de,onTogglePriority:I,onClearStatusFilter:()=>de([]),onClearPriorityFilter:()=>I([])}),e.jsx(Os,{columns:$,onToggleColumn:fe,onResetVisibility:O,onHideAll:K})]})}),e.jsx(Is,{records:ee,columns:$,loading:m,editEnabled:y,canDelete:i.owner_id===null,onSort:Te,onDeleteRecord:De,onSaveRecord:St,sortColumn:C,sortDirection:M,emptyMessage:W?"No records match filters":"No records found",onClearFilters:W?L:null}),e.jsx(Bs,{currentPage:N,setCurrentPage:z,totalPages:X})]}),e.jsx(Fs,{isOpen:E,onClose:ge,onSubmit:ye,formData:R,onFieldChange:G,columns:$,metaData:x,dropdownSetup:Re,columnOrder:ie,processName:l.process_name,isSubmitting:pe,mode:"create"}),e.jsx(Ls,{isOpen:w,onClose:()=>B(!1),onConfirm:Me,record:ne,confirmInput:q,onConfirmInputChange:Y,isDeleting:U})]})},or=a=>e.jsx(is,{children:e.jsx(qs,{...a})});export{or as default};
