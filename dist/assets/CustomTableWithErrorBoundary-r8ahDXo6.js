var Dt=Object.defineProperty;var Ot=(a,r,n)=>r in a?Dt(a,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[r]=n;var Qe=(a,r,n)=>Ot(a,typeof r!="symbol"?r+"":r,n);import{d as He,R as It,j as e,C as ot,f as lt,g as ct,i as dt,B as ee,$ as Tt,b as ge,r as u,a0 as J,a as ut,L as Be,I as je,h as At,k as ue,w as Ft,a8 as ht,a9 as ft,aa as pt,ab as We,ax as Ye,ac as Ge,ay as mt,aw as Lt,n as Ze,o as Je,p as et,q as tt,t as Pe,Z as Fe,_ as Mt,an as Pt,au as $t,aj as Ut}from"./index-C8rB76ST.js";import{S as zt}from"./switch-BacQyMwi.js";import{S as Bt}from"./save-CKmDg6x6.js";import{R as gt}from"./refresh-cw-Ce4bCbcs.js";import{A as qt}from"./CustomTable-Cf912nGD.js";import{P as Ht}from"./plus-BNqor8n-.js";import{S as Vt}from"./square-pen-CNvIA_LH.js";import{C as xt}from"./checkbox-CxGRb7L9.js";import{S as Wt}from"./sliders-horizontal-DKAlJ4op.js";import{T as Gt,a as Kt,b as $e,c as st,d as Xt,e as Ue}from"./table-CiOR24WC.js";import{T as bt}from"./trash-2-DsHYpN-s.js";import{D as yt,b as _t,c as wt,d as Ct,e as jt,f as vt}from"./dialog-Bk4oSzdj.js";import{T as Qt}from"./textarea-C0k4ZchO.js";import{C as Yt}from"./chevron-left-YwuXmPx-.js";import"./index-D0w04Fa-.js";import"./x-CD_kuMe-.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Jt=He("file-spreadsheet",Zt);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ts=He("file-text",es);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],rs=He("funnel",ss);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],as=He("triangle-alert",ns);class is extends It.Component{constructor(n){super(n);Qe(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,i){this.setState({error:n,errorInfo:i})}render(){return this.state.hasError?e.jsxs(ot,{className:"mx-[6rem] mt-8",children:[e.jsx(lt,{children:e.jsxs(ct,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(as,{className:"h-5 w-5"}),"Something went wrong"]})}),e.jsxs(dt,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"The table encountered an error. Please try refreshing the page."}),!1,e.jsx(ee,{onClick:this.handleReset,children:"Reload Page"})]})]}):this.props.children}}var ze={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var os=ze.exports,rt;function ls(){return rt||(rt=1,function(a,r){((n,i)=>{a.exports=i()})(os,function n(){var i=typeof self<"u"?self:typeof window<"u"?window:i!==void 0?i:{},l,f=!i.document&&!!i.postMessage,h=i.IS_PAPA_WORKER||!1,x={},b=0,o={};function C(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(s){var c=oe(s);c.chunkSize=parseInt(c.chunkSize),s.step||s.chunk||(c.chunkSize=null),this._handle=new p(c),(this._handle.streamer=this)._config=c}).call(this,t),this.parseChunk=function(s,c){var g=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<g){let E=this._config.newline;E||(m=this._config.quoteChar||'"',E=this._handle.guessLineEndings(s,m)),s=[...s.split(E).slice(g)].join(E)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&(m=this._config.beforeFirstChunk(s))!==void 0&&(s=m),this.isFirstChunk=!1,this._halted=!1;var g=this._partialLine+s,m=(this._partialLine="",this._handle.parse(g,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(s=m.meta.cursor,g=(this._finished||(this._partialLine=g.substring(s-this._baseIndex),this._baseIndex=s),m&&m.data&&(this._rowCount+=m.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),h)i.postMessage({results:m,workerId:o.WORKER_ID,finished:g});else if(w(this._config.chunk)&&!c){if(this._config.chunk(m,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=m=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(m.data),this._completeResults.errors=this._completeResults.errors.concat(m.errors),this._completeResults.meta=m.meta),this._completed||!g||!w(this._config.complete)||m&&m.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),g||m&&m.meta.paused||this._nextChunk(),m}this._halted=!0},this._sendError=function(s){w(this._config.error)?this._config.error(s):h&&this._config.error&&i.postMessage({workerId:o.WORKER_ID,error:s,finished:!1})}}function A(t){var s;(t=t||{}).chunkSize||(t.chunkSize=o.RemoteChunkSize),C.call(this,t),this._nextChunk=f?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(c){this._input=c,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),f||(s.onload=q(this._chunkLoaded,this),s.onerror=q(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!f),this._config.downloadRequestHeaders){var c,g=this._config.downloadRequestHeaders;for(c in g)s.setRequestHeader(c,g[c])}var m;this._config.chunkSize&&(m=this._start+this._config.chunkSize-1,s.setRequestHeader("Range","bytes="+this._start+"-"+m));try{s.send(this._config.downloadRequestBody)}catch(E){this._chunkError(E.message)}f&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize||s.responseText.length,this._finished=!this._config.chunkSize||this._start>=(c=>(c=c.getResponseHeader("Content-Range"))!==null?parseInt(c.substring(c.lastIndexOf("/")+1)):-1)(s),this.parseChunk(s.responseText)))},this._chunkError=function(c){c=s.statusText||c,this._sendError(new Error(c))}}function M(t){(t=t||{}).chunkSize||(t.chunkSize=o.LocalChunkSize),C.call(this,t);var s,c,g=typeof FileReader<"u";this.stream=function(m){this._input=m,c=m.slice||m.webkitSlice||m.mozSlice,g?((s=new FileReader).onload=q(this._chunkLoaded,this),s.onerror=q(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var m=this._input,E=(this._config.chunkSize&&(E=Math.min(this._start+this._config.chunkSize,this._input.size),m=c.call(m,this._start,E)),s.readAsText(m,this._config.encoding));g||this._chunkLoaded({target:{result:E}})},this._chunkLoaded=function(m){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(m.target.result)},this._chunkError=function(){this._sendError(s.error)}}function D(t){var s;C.call(this,t=t||{}),this.stream=function(c){return s=c,this._nextChunk()},this._nextChunk=function(){var c,g;if(!this._finished)return c=this._config.chunkSize,s=c?(g=s.substring(0,c),s.substring(c)):(g=s,""),this._finished=!s,this.parseChunk(g)}}function d(t){C.call(this,t=t||{});var s=[],c=!0,g=!1;this.pause=function(){C.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){C.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(m){this._input=m,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){g&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):c=!0},this._streamData=q(function(m){try{s.push(typeof m=="string"?m:m.toString(this._config.encoding)),c&&(c=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(E){this._streamError(E)}},this),this._streamError=q(function(m){this._streamCleanUp(),this._sendError(m)},this),this._streamEnd=q(function(){this._streamCleanUp(),g=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(t){var s,c,g,m,E=Math.pow(2,53),U=-E,he=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,fe=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,O=this,K=0,v=0,le=!1,S=!1,T=[],y={data:[],errors:[],meta:{}};function H(I){return t.skipEmptyLines==="greedy"?I.join("").trim()==="":I.length===1&&I[0].length===0}function Q(){if(y&&g&&(de("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),g=!1),t.skipEmptyLines&&(y.data=y.data.filter(function(N){return!H(N)})),ne()){let N=function(X,Z){w(t.transformHeader)&&(X=t.transformHeader(X,Z)),T.push(X)};if(y)if(Array.isArray(y.data[0])){for(var I=0;ne()&&I<y.data.length;I++)y.data[I].forEach(N);y.data.splice(0,1)}else y.data.forEach(N)}function L(N,X){for(var Z=t.header?{}:[],z=0;z<N.length;z++){var $=z,R=N[z],R=((pe,k)=>(G=>(t.dynamicTypingFunction&&t.dynamicTyping[G]===void 0&&(t.dynamicTyping[G]=t.dynamicTypingFunction(G)),(t.dynamicTyping[G]||t.dynamicTyping)===!0))(pe)?k==="true"||k==="TRUE"||k!=="false"&&k!=="FALSE"&&((G=>{if(he.test(G)&&(G=parseFloat(G),U<G&&G<E))return 1})(k)?parseFloat(k):fe.test(k)?new Date(k):k===""?null:k):k)($=t.header?z>=T.length?"__parsed_extra":T[z]:$,R=t.transform?t.transform(R,$):R);$==="__parsed_extra"?(Z[$]=Z[$]||[],Z[$].push(R)):Z[$]=R}return t.header&&(z>T.length?de("FieldMismatch","TooManyFields","Too many fields: expected "+T.length+" fields but parsed "+z,v+X):z<T.length&&de("FieldMismatch","TooFewFields","Too few fields: expected "+T.length+" fields but parsed "+z,v+X)),Z}var W;y&&(t.header||t.dynamicTyping||t.transform)&&(W=1,!y.data.length||Array.isArray(y.data[0])?(y.data=y.data.map(L),W=y.data.length):y.data=L(y.data,0),t.header&&y.meta&&(y.meta.fields=T),v+=W)}function ne(){return t.header&&T.length===0}function de(I,L,W,N){I={type:I,code:L,message:W},N!==void 0&&(I.row=N),y.errors.push(I)}w(t.step)&&(m=t.step,t.step=function(I){y=I,ne()?Q():(Q(),y.data.length!==0&&(K+=I.data.length,t.preview&&K>t.preview?c.abort():(y.data=y.data[0],m(y,O))))}),this.parse=function(I,L,W){var N=t.quoteChar||'"',N=(t.newline||(t.newline=this.guessLineEndings(I,N)),g=!1,t.delimiter?w(t.delimiter)&&(t.delimiter=t.delimiter(I),y.meta.delimiter=t.delimiter):((N=((X,Z,z,$,R)=>{var pe,k,G,we;R=R||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Ne=0;Ne<R.length;Ne++){for(var xe,Re=R[Ne],ae=0,be=0,te=0,ce=(G=void 0,new j({comments:$,delimiter:Re,newline:Z,preview:10}).parse(X)),Ce=0;Ce<ce.data.length;Ce++)z&&H(ce.data[Ce])?te++:(xe=ce.data[Ce].length,be+=xe,G===void 0?G=xe:0<xe&&(ae+=Math.abs(xe-G),G=xe));0<ce.data.length&&(be/=ce.data.length-te),(k===void 0||ae<=k)&&(we===void 0||we<be)&&1.99<be&&(k=ae,pe=Re,we=be)}return{successful:!!(t.delimiter=pe),bestDelimiter:pe}})(I,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=N.bestDelimiter:(g=!0,t.delimiter=o.DefaultDelimiter),y.meta.delimiter=t.delimiter),oe(t));return t.preview&&t.header&&N.preview++,s=I,c=new j(N),y=c.parse(s,L,W),Q(),le?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return le},this.pause=function(){le=!0,c.abort(),s=w(t.chunk)?"":s.substring(c.getCharIndex())},this.resume=function(){O.streamer._halted?(le=!1,O.streamer.parseChunk(s,!0)):setTimeout(O.resume,3)},this.aborted=function(){return S},this.abort=function(){S=!0,c.abort(),y.meta.aborted=!0,w(t.complete)&&t.complete(y),s=""},this.guessLineEndings=function(X,N){X=X.substring(0,1048576);var N=new RegExp(_(N)+"([^]*?)"+_(N),"gm"),W=(X=X.replace(N,"")).split("\r"),N=X.split(`
`),X=1<N.length&&N[0].length<W[0].length;if(W.length===1||X)return`
`;for(var Z=0,z=0;z<W.length;z++)W[z][0]===`
`&&Z++;return Z>=W.length/2?`\r
`:"\r"}}function _(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function j(t){var s=(t=t||{}).delimiter,c=t.newline,g=t.comments,m=t.step,E=t.preview,U=t.fastMode,he=null,fe=!1,O=t.quoteChar==null?'"':t.quoteChar,K=O;if(t.escapeChar!==void 0&&(K=t.escapeChar),(typeof s!="string"||-1<o.BAD_DELIMITERS.indexOf(s))&&(s=","),g===s)throw new Error("Comment character same as delimiter");g===!0?g="#":(typeof g!="string"||-1<o.BAD_DELIMITERS.indexOf(g))&&(g=!1),c!==`
`&&c!=="\r"&&c!==`\r
`&&(c=`
`);var v=0,le=!1;this.parse=function(S,T,y){if(typeof S!="string")throw new Error("Input must be a string");var H=S.length,Q=s.length,ne=c.length,de=g.length,I=w(m),L=[],W=[],N=[],X=v=0;if(!S)return ae();if(U||U!==!1&&S.indexOf(O)===-1){for(var Z=S.split(c),z=0;z<Z.length;z++){if(N=Z[z],v+=N.length,z!==Z.length-1)v+=c.length;else if(y)return ae();if(!g||N.substring(0,de)!==g){if(I){if(L=[],we(N.split(s)),be(),le)return ae()}else we(N.split(s));if(E&&E<=z)return L=L.slice(0,E),ae(!0)}}return ae()}for(var $=S.indexOf(s,v),R=S.indexOf(c,v),pe=new RegExp(_(K)+_(O),"g"),k=S.indexOf(O,v);;)if(S[v]===O)for(k=v,v++;;){if((k=S.indexOf(O,k+1))===-1)return y||W.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:L.length,index:v}),xe();if(k===H-1)return xe(S.substring(v,k).replace(pe,O));if(O===K&&S[k+1]===K)k++;else if(O===K||k===0||S[k-1]!==K){$!==-1&&$<k+1&&($=S.indexOf(s,k+1));var G=Ne((R=R!==-1&&R<k+1?S.indexOf(c,k+1):R)===-1?$:Math.min($,R));if(S.substr(k+1+G,Q)===s){N.push(S.substring(v,k).replace(pe,O)),S[v=k+1+G+Q]!==O&&(k=S.indexOf(O,v)),$=S.indexOf(s,v),R=S.indexOf(c,v);break}if(G=Ne(R),S.substring(k+1+G,k+1+G+ne)===c){if(N.push(S.substring(v,k).replace(pe,O)),Re(k+1+G+ne),$=S.indexOf(s,v),k=S.indexOf(O,v),I&&(be(),le))return ae();if(E&&L.length>=E)return ae(!0);break}W.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:L.length,index:v}),k++}}else if(g&&N.length===0&&S.substring(v,v+de)===g){if(R===-1)return ae();v=R+ne,R=S.indexOf(c,v),$=S.indexOf(s,v)}else if($!==-1&&($<R||R===-1))N.push(S.substring(v,$)),v=$+Q,$=S.indexOf(s,v);else{if(R===-1)break;if(N.push(S.substring(v,R)),Re(R+ne),I&&(be(),le))return ae();if(E&&L.length>=E)return ae(!0)}return xe();function we(te){L.push(te),X=v}function Ne(te){var ce=0;return ce=te!==-1&&(te=S.substring(k+1,te))&&te.trim()===""?te.length:ce}function xe(te){return y||(te===void 0&&(te=S.substring(v)),N.push(te),v=H,we(N),I&&be()),ae()}function Re(te){v=te,we(N),N=[],R=S.indexOf(c,v)}function ae(te){if(t.header&&!T&&L.length&&!fe){var ce=L[0],Ce={},Te=new Set(ce);let Le=!1;for(let Ee=0;Ee<ce.length;Ee++){let ye=ce[Ee];if(Ce[ye=w(t.transformHeader)?t.transformHeader(ye,Ee):ye]){let De,Me=Ce[ye];for(;De=ye+"_"+Me,Me++,Te.has(De););Te.add(De),ce[Ee]=De,Ce[ye]++,Le=!0,(he=he===null?{}:he)[De]=ye}else Ce[ye]=1,ce[Ee]=ye;Te.add(ye)}fe=!0}return{data:L,errors:W,meta:{delimiter:s,linebreak:c,aborted:le,truncated:!!te,cursor:X+(T||0),renamedHeaders:he}}}function be(){m(ae()),L=[],W=[]}},this.abort=function(){le=!0},this.getCharIndex=function(){return v}}function B(t){var s=t.data,c=x[s.workerId],g=!1;if(s.error)c.userError(s.error,s.file);else if(s.results&&s.results.data){var m={abort:function(){g=!0,P(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:re,resume:re};if(w(c.userStep)){for(var E=0;E<s.results.data.length&&(c.userStep({data:s.results.data[E],errors:s.results.errors,meta:s.results.meta},m),!g);E++);delete s.results}else w(c.userChunk)&&(c.userChunk(s.results,m,s.file),delete s.results)}s.finished&&!g&&P(s.workerId,s.results)}function P(t,s){var c=x[t];w(c.userComplete)&&c.userComplete(s),c.terminate(),delete x[t]}function re(){throw new Error("Not implemented.")}function oe(t){if(typeof t!="object"||t===null)return t;var s,c=Array.isArray(t)?[]:{};for(s in t)c[s]=oe(t[s]);return c}function q(t,s){return function(){t.apply(s,arguments)}}function w(t){return typeof t=="function"}return o.parse=function(t,s){var c=(s=s||{}).dynamicTyping||!1;if(w(c)&&(s.dynamicTypingFunction=c,c={}),s.dynamicTyping=c,s.transform=!!w(s.transform)&&s.transform,!s.worker||!o.WORKERS_SUPPORTED)return c=null,o.NODE_STREAM_INPUT,typeof t=="string"?(t=(g=>g.charCodeAt(0)!==65279?g:g.slice(1))(t),c=new(s.download?A:D)(s)):t.readable===!0&&w(t.read)&&w(t.on)?c=new d(s):(i.File&&t instanceof File||t instanceof Object)&&(c=new M(s)),c.stream(t);(c=(()=>{var g;return!!o.WORKERS_SUPPORTED&&(g=(()=>{var m=i.URL||i.webkitURL||null,E=n.toString();return o.BLOB_URL||(o.BLOB_URL=m.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",E,")();"],{type:"text/javascript"})))})(),(g=new i.Worker(g)).onmessage=B,g.id=b++,x[g.id]=g)})()).userStep=s.step,c.userChunk=s.chunk,c.userComplete=s.complete,c.userError=s.error,s.step=w(s.step),s.chunk=w(s.chunk),s.complete=w(s.complete),s.error=w(s.error),delete s.worker,c.postMessage({input:t,config:s,workerId:c.id})},o.unparse=function(t,s){var c=!1,g=!0,m=",",E=`\r
`,U='"',he=U+U,fe=!1,O=null,K=!1,v=((()=>{if(typeof s=="object"){if(typeof s.delimiter!="string"||o.BAD_DELIMITERS.filter(function(T){return s.delimiter.indexOf(T)!==-1}).length||(m=s.delimiter),typeof s.quotes!="boolean"&&typeof s.quotes!="function"&&!Array.isArray(s.quotes)||(c=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(fe=s.skipEmptyLines),typeof s.newline=="string"&&(E=s.newline),typeof s.quoteChar=="string"&&(U=s.quoteChar),typeof s.header=="boolean"&&(g=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");O=s.columns}s.escapeChar!==void 0&&(he=s.escapeChar+U),s.escapeFormulae instanceof RegExp?K=s.escapeFormulae:typeof s.escapeFormulae=="boolean"&&s.escapeFormulae&&(K=/^[=+\-@\t\r].*$/)}})(),new RegExp(_(U),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return le(null,t,fe);if(typeof t[0]=="object")return le(O||Object.keys(t[0]),t,fe)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||O),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),le(t.fields||[],t.data||[],fe);throw new Error("Unable to serialize unrecognized input");function le(T,y,H){var Q="",ne=(typeof T=="string"&&(T=JSON.parse(T)),typeof y=="string"&&(y=JSON.parse(y)),Array.isArray(T)&&0<T.length),de=!Array.isArray(y[0]);if(ne&&g){for(var I=0;I<T.length;I++)0<I&&(Q+=m),Q+=S(T[I],I);0<y.length&&(Q+=E)}for(var L=0;L<y.length;L++){var W=(ne?T:y[L]).length,N=!1,X=ne?Object.keys(y[L]).length===0:y[L].length===0;if(H&&!ne&&(N=H==="greedy"?y[L].join("").trim()==="":y[L].length===1&&y[L][0].length===0),H==="greedy"&&ne){for(var Z=[],z=0;z<W;z++){var $=de?T[z]:z;Z.push(y[L][$])}N=Z.join("").trim()===""}if(!N){for(var R=0;R<W;R++){0<R&&!X&&(Q+=m);var pe=ne&&de?T[R]:R;Q+=S(y[L][pe],R)}L<y.length-1&&(!H||0<W&&!X)&&(Q+=E)}}return Q}function S(T,y){var H,Q;return T==null?"":T.constructor===Date?JSON.stringify(T).slice(1,25):(Q=!1,K&&typeof T=="string"&&K.test(T)&&(T="'"+T,Q=!0),H=T.toString().replace(v,he),(Q=Q||c===!0||typeof c=="function"&&c(T,y)||Array.isArray(c)&&c[y]||((ne,de)=>{for(var I=0;I<de.length;I++)if(-1<ne.indexOf(de[I]))return!0;return!1})(H,o.BAD_DELIMITERS)||-1<H.indexOf(m)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?U+H+U:H)}},o.RECORD_SEP="",o.UNIT_SEP="",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!f&&!!i.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=j,o.ParserHandle=p,o.NetworkStreamer=A,o.FileStreamer=M,o.StringStreamer=D,o.ReadableStreamStreamer=d,i.jQuery&&((l=i.jQuery).fn.parse=function(t){var s=t.config||{},c=[];return this.each(function(E){if(!(l(this).prop("tagName").toUpperCase()==="INPUT"&&l(this).attr("type").toLowerCase()==="file"&&i.FileReader)||!this.files||this.files.length===0)return!0;for(var U=0;U<this.files.length;U++)c.push({file:this.files[U],inputElem:this,instanceConfig:l.extend({},s)})}),g(),this;function g(){if(c.length===0)w(t.complete)&&t.complete();else{var E,U,he,fe,O=c[0];if(w(t.before)){var K=t.before(O.file,O.inputElem);if(typeof K=="object"){if(K.action==="abort")return E="AbortError",U=O.file,he=O.inputElem,fe=K.reason,void(w(t.error)&&t.error({name:E},U,he,fe));if(K.action==="skip")return void m();typeof K.config=="object"&&(O.instanceConfig=l.extend(O.instanceConfig,K.config))}else if(K==="skip")return void m()}var v=O.instanceConfig.complete;O.instanceConfig.complete=function(le){w(v)&&v(le,O.file,O.inputElem),m()},o.parse(O.file,O.instanceConfig)}}function m(){c.splice(0,1),g()}}),h&&(i.onmessage=function(t){t=t.data,o.WORKER_ID===void 0&&t&&(o.WORKER_ID=t.workerId),typeof t.input=="string"?i.postMessage({workerId:o.WORKER_ID,results:o.parse(t.input,t.config),finished:!0}):(i.File&&t.input instanceof File||t.input instanceof Object)&&(t=o.parse(t.input,t.config))&&i.postMessage({workerId:o.WORKER_ID,results:t,finished:!0})}),(A.prototype=Object.create(C.prototype)).constructor=A,(M.prototype=Object.create(C.prototype)).constructor=M,(D.prototype=Object.create(D.prototype)).constructor=D,(d.prototype=Object.create(C.prototype)).constructor=d,o})}(ze)),ze.exports}var cs=ls();const ds=Tt(cs),V={debug:(...a)=>{},info:(...a)=>{},warn:(...a)=>{},error:(...a)=>{},group:(a,r)=>{}},Se="https://click.wa.expert/api",ke={fetchRecords:async a=>{try{V.debug("Fetching records with params:",a);const r=await ge.post(`${Se}/data/getAllData`,a);return{data:r.data.data||[],columns:r.data.columns||[],success:!0}}catch(r){throw V.error("Error fetching records:",r),r}},fetchPaymentRecords:async a=>{try{const r=await ge.get(`${Se}/payment-reminders/list?owner_id=${a}`);return{data:r.data.data||r.data||[],success:!0}}catch(r){throw V.error("Error fetching payment records:",r),r}},fetchRecordById:async(a,r)=>{try{const n=decodeURIComponent(r);return{data:(await ge.post(`${Se}/data/getRecordById`,{schemaName:a.schemaName,tableName:a.tableName,id:n})).data,success:!0}}catch(n){return V.error("Error fetching record by ID:",n),{data:null,success:!1,error:n.message}}},createRecord:async(a,r)=>{try{return{data:(await ge.post(`${Se}/data/createRecord`,{schemaName:a.schemaName,tableName:a.tableName,record:r})).data,success:!0}}catch(n){throw V.error("Error creating record:",n),n}},createPaymentReminder:async a=>{try{return{data:(await ge.post(`${Se}/payment-reminders/add`,a,{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(r){throw V.error("Error creating payment reminder:",r),r}},updateRecord:async(a,r,n,i)=>{try{return{data:(await ge.post(`${Se}/data/updateMultiple`,{schemaName:a.schemaName,tableName:a.tableName,recordId:r,ownerId:n,updates:i},{headers:{"Content-Type":"application/json"}})).data,success:!0}}catch(l){throw V.error("Error updating record:",l),l}},deleteRecord:async(a,r)=>{try{const n=new URLSearchParams({id:r,schemaName:a.schemaName,tableName:a.tableName});return{data:(await ge.get(`${Se}/data/deleteRecord?${n.toString()}`)).data,success:!0}}catch(n){throw V.error("Error deleting record:",n),n}},fetchDropdownSetup:async(a,r)=>{try{const n=await ge.get(`${Se}/reference/setup/check?owner_id=${a}&product_name=${r}`);return n.data.exists&&n.data.setup?{mapping:n.data.setup.mapping||{},columnOrder:n.data.setup.columnOrder||{},exists:!0,success:!0}:{mapping:{},columnOrder:{},exists:!1,success:!0}}catch(n){return V.error("Error fetching dropdown setup:",n),{mapping:{},columnOrder:{},exists:!1,success:!1}}}},us={DEFAULT_PAGE_SIZE:20},ie={TEXT:"text",NUMBER:"number",EMAIL:"email",PHONE:"tel",URL:"url",DATE:"date",TEXTAREA:"textarea",CHECKBOX:"checkbox",SELECT_STATUS:"select-status",SELECT_PRIORITY:"select-priority"},Ve={PENDING:"pending",IN_PROGRESS:"in progress",COMPLETED:"completed"},Ie={LOW:"low",MEDIUM:"medium",HIGH:"high"},Nt={[Ve.PENDING]:"bg-yellow-100 text-yellow-700 border-yellow-200",[Ve.IN_PROGRESS]:"bg-blue-100 text-blue-700 border-blue-200",[Ve.COMPLETED]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},Et={[Ie.HIGH]:"bg-red-100 text-red-700 border-red-200",[Ie.MEDIUM]:"bg-orange-100 text-orange-700 border-orange-200",[Ie.LOW]:"bg-green-100 text-green-700 border-green-200",default:"bg-gray-100 text-gray-700 border-gray-200"},hs=["invoice","date","due_date","final_due_date","last_overdue_reminder_date","sent_at","created_at","updated_at"],fs=["out_webhooks","emails"],nt={PA_ID:"pa_id"},ps=a=>a.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),ms=(a,r)=>{const n=r.toLowerCase();return n.includes("email")?ie.EMAIL:n.includes("phone")?ie.PHONE:n.includes("url")||n.includes("link")||n.includes("invoice_url")?ie.URL:n==="status"?ie.SELECT_STATUS:n==="priority"?ie.SELECT_PRIORITY:n.includes("description")||n.includes("notes")||n.includes("comment")?ie.TEXTAREA:n.includes("date")||n.includes("created")||n.includes("updated")||n==="invoice"?ie.DATE:typeof a=="number"?ie.NUMBER:typeof a=="boolean"?ie.CHECKBOX:a&&a.length>100?ie.TEXTAREA:ie.TEXT},gs=()=>Date.now().toString(),qe=(a,r)=>r[a==null?void 0:a.toLowerCase()]||r.default,xs=(a,r=null)=>a.filter(n=>{if(n.id==="id"||n.id.includes("_comment")||n.id.includes("created_at")||n.id.includes("updated_at"))return!1;if(r){const i=n.id.toLowerCase(),l=n.name.toLowerCase();if(i.includes("balance")||l.includes("balance"))return!1}return!0}),bs=(a,r={})=>a.filter(n=>r[n.id]!==0).sort((n,i)=>{const l=r[n.id]||999,f=r[i.id]||999;return l!==f?l-f:n.name.localeCompare(i.name)}),ys=(a,r=[],n=[])=>Object.fromEntries(Object.entries(a).map(([i,l])=>r.includes(i)?[i,l===""?null:l]:n.includes(i)?l===""?[i,null]:[i,l]:[i,l===""?null:l])),_s=(a,r=[])=>Object.fromEntries(Object.entries(a).filter(([n,i])=>i!=null&&i!==""?!0:r.includes(n))),ws=(a,r="normal",n)=>{const[i,l]=u.useState([]),[f,h]=u.useState([]),[x,b]=u.useState([]),[o,C]=u.useState({}),[A,M]=u.useState(!0),D=u.useCallback(async()=>{try{M(!0),V.debug("Fetching table data",{apiParams:a,type:r});let d;r==="normal"?(d=await ke.fetchRecords(a),C(d.columns)):d=await ke.fetchPaymentRecords(n);let p=d.data||[];if(r==="payment"&&(p=p.filter(_=>_.type==="original"||_.type==="Original")),h(p),l(p),p.length>0){const _=p[0],j=Object.keys(_).map(B=>({id:B,name:ps(B),sortable:!0,visible:!0,type:ms(_[B],B)}));b(j)}else b([])}catch(d){V.error("Error fetching table data:",d),J.error("Failed to fetch records"),h([]),l([]),b([])}finally{M(!1)}},[a.schemaName,a.tableName,r,n]);return u.useEffect(()=>{D()},[D]),{records:i,setRecords:l,originalRecords:f,columns:x,setColumns:b,metaData:o,loading:A,fetchData:D,refreshData:D}},at="https://click.wa.expert/api",it={async fetch(a,r){var n;try{const i=`${a}_${r}`,l=await ge.post(`${at}/data/getRecordById`,{id:i,schemaName:"public",tableName:"column_preferences"});let f=l.data.column_visibility;if(typeof f=="string")try{f=JSON.parse(f)}catch{return null}return{...l.data,column_visibility:f}}catch(i){return((n=i.response)==null?void 0:n.status)===404,null}},async save(a,r,n,i){var f;try{const h=`${a}_${r}`,x=JSON.stringify(n),b=`${at}/data/createRecord`,o={schemaName:"public",tableName:"column_preferences",record:{us_id:h,owner_id:a,table_name:r,schema_name:i,column_visibility:x,updated_at:new Date().toISOString()}};return{success:!0,data:(await ge.post(b,o)).data}}catch(h){return{success:!1,error:((f=h.response)==null?void 0:f.data)||h.message}}}},Cs=(a,r,n,i)=>{const[l,f]=u.useState(i),[h,x]=u.useState(!1),b=u.useCallback(async()=>{try{const d=await it.fetch(a,r);return d&&d.column_visibility?(V.debug("Loaded column preferences:",d.column_visibility),d.column_visibility):null}catch(d){return V.error("Error loading column preferences:",d),null}},[a,r]),o=u.useCallback((d,p)=>p?d.map(_=>{const j=p[_.id]!==void 0?p[_.id]:!0;return{..._,visible:j}}):d,[]),C=u.useCallback(async d=>{try{const p={};d.forEach(j=>{p[j.id]=j.visible}),(await it.save(a,r,p,n)).success&&(V.debug("Column preferences saved successfully"),J.success("Column preferences saved"))}catch(p){V.error("Error saving column preferences:",p),J.error("Failed to save column preferences")}},[a,r,n]),A=u.useCallback(async d=>{const p=l.map(_=>_.id===d?{..._,visible:!_.visible}:_);f(p),await C(p)},[l,C]),M=u.useCallback(async()=>{const d=l.map(p=>({...p,visible:!0}));f(d),await C(d),J.success("Column visibility reset to default")},[l,C]),D=u.useCallback(async()=>{const d=l.map(p=>({...p,visible:!1}));f(d),await C(d),J.success("All columns hidden")},[l,C]);return u.useEffect(()=>{(async()=>{if(!h&&i.length>0){const p=await b(),_=o(i,p);f(_),x(!0)}})()},[i,h,b,o]),u.useEffect(()=>{i.length>0&&!h&&f(i)},[i,h]),{columns:l,setColumns:f,toggleColumnVisibility:A,resetColumnVisibility:M,hideAllColumns:D,visibleColumns:l.filter(d=>d.visible)}},js=a=>{const[r,n]=u.useState(""),[i,l]=u.useState([]),[f,h]=u.useState([]),x=u.useMemo(()=>{if(!a.length)return[];let d=[...a];if(r.trim()!==""){const p=r.toLowerCase();d=d.filter(_=>Object.values(_).some(j=>String(j).toLowerCase().includes(p)))}return i.length>0&&(d=d.filter(p=>i.includes(p.status))),f.length>0&&(d=d.filter(p=>f.includes(p.priority))),V.debug("Filtered records:",{original:a.length,filtered:d.length,searchTerm:r,statusFilter:i,priorityFilter:f}),d},[a,r,i,f]),b=u.useMemo(()=>Array.from(new Set(a.map(d=>d.status))).filter(Boolean),[a]),o=u.useMemo(()=>Array.from(new Set(a.map(d=>d.priority))).filter(Boolean),[a]),C=u.useCallback(d=>{l(p=>p.includes(d)?p.filter(_=>_!==d):[...p,d])},[]),A=u.useCallback(d=>{h(p=>p.includes(d)?p.filter(_=>_!==d):[...p,d])},[]),M=u.useCallback(()=>{n(""),l([]),h([])},[]),D=u.useMemo(()=>r!==""||i.length>0||f.length>0,[r,i,f]);return{searchTerm:r,setSearchTerm:n,statusFilter:i,setStatusFilter:l,priorityFilter:f,setPriorityFilter:h,filteredRecords:x,uniqueStatuses:b,uniquePriorities:o,toggleStatusFilter:C,togglePriorityFilter:A,clearFilters:M,hasActiveFilters:D}},vs=(a,r=us.DEFAULT_PAGE_SIZE)=>{const[n,i]=u.useState(1),[l,f]=u.useState(r),h=a.length,x=Math.ceil(h/l),b=u.useMemo(()=>{const d=n*l,p=d-l;return a.slice(p,d)},[a,n,l]),o=u.useCallback(d=>{const p=Math.max(1,Math.min(d,x));i(p)},[x]),C=u.useCallback(()=>{n<x&&i(d=>d+1)},[n,x]),A=u.useCallback(()=>{n>1&&i(d=>d-1)},[n]),M=u.useCallback(d=>{f(d),i(1)},[]),D=u.useCallback(()=>{i(1),f(r)},[r]);return{currentPage:n,pageSize:l,totalRecords:h,totalPages:x,currentRecords:b,setCurrentPage:o,nextPage:C,previousPage:A,changePageSize:M,resetPagination:D}},Ns=(a,r,n)=>{const[i,l]=u.useState({}),[f,h]=u.useState(!1),[x,b]=u.useState(!1),o=u.useCallback((p={})=>{l(p)},[]),C=u.useCallback((p,_)=>{l(j=>({...j,[p]:_}))},[]),A=u.useCallback(()=>{l({})},[]),M=u.useCallback(async(p={})=>{try{h(!0);const _={...i,...p};V.debug("Submitting form data:",_);const j=ys(_,hs,fs),P=_s(j,["status","type"]);V.debug("Cleaned record data:",P);let re;return r==="payment"?re=await ke.createPaymentReminder(P):re=await ke.createRecord(a,P),J.success("Record created successfully!"),n&&n(re.data),A(),b(!1),re}catch(_){throw V.error("Error submitting form:",_),_.response?J.error(`Failed to create record: ${_.response.data.error||_.response.data.message||"Unknown error"}`):J.error(`Failed to create record: ${_.message}`),_}finally{h(!1)}},[i,a,r,n,A]),D=u.useCallback((p={})=>{o(p),b(!0)},[o]),d=u.useCallback(()=>{b(!1),A()},[A]);return{formData:i,isSubmitting:f,isOpen:x,initializeForm:o,handleFieldChange:C,resetForm:A,submitForm:M,openForm:D,closeForm:d}},Es=(a,r)=>{const[n,i]=u.useState({}),[l,f]=u.useState({}),[h,x]=u.useState(!1),[b,o]=u.useState(!0),C=u.useCallback(async()=>{try{o(!0);const d=await ke.fetchDropdownSetup(a,r);d.exists?(i(d.mapping),f(d.columnOrder),x(!0),V.debug("Dropdown setup loaded:",{mapping:d.mapping,columnOrder:d.columnOrder})):(i({}),f({}),x(!1))}catch(d){V.error("Error fetching dropdown setup:",d),i({}),f({}),x(!1)}finally{o(!1)}},[a,r]),A=u.useCallback(d=>n[d]||[],[n]),M=u.useCallback(d=>{const p=n[d];return Array.isArray(p)&&p.length>0},[n]),D=u.useCallback(d=>l[d]||999,[l]);return u.useEffect(()=>{a&&r&&C()},[a,r,C]),{dropdownSetup:n,columnOrder:l,setupExists:h,loading:b,fetchSetup:C,getDropdownOptions:A,hasDropdown:M,getColumnOrder:D}},Ss=({tableName:a="jobstatus",onCounterUpdate:r})=>{const[n,i]=u.useState(0),[l,f]=u.useState(""),[h,x]=u.useState(!1),[b,o]=u.useState(!1),[C,A]=u.useState(!1),[M,D]=u.useState(null),d=ut(P=>P.user),p=d.owner_id===null?d.id:d.owner_id,_=async()=>{try{A(!0);const P="https://click.wa.expert/api/data/getRecordById",oe={id:`${p}_${a}`,schemaName:"public",tableName:"counter_setup"},{data:q}=await ge.post(P,oe);if(q){const w=parseInt(q.counter,10)||0;i(w),f(q.prefix||""),x(q.is_active||!1),D(q.id),r&&r({counter:w,prefix:q.prefix||"",isActive:q.is_active||!1,recordId:q.id})}}catch{i(1),f(""),x(!1),D(null),await j()}finally{A(!1)}},j=async()=>{try{const P="https://click.wa.expert/api/data/createRecord",oe={schemaName:"public",tableName:"counter_setup",record:{us_id:`${p}_${a}`,owner_id:p,table_name:a,prefix:"",counter:1,is_active:!1}},{data:q}=await ge.post(P,oe);await _()}catch{}},B=async()=>{try{o(!0);const P=parseInt(n,10),re="https://click.wa.expert/api/data/createRecord",oe=`${p}_${a}`,q={schemaName:"public",tableName:"counter_setup",record:{us_id:oe,owner_id:p,table_name:a,prefix:l,counter:P,is_active:h,updated_at:new Date().toISOString()}};await ge.post(re,q),J.success("Counter settings saved successfully"),r&&r({counter:P,prefix:l,isActive:h,recordId:M||oe}),await _()}catch{J.error("Failed to save counter settings")}finally{o(!1)}};return u.useEffect(()=>{_()},[a]),e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[e.jsx(zt,{id:"counter-active",checked:h,onCheckedChange:x}),e.jsx(Be,{htmlFor:"counter-active",className:"text-sm font-medium whitespace-nowrap",children:"Auto Counter"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-[120px]",children:[e.jsx(Be,{htmlFor:"prefix",className:"text-sm whitespace-nowrap",children:"Prefix:"}),e.jsx(je,{id:"prefix",type:"text",value:l,onChange:P=>f(P.target.value),placeholder:"INV",className:"h-9"})]}),h&&e.jsxs("div",{className:"text-sm bg-blue-50 px-2 py-1.5 rounded border border-blue-200 flex w-[10rem] items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Next : "}),e.jsxs("span",{className:"font-mono font-semibold text-blue-700",children:[l,n]})]}),e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx(ee,{onClick:B,disabled:b,size:"sm",variant:"default",children:e.jsx(Bt,{className:"h-3.5 w-3.5"})}),e.jsx(ee,{onClick:_,disabled:C,variant:"outline",size:"sm",children:e.jsx(gt,{className:`h-3.5 w-3.5 ${C?"animate-spin":""}`})})]})]})})})},ks=({title:a="All Records",description:r="View and manage all database records",searchTerm:n="",onSearchChange:i,tableName:l,onCounterUpdate:f,urlParams:h={},dropdownSetupExists:x=!1,columnOrderExists:b=!1})=>e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{className:"w-[95%]",children:[e.jsxs("div",{className:"flex md:flex-row md:items-center justify-between w-full",children:[e.jsx(ct,{className:"text-2xl font-semibold text-slate-700",children:a}),e.jsx("div",{className:"lg:flex-1 lg:max-w-[500px]",children:e.jsx(Ss,{tableName:l,onCounterUpdate:f})})]}),e.jsxs(At,{className:"mt-1",children:[r,h.pa_id&&e.jsx("div",{className:"flex gap-2 mt-1",children:e.jsxs(ue,{variant:"outline",className:"text-xs bg-green-50 border-green-200",children:["PA ID: ",h.pa_id]})}),h.process_name&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs(ue,{variant:"outline",className:"text-xs bg-purple-50 border-purple-200",children:["Process: ",h.process_name]}),e.jsxs(ue,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[h.process_name,"_balance"]})]}),x&&e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(ue,{variant:"outline",className:"text-xs",children:"Dropdown Configured"}),b&&e.jsxs(ue,{variant:"outline",className:"text-xs bg-blue-50 border-blue-200",children:[e.jsx(qt,{className:"h-3 w-3 mr-1"}),"Custom Order"]})]})]})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-end gap-3",children:e.jsxs("div",{className:"relative lg:w-[300px]",children:[e.jsx(Ft,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"}),e.jsx(je,{type:"text",placeholder:"Search records...",value:n,onChange:i,className:"pl-9"})]})})]}),Rs=({onRefresh:a,onAddRecord:r,onExportCSV:n,onToggleEdit:i,editEnabled:l=!1,canEdit:f=!0,isLoading:h=!1})=>e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(ee,{className:"flex items-center gap-2",onClick:r,disabled:h,children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add Record"})]}),e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:a,disabled:h,children:[e.jsx(gt,{className:`h-4 w-4 ${h?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:n,disabled:h,children:[e.jsx(Jt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]}),f&&e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",onClick:i,disabled:h,children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:l?"Editing":"Edit"}),l&&e.jsx(ue,{className:"ml-1 bg-blue-500",children:"ON"})]})]}),Ds=({uniqueStatuses:a=[],uniquePriorities:r=[],statusFilter:n=[],priorityFilter:i=[],onToggleStatus:l,onTogglePriority:f,onClearStatusFilter:h,onClearPriorityFilter:x})=>{const b=n.length+i.length;return e.jsxs(ht,{children:[e.jsx(ft,{asChild:!0,children:e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Filters"}),b>0&&e.jsx(ue,{className:"ml-1 py-0 px-1.5 h-5 min-w-5 bg-blue-500 text-white rounded-full",children:b})]})}),e.jsxs(pt,{align:"start",className:"w-56",children:[e.jsxs(We,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Status"}),n.length>0&&e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:h,children:"Clear"})]}),a.length>0?a.map(o=>e.jsxs(Ye,{checked:n.includes(o),onCheckedChange:()=>l(o),children:[e.jsx(ue,{className:`font-medium mr-2 ${qe(o,Nt)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(Ge,{disabled:!0,children:"No statuses available"}),e.jsx(mt,{}),e.jsxs(We,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Filter by Priority"}),i.length>0&&e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:x,children:"Clear"})]}),r.length>0?r.map(o=>e.jsxs(Ye,{checked:i.includes(o),onCheckedChange:()=>f(o),children:[e.jsx(ue,{className:`font-medium mr-2 ${qe(o,Et)}`,children:o}),e.jsx("span",{children:o})]},o)):e.jsx(Ge,{disabled:!0,children:"No priorities available"})]})]})},Os=({columns:a=[],onToggleColumn:r,onResetVisibility:n,onHideAll:i})=>e.jsxs(ht,{children:[e.jsx(ft,{asChild:!0,children:e.jsxs(ee,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Columns"})]})}),e.jsxs(pt,{align:"start",className:"w-56",children:[e.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5",children:[e.jsx(We,{className:"p-0",children:"Toggle Columns"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:l=>{l.stopPropagation(),i()},children:"Hide All"}),e.jsx(ee,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:l=>{l.stopPropagation(),n()},children:"Reset"})]})]}),e.jsx(mt,{}),a.map(l=>e.jsx(Ge,{onSelect:f=>{f.preventDefault(),r(l.id)},children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(xt,{checked:l.visible,onCheckedChange:()=>r(l.id)}),e.jsx("span",{className:"flex-1",children:l.name}),!l.visible&&e.jsx(ue,{variant:"secondary",className:"text-xs",children:"Hidden"})]})},l.id))]})]}),Is=({records:a=[],columns:r=[],loading:n=!1,editEnabled:i=!1,canDelete:l=!1,onSort:f,onDeleteRecord:h,onEditRecord:x,onSaveRecord:b,sortColumn:o=null,sortDirection:C="asc",emptyMessage:A="No records found",onClearFilters:M})=>{const[D,d]=u.useState(null),[p,_]=u.useState({}),j=u.useCallback(w=>{i&&(d(w.id),_(w),x&&x(w))},[i,x]),B=u.useCallback(()=>{b&&b(D,p),d(null),_({})},[D,p,b]),P=u.useCallback(()=>{d(null),_({})},[]),re=u.useCallback((w,t)=>{_(s=>({...s,[w]:t}))},[]),oe=(w,t)=>{const s=w[t.id];return D===w.id&&t.id!=="id"&&i?e.jsx(je,{type:"text",value:p[t.id]||"",onChange:c=>re(t.id,c.target.value),className:"border rounded px-2 py-1 w-full",onClick:c=>c.stopPropagation()}):t.id==="status"?e.jsx(ue,{className:`font-medium ${qe(s,Nt)}`,children:s}):t.id==="priority"?e.jsx(ue,{className:`font-medium ${qe(s,Et)}`,children:s}):t.id==="task_file"&&s?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ts,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{children:s})]}):e.jsx("span",{children:s||"â€”"})},q=r.filter(w=>w.visible);return e.jsxs("div",{className:"rounded-md border overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Gt,{children:[e.jsx(Kt,{children:e.jsxs($e,{className:"bg-slate-50",children:[l&&e.jsx(st,{className:"w-[60px] text-center",children:"Delete"}),q.map(w=>e.jsx(st,{className:`${w.sortable?"cursor-pointer hover:bg-slate-100":""}`,onClick:()=>w.sortable&&f&&f(w.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:w.name}),o===w.id&&e.jsx(Lt,{className:`h-4 w-4 transition-transform ${C==="desc"?"rotate-180":""}`})]})},w.id))]})}),e.jsx(Xt,{children:n?e.jsx($e,{children:e.jsx(Ue,{colSpan:q.length+(l?1:0),className:"h-24 text-center",children:"Loading records..."})}):a.length===0?e.jsx($e,{children:e.jsxs(Ue,{colSpan:q.length+(l?1:0),className:"h-24 text-center",children:[A,M&&e.jsx(ee,{variant:"link",onClick:M,className:"ml-2",children:"Clear filters?"})]})}):a.map((w,t)=>e.jsxs($e,{className:"hover:bg-slate-50 cursor-pointer",onClick:()=>j(w),children:[l&&e.jsx(Ue,{className:"w-[60px] text-center",children:e.jsx(ee,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:s=>{s.stopPropagation(),h&&h(w)},children:e.jsx(bt,{className:"h-4 w-4"})})}),q.map(s=>e.jsx(Ue,{children:oe(w,s)},s.id))]},w.id||t))})]})}),D&&i&&e.jsxs("div",{className:"flex gap-2 p-3 bg-slate-50 border-t",children:[e.jsx(ee,{size:"sm",onClick:B,children:"Save Changes"}),e.jsx(ee,{size:"sm",variant:"ghost",onClick:P,children:"Cancel"})]})]})},Ts=({column:a,value:r,onChange:n,dropdownOptions:i=[],isAutoFilled:l=!1,disabled:f=!1})=>{const{id:h,type:x,name:b}=a;if(l)return e.jsx(je,{id:h,type:"text",value:r||"",disabled:!0,className:"bg-gray-50 cursor-not-allowed text-gray-600",placeholder:`Auto-filled ${b.toLowerCase()}`});if(i.length>0)return e.jsxs(Ze,{value:r||"",onValueChange:o=>n(h,o),disabled:f,children:[e.jsx(Je,{children:e.jsx(et,{placeholder:`Select ${b.toLowerCase()}`})}),e.jsx(tt,{children:i.map((o,C)=>e.jsx(Pe,{value:o,children:o},C))})]});switch(x){case ie.TEXTAREA:return e.jsx(Qt,{id:h,value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,rows:3,disabled:f});case ie.SELECT_PRIORITY:return e.jsxs(Ze,{value:r||"",onValueChange:o=>n(h,o),disabled:f,children:[e.jsx(Je,{children:e.jsx(et,{placeholder:"Select priority"})}),e.jsxs(tt,{children:[e.jsx(Pe,{value:Ie.LOW,children:"Low"}),e.jsx(Pe,{value:Ie.MEDIUM,children:"Medium"}),e.jsx(Pe,{value:Ie.HIGH,children:"High"})]})]});case ie.NUMBER:return e.jsx(je,{id:h,type:"number",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,disabled:f});case ie.EMAIL:return e.jsx(je,{id:h,type:"email",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,disabled:f});case ie.PHONE:return e.jsx(je,{id:h,type:"tel",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,disabled:f});case ie.DATE:return e.jsx(je,{id:h,type:"date",value:r||"",onChange:o=>n(h,o.target.value),disabled:f});case ie.URL:return e.jsx(je,{id:h,type:"url",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,disabled:f});case ie.CHECKBOX:return e.jsx(xt,{id:h,checked:r||!1,onCheckedChange:o=>n(h,o),disabled:f});default:return e.jsx(je,{id:h,type:"text",value:r||"",onChange:o=>n(h,o.target.value),placeholder:`Enter ${b.toLowerCase()}`,disabled:f})}},As=({isOpen:a,onClose:r,onSubmit:n,formData:i,onFieldChange:l,columns:f,metaData:h=[],dropdownSetup:x={},columnOrder:b={},processName:o=null,isSubmitting:C=!1,mode:A="create"})=>{const M=u.useMemo(()=>{const j=xs(f,o);return bs(j,b)},[f,o,b]),D=j=>{const B=h.find(P=>P.column_name===j);return(B==null?void 0:B.is_nullable)==="NO"},d=j=>j===nt.PA_ID,p=j=>{const B=x[j];return Array.isArray(B)?B:[]},_=j=>o&&(j.id.toLowerCase().includes("quantity")||j.name.toLowerCase().includes("quantity"));return e.jsx(yt,{open:a,onOpenChange:r,children:e.jsxs(_t,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",onInteractOutside:j=>j.preventDefault(),children:[e.jsxs(wt,{children:[e.jsx(Ct,{children:A==="create"?"Add New Record":"Edit Record"}),e.jsxs(jt,{children:[A==="create"?"Fill in the details to create a new record in the database.":"Update the record details.",o&&e.jsxs("span",{className:"block mt-1 text-blue-600",children:["Note: The ",o,"_balance field will be automatically set to match the quantity value."]})]})]}),e.jsx("div",{className:"space-y-6 py-4",children:M.map(j=>{const B=b[j.id];p(j.id).length>0;const P=d(j.id),re=D(j.id),oe=_(j);return e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[e.jsxs(Be,{htmlFor:j.id,className:"font-medium text-sm sm:w-48 sm:text-right sm:flex-shrink-0 flex items-center gap-1 justify-start sm:justify-end",children:[B&&e.jsx(ue,{variant:"secondary",className:"text-xs h-4 px-1 mr-1",children:B}),e.jsx("span",{className:"flex-1 sm:flex-initial",children:j.name}),re&&e.jsx(ue,{variant:"default",className:"text-xs h-4 px-1 text-red-100",children:"*"}),P&&e.jsx(ue,{variant:"default",className:"text-xs h-4 px-1 bg-green-500 ml-1",children:"auto"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Ts,{column:j,value:i[j.id],onChange:l,dropdownOptions:p(j.id),isAutoFilled:P,disabled:C}),P&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.id===nt.PA_ID?"Automatically filled from URL parameter":"Automatically generated unique identifier"}),oe&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["This value will be used to set ",o,"_balance"]})]})]},j.id)})}),e.jsxs(vt,{className:"flex flex-col sm:flex-row gap-3 sm:gap-2",children:[e.jsx(ee,{variant:"outline",onClick:r,disabled:C,className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancel"}),e.jsx(ee,{onClick:n,disabled:C,className:"w-full sm:w-auto order-1 sm:order-2",children:C?A==="create"?"Creating...":"Updating...":A==="create"?"Create Record":"Update Record"})]})]})})},Fs=({isOpen:a,onClose:r,onConfirm:n,record:i,confirmInput:l,onConfirmInputChange:f,isDeleting:h=!1})=>{const x=l.trim()===(i==null?void 0:i.us_id);return e.jsx(yt,{open:a,onOpenChange:r,children:e.jsxs(_t,{className:"max-w-md",children:[e.jsxs(wt,{children:[e.jsxs(Ct,{className:"flex items-center gap-2",children:[e.jsx(bt,{className:"h-5 w-5 text-red-500"}),"Confirm Deletion"]}),e.jsxs(jt,{children:["This action cannot be undone. Please type the ",e.jsx("strong",{children:"us_id"})," to confirm deletion."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[i&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded border",children:[e.jsx("p",{className:"text-sm font-medium",children:"Record to delete:"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",i.id]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["US_ID: ",e.jsx("span",{className:"font-mono bg-yellow-100 px-1 rounded",children:i.us_id})]})]}),e.jsxs("div",{children:[e.jsx(Be,{htmlFor:"confirm-us-id",className:"text-sm font-medium",children:"Enter us_id to confirm:"}),e.jsx(je,{id:"confirm-us-id",type:"text",placeholder:"Type us_id here",value:l,onChange:b=>f(b.target.value),className:"mt-1",autoFocus:!0,disabled:h})]})]}),e.jsxs(vt,{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(ee,{variant:"outline",onClick:r,disabled:h,className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(ee,{variant:"destructive",onClick:n,disabled:h||!x,className:"w-full sm:w-auto",children:h?"Deleting...":"Delete Record"})]})]})})};function Ls({className:a,...r}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:Fe("mx-auto flex w-full justify-center",a),...r})}function Ms({className:a,...r}){return e.jsx("ul",{"data-slot":"pagination-content",className:Fe("flex flex-row items-center gap-1",a),...r})}function Oe({...a}){return e.jsx("li",{"data-slot":"pagination-item",...a})}function Ae({className:a,isActive:r,size:n="icon",...i}){return e.jsx("a",{"aria-current":r?"page":void 0,"data-slot":"pagination-link","data-active":r,className:Fe(Mt({variant:r?"outline":"ghost",size:n}),a),...i})}function Ps({className:a,...r}){return e.jsxs(Ae,{"aria-label":"Go to previous page",size:"default",className:Fe("gap-1 px-2.5 sm:pl-2.5",a),...r,children:[e.jsx(Yt,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function $s({className:a,...r}){return e.jsxs(Ae,{"aria-label":"Go to next page",size:"default",className:Fe("gap-1 px-2.5 sm:pr-2.5",a),...r,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(Pt,{})]})}function Us(a=640){const[r,n]=u.useState(typeof window<"u"?window.innerWidth<a:!1);return u.useEffect(()=>{function i(){n(window.innerWidth<a)}return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[a]),r}function zs({currentPage:a,setCurrentPage:r,totalPages:n,records:i=[],pageSize:l=10,totalRecords:f=0}){const x=Us(640)?3:7,b=u.useMemo(()=>{if(n<=x)return[...Array(n)].map((D,d)=>d+1);const o=Math.floor(x/2);let C=Math.max(1,a-o),A=Math.min(n,a+o);a<=o?(C=1,A=x):a+o>=n&&(C=n-x+1,A=n);const M=[];for(let D=C;D<=A;D++)M.push(D);return M},[n,a,x]);return e.jsxs("div",{className:"flex items-center justify-between mt-4 w-full px-4",children:[e.jsxs("div",{className:"hidden sm:block text-sm text-slate-500",children:["Showing ",e.jsx("span",{className:"font-medium",children:Math.min(i.length,l)})," of"," ",e.jsx("span",{className:"font-medium",children:f})," records"]}),e.jsx("div",{className:"flex-1 flex justify-center sm:justify-end",children:e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto sm:overflow-visible py-1",children:e.jsx(Ls,{children:e.jsxs(Ms,{children:[e.jsx(Oe,{children:e.jsx(Ps,{href:"#",onClick:o=>{o.preventDefault(),a>1&&r(a-1)},className:a<=1?"pointer-events-none opacity-50":""})}),b[0]>1&&e.jsxs(e.Fragment,{children:[e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:o=>{o.preventDefault(),r(1)},isActive:a===1,children:"1"})}),e.jsx(Oe,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})})]}),b.map(o=>e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:C=>{C.preventDefault(),r(o)},isActive:a===o,children:o})},o)),b[b.length-1]<n&&e.jsxs(e.Fragment,{children:[e.jsx(Oe,{children:e.jsx("span",{className:"inline-flex items-center px-2",children:"â€¦"})}),e.jsx(Oe,{children:e.jsx(Ae,{href:"#",onClick:o=>{o.preventDefault(),r(n)},isActive:a===n,children:n})})]}),e.jsx(Oe,{children:e.jsx($s,{href:"#",onClick:o=>{o.preventDefault(),a<n&&r(a+1)},className:a>=n?"pointer-events-none opacity-50":""})})]})})})})]})}const Bs=({type:a="normal"})=>{const[r,n]=$t(),i=ut(F=>F.user),l=u.useMemo(()=>({pa_id:r.get("pa_id"),us_id:r.get("us_id"),show:r.get("show"),status:r.get("status"),process_name:r.get("process_name")}),[r]),{tableName1:f}=Ut(),h=u.useMemo(()=>({schemaName:i.schema_name,tableName:f,userId:i.id,userEmail:i.email}),[i.schema_name,f,i.id,i.email]),x=(i==null?void 0:i.owner_id)??(i==null?void 0:i.id),[b,o]=u.useState(!1),[C,A]=u.useState(null),[M,D]=u.useState("asc"),[d,p]=u.useState({counter:0,prefix:"",isActive:!1,recordId:null}),[_,j]=u.useState(!1),[B,P]=u.useState(null),[re,oe]=u.useState(""),[q,w]=u.useState(!1),{setRecords:t,originalRecords:s,columns:c,metaData:g,loading:m,refreshData:E}=ws(h,a,x),{columns:U,setColumns:he,toggleColumnVisibility:fe,resetColumnVisibility:O,hideAllColumns:K,visibleColumns:v}=Cs(x,h.tableName,h.schemaName,c),{searchTerm:le,setSearchTerm:S,statusFilter:T,priorityFilter:y,filteredRecords:H,uniqueStatuses:Q,uniquePriorities:ne,toggleStatusFilter:de,togglePriorityFilter:I,clearFilters:L,hasActiveFilters:W}=js(s),{currentPage:N,totalPages:X,currentRecords:Z,setCurrentPage:z,resetPagination:$}=vs(H),{formData:R,isSubmitting:pe,isOpen:k,handleFieldChange:G,submitForm:we,openForm:Ne,closeForm:xe}=Ns(h,a,E),{dropdownSetup:Re,columnOrder:ae,setupExists:be}=Es(x,h.tableName);u.useEffect(()=>{c.length>0&&U.length===0&&he(c)},[c]),u.useEffect(()=>{const F=r.get("search");F&&S(decodeURIComponent(F))},[r,S]),u.useEffect(()=>{l.show==="true"&&U.length>0&&Ee()},[l.show,U]);const te=u.useCallback(F=>{p(F)},[]),ce=u.useCallback(()=>{E(),L(),$(),J.success("Data refreshed")},[E,L,$]),Ce=u.useCallback(F=>{S(F.target.value),$()},[S,$]),Te=u.useCallback(F=>{C===F?D(_e=>_e==="asc"?"desc":"asc"):(A(F),D("asc"));const Y=[...H].sort((_e,me)=>{const se=_e[F]||"",ve=me[F]||"";return typeof se=="string"&&typeof ve=="string"?M==="asc"?se.localeCompare(ve):ve.localeCompare(se):M==="asc"?se-ve:ve-se});t(Y)},[C,M,H,t]),Le=u.useCallback(()=>{if(!H.length){J.error("No records to export");return}try{const F=H.map(Rt=>{const Ke={};return v.forEach(Xe=>{Ke[Xe.name]=Rt[Xe.id]}),Ke}),Y=ds.unparse(F,{quotes:!0,quoteChar:'"',delimiter:",",header:!0}),_e=new Blob([Y],{type:"text/csv;charset=utf-8;"}),me=URL.createObjectURL(_e),se=document.createElement("a"),ve=new Date().toISOString().slice(0,10),kt=`${h.tableName}_export_${ve}.csv`;se.setAttribute("href",me),se.setAttribute("download",kt),se.style.display="none",document.body.appendChild(se),se.click(),document.body.removeChild(se),URL.revokeObjectURL(me),J.success(`Exported ${F.length} records to CSV`)}catch(F){V.error("Error exporting CSV:",F),J.error("Failed to export CSV")}},[H,v,h.tableName]),Ee=u.useCallback(async()=>{const F={};if(U.forEach(Y=>{l[Y.id]?F[Y.id]=l[Y.id]:Y.id==="us_id"?F[Y.id]=d.isActive?`${d.prefix}${d.counter}`:gs():F[Y.id]=""}),Ne(F),l.show==="true"){const Y=new URLSearchParams(r);Y.delete("show"),n(Y,{replace:!0})}},[U,l,d,Ne,r,n]),ye=u.useCallback(async()=>{try{let F={};if(l.process_name){const Y=`${l.process_name}_balance`,_e=U.find(me=>me.id.toLowerCase().includes("quantity"));if(_e){const me=R[_e.id];me&&(F[Y]=me)}}if((l.status&&l.pa_id||l.process_name&&l.pa_id)&&(F.us_id=`${l.pa_id} -S- ${R.us_id}`),await we(F),d.isActive&&d.recordId)try{await ke.updateRecord({schemaName:"public",tableName:"counter_setup"},d.recordId,x,{counter:d.counter+1}),p(Y=>({...Y,counter:Y.counter+1}))}catch(Y){V.error("Counter increment failed:",Y),J.warning("Record created but counter increment failed")}n({})}catch(F){V.error("Create record failed:",F)}},[R,U,l,d,we,x,n]),De=u.useCallback(F=>{P(F),oe(""),j(!0)},[]),Me=u.useCallback(async()=>{if(!B||re.trim()!==B.us_id){J.error("Entered us_id does not match");return}try{w(!0),await ke.deleteRecord(h,B.id),J.success("Record deleted successfully"),j(!1),P(null),oe(""),E()}catch(F){V.error("Delete failed:",F),J.error("Failed to delete record")}finally{w(!1)}},[B,re,h,E]),St=u.useCallback(async(F,Y)=>{try{const _e=s.find(se=>se.id===F),me={};if(Object.entries(Y).forEach(([se,ve])=>{ve!==_e[se]&&se!=="id"&&se!=="pa_id"&&se!=="us_id"&&(me[se]=ve)}),Object.keys(me).length===0){J.warning("No changes to save");return}await ke.updateRecord(h,F,x,me),J.success("Record updated successfully"),E()}catch(_e){V.error("Update failed:",_e),J.error("Failed to update record")}},[s,h,x,E]);return l.show==="true"?null:e.jsxs(ot,{className:"tableCard shadow-sm border-slate-200 mx-[6rem]",children:[e.jsx(lt,{className:"pb-3",children:e.jsx(ks,{title:"All Records",description:"View and manage all database records",searchTerm:le,onSearchChange:Ce,tableName:h.tableName,onCounterUpdate:te,urlParams:l,dropdownSetupExists:be,columnOrderExists:Object.keys(ae).length>0})}),e.jsxs(dt,{children:[e.jsx("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-3",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(Rs,{onRefresh:ce,onAddRecord:Ee,onExportCSV:Le,onToggleEdit:()=>o(!b),editEnabled:b,canEdit:i.owner_id===null,isLoading:m}),e.jsx(Ds,{uniqueStatuses:Q,uniquePriorities:ne,statusFilter:T,priorityFilter:y,onToggleStatus:de,onTogglePriority:I,onClearStatusFilter:()=>de([]),onClearPriorityFilter:()=>I([])}),e.jsx(Os,{columns:U,onToggleColumn:fe,onResetVisibility:O,onHideAll:K})]})}),e.jsx(Is,{records:Z,columns:U,loading:m,editEnabled:b,canDelete:i.owner_id===null,onSort:Te,onDeleteRecord:De,onSaveRecord:St,sortColumn:C,sortDirection:M,emptyMessage:W?"No records match filters":"No records found",onClearFilters:W?L:null}),e.jsx(zs,{currentPage:N,setCurrentPage:z,totalPages:X})]}),e.jsx(As,{isOpen:k,onClose:xe,onSubmit:ye,formData:R,onFieldChange:G,columns:U,metaData:g,dropdownSetup:Re,columnOrder:ae,processName:l.process_name,isSubmitting:pe,mode:"create"}),e.jsx(Fs,{isOpen:_,onClose:()=>j(!1),onConfirm:Me,record:B,confirmInput:re,onConfirmInputChange:oe,isDeleting:q})]})},ir=a=>e.jsx(is,{children:e.jsx(Bs,{...a})});export{ir as default};
