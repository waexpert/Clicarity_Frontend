import{j as o,Z as A,X as oe,r as i,U as H,a4 as Se,V as ve,a7 as Y,a9 as F,W as L,aR as _,aS as xe,aT as ge,a as G,z as we,I as ye,L as K,B as $,c as ee}from"./index-CxXEh7ic.js";import{C as te}from"./checkbox-DU8fzN43.js";import{R as Pe,C as Ce,a as Re,T as Ee,D as je,P as Ae,O as Te}from"./index-CSR42yF3.js";function Ne({...e}){return o.jsx(Pe,{"data-slot":"sheet",...e})}function _e({...e}){return o.jsx(Ae,{"data-slot":"sheet-portal",...e})}function Le({className:e,...r}){return o.jsx(Te,{"data-slot":"sheet-overlay",className:A("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...r})}function De({className:e,children:r,side:t="right",...s}){return o.jsxs(_e,{children:[o.jsx(Le,{}),o.jsxs(Ce,{"data-slot":"sheet-content",className:A("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",t==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",t==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",t==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",t==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...s,children:[r,o.jsxs(Re,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[o.jsx(oe,{className:"size-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function ze({className:e,...r}){return o.jsx("div",{"data-slot":"sheet-header",className:A("flex flex-col gap-1.5 p-4",e),...r})}function ke({className:e,...r}){return o.jsx("div",{"data-slot":"sheet-footer",className:A("mt-auto flex flex-col gap-2 p-4",e),...r})}function Oe({className:e,...r}){return o.jsx(Ee,{"data-slot":"sheet-title",className:A("text-foreground font-semibold",e),...r})}function We({className:e,...r}){return o.jsx(je,{"data-slot":"sheet-description",className:A("text-muted-foreground text-sm",e),...r})}function He(e,r){return i.useReducer((t,s)=>r[t][s]??t,e)}var q="ScrollArea",[ne,ot]=ve(q),[Ie,P]=ne(q),le=i.forwardRef((e,r)=>{const{__scopeScrollArea:t,type:s="hover",dir:n,scrollHideDelay:l=600,...a}=e,[c,d]=i.useState(null),[h,u]=i.useState(null),[p,f]=i.useState(null),[S,x]=i.useState(null),[R,I]=i.useState(null),[j,T]=i.useState(0),[X,N]=i.useState(0),[D,y]=i.useState(!1),[z,k]=i.useState(!1),v=H(r,E=>d(E)),w=Se(n);return o.jsx(Ie,{scope:t,type:s,dir:w,scrollHideDelay:l,scrollArea:c,viewport:h,onViewportChange:u,content:p,onContentChange:f,scrollbarX:S,onScrollbarXChange:x,scrollbarXEnabled:D,onScrollbarXEnabledChange:y,scrollbarY:R,onScrollbarYChange:I,scrollbarYEnabled:z,onScrollbarYEnabledChange:k,onCornerWidthChange:T,onCornerHeightChange:N,children:o.jsx(Y.div,{dir:w,...a,ref:v,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":X+"px",...e.style}})})});le.displayName=q;var se="ScrollAreaViewport",ae=i.forwardRef((e,r)=>{const{__scopeScrollArea:t,children:s,nonce:n,...l}=e,a=P(se,t),c=i.useRef(null),d=H(r,c,a.onViewportChange);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(Y.div,{"data-radix-scroll-area-viewport":"",...l,ref:d,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:o.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});ae.displayName=se;var C="ScrollAreaScrollbar",ce=i.forwardRef((e,r)=>{const{forceMount:t,...s}=e,n=P(C,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:a}=n,c=e.orientation==="horizontal";return i.useEffect(()=>(c?l(!0):a(!0),()=>{c?l(!1):a(!1)}),[c,l,a]),n.type==="hover"?o.jsx(Xe,{...s,ref:r,forceMount:t}):n.type==="scroll"?o.jsx(Ye,{...s,ref:r,forceMount:t}):n.type==="auto"?o.jsx(ie,{...s,ref:r,forceMount:t}):n.type==="always"?o.jsx(Q,{...s,ref:r}):null});ce.displayName=C;var Xe=i.forwardRef((e,r)=>{const{forceMount:t,...s}=e,n=P(C,e.__scopeScrollArea),[l,a]=i.useState(!1);return i.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const h=()=>{window.clearTimeout(d),a(!0)},u=()=>{d=window.setTimeout(()=>a(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",h),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",h),c.removeEventListener("pointerleave",u)}}},[n.scrollArea,n.scrollHideDelay]),o.jsx(F,{present:t||l,children:o.jsx(ie,{"data-state":l?"visible":"hidden",...s,ref:r})})}),Ye=i.forwardRef((e,r)=>{const{forceMount:t,...s}=e,n=P(C,e.__scopeScrollArea),l=e.orientation==="horizontal",a=B(()=>d("SCROLL_END"),100),[c,d]=He("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(c==="idle"){const h=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(h)}},[c,n.scrollHideDelay,d]),i.useEffect(()=>{const h=n.viewport,u=l?"scrollLeft":"scrollTop";if(h){let p=h[u];const f=()=>{const S=h[u];p!==S&&(d("SCROLL"),a()),p=S};return h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[n.viewport,l,d,a]),o.jsx(F,{present:t||c!=="hidden",children:o.jsx(Q,{"data-state":c==="hidden"?"hidden":"visible",...s,ref:r,onPointerEnter:L(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:L(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),ie=i.forwardRef((e,r)=>{const t=P(C,e.__scopeScrollArea),{forceMount:s,...n}=e,[l,a]=i.useState(!1),c=e.orientation==="horizontal",d=B(()=>{if(t.viewport){const h=t.viewport.offsetWidth<t.viewport.scrollWidth,u=t.viewport.offsetHeight<t.viewport.scrollHeight;a(c?h:u)}},10);return W(t.viewport,d),W(t.content,d),o.jsx(F,{present:s||l,children:o.jsx(Q,{"data-state":l?"visible":"hidden",...n,ref:r})})}),Q=i.forwardRef((e,r)=>{const{orientation:t="vertical",...s}=e,n=P(C,e.__scopeScrollArea),l=i.useRef(null),a=i.useRef(0),[c,d]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=pe(c.viewport,c.content),u={...s,sizes:c,onSizesChange:d,hasThumb:h>0&&h<1,onThumbChange:f=>l.current=f,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:f=>a.current=f};function p(f,S){return $e(f,a.current,c,S)}return t==="horizontal"?o.jsx(Me,{...u,ref:r,onThumbPositionChange:()=>{if(n.viewport&&l.current){const f=n.viewport.scrollLeft,S=re(f,c,n.dir);l.current.style.transform=`translate3d(${S}px, 0, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollLeft=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollLeft=p(f,n.dir))}}):t==="vertical"?o.jsx(Ue,{...u,ref:r,onThumbPositionChange:()=>{if(n.viewport&&l.current){const f=n.viewport.scrollTop,S=re(f,c);l.current.style.transform=`translate3d(0, ${S}px, 0)`}},onWheelScroll:f=>{n.viewport&&(n.viewport.scrollTop=f)},onDragScroll:f=>{n.viewport&&(n.viewport.scrollTop=p(f))}}):null}),Me=i.forwardRef((e,r)=>{const{sizes:t,onSizesChange:s,...n}=e,l=P(C,e.__scopeScrollArea),[a,c]=i.useState(),d=i.useRef(null),h=H(r,d,l.onScrollbarXChange);return i.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),o.jsx(ue,{"data-orientation":"horizontal",...n,ref:h,sizes:t,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":V(t)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,p)=>{if(l.viewport){const f=l.viewport.scrollLeft+u.deltaX;e.onWheelScroll(f),be(f,p)&&u.preventDefault()}},onResize:()=>{d.current&&l.viewport&&a&&s({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:U(a.paddingLeft),paddingEnd:U(a.paddingRight)}})}})}),Ue=i.forwardRef((e,r)=>{const{sizes:t,onSizesChange:s,...n}=e,l=P(C,e.__scopeScrollArea),[a,c]=i.useState(),d=i.useRef(null),h=H(r,d,l.onScrollbarYChange);return i.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),o.jsx(ue,{"data-orientation":"vertical",...n,ref:h,sizes:t,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":V(t)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,p)=>{if(l.viewport){const f=l.viewport.scrollTop+u.deltaY;e.onWheelScroll(f),be(f,p)&&u.preventDefault()}},onResize:()=>{d.current&&l.viewport&&a&&s({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:U(a.paddingTop),paddingEnd:U(a.paddingBottom)}})}})}),[Fe,de]=ne(C),ue=i.forwardRef((e,r)=>{const{__scopeScrollArea:t,sizes:s,hasThumb:n,onThumbChange:l,onThumbPointerUp:a,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:h,onWheelScroll:u,onResize:p,...f}=e,S=P(C,t),[x,R]=i.useState(null),I=H(r,v=>R(v)),j=i.useRef(null),T=i.useRef(""),X=S.viewport,N=s.content-s.viewport,D=_(u),y=_(d),z=B(p,10);function k(v){if(j.current){const w=v.clientX-j.current.left,E=v.clientY-j.current.top;h({x:w,y:E})}}return i.useEffect(()=>{const v=w=>{const E=w.target;(x==null?void 0:x.contains(E))&&D(w,N)};return document.addEventListener("wheel",v,{passive:!1}),()=>document.removeEventListener("wheel",v,{passive:!1})},[X,x,N,D]),i.useEffect(y,[s,y]),W(x,z),W(S.content,z),o.jsx(Fe,{scope:t,scrollbar:x,hasThumb:n,onThumbChange:_(l),onThumbPointerUp:_(a),onThumbPositionChange:y,onThumbPointerDown:_(c),children:o.jsx(Y.div,{...f,ref:I,style:{position:"absolute",...f.style},onPointerDown:L(e.onPointerDown,v=>{v.button===0&&(v.target.setPointerCapture(v.pointerId),j.current=x.getBoundingClientRect(),T.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",S.viewport&&(S.viewport.style.scrollBehavior="auto"),k(v))}),onPointerMove:L(e.onPointerMove,k),onPointerUp:L(e.onPointerUp,v=>{const w=v.target;w.hasPointerCapture(v.pointerId)&&w.releasePointerCapture(v.pointerId),document.body.style.webkitUserSelect=T.current,S.viewport&&(S.viewport.style.scrollBehavior=""),j.current=null})})})}),M="ScrollAreaThumb",he=i.forwardRef((e,r)=>{const{forceMount:t,...s}=e,n=de(M,e.__scopeScrollArea);return o.jsx(F,{present:t||n.hasThumb,children:o.jsx(Ve,{ref:r,...s})})}),Ve=i.forwardRef((e,r)=>{const{__scopeScrollArea:t,style:s,...n}=e,l=P(M,t),a=de(M,t),{onThumbPositionChange:c}=a,d=H(r,p=>a.onThumbChange(p)),h=i.useRef(void 0),u=B(()=>{h.current&&(h.current(),h.current=void 0)},100);return i.useEffect(()=>{const p=l.viewport;if(p){const f=()=>{if(u(),!h.current){const S=qe(p,c);h.current=S,c()}};return c(),p.addEventListener("scroll",f),()=>p.removeEventListener("scroll",f)}},[l.viewport,u,c]),o.jsx(Y.div,{"data-state":a.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:L(e.onPointerDownCapture,p=>{const S=p.target.getBoundingClientRect(),x=p.clientX-S.left,R=p.clientY-S.top;a.onThumbPointerDown({x,y:R})}),onPointerUp:L(e.onPointerUp,a.onThumbPointerUp)})});he.displayName=M;var J="ScrollAreaCorner",fe=i.forwardRef((e,r)=>{const t=P(J,e.__scopeScrollArea),s=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&s?o.jsx(Be,{...e,ref:r}):null});fe.displayName=J;var Be=i.forwardRef((e,r)=>{const{__scopeScrollArea:t,...s}=e,n=P(J,t),[l,a]=i.useState(0),[c,d]=i.useState(0),h=!!(l&&c);return W(n.scrollbarX,()=>{var p;const u=((p=n.scrollbarX)==null?void 0:p.offsetHeight)||0;n.onCornerHeightChange(u),d(u)}),W(n.scrollbarY,()=>{var p;const u=((p=n.scrollbarY)==null?void 0:p.offsetWidth)||0;n.onCornerWidthChange(u),a(u)}),h?o.jsx(Y.div,{...s,ref:r,style:{width:l,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function U(e){return e?parseInt(e,10):0}function pe(e,r){const t=e/r;return isNaN(t)?0:t}function V(e){const r=pe(e.viewport,e.content),t=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-t)*r;return Math.max(s,18)}function $e(e,r,t,s="ltr"){const n=V(t),l=n/2,a=r||l,c=n-a,d=t.scrollbar.paddingStart+a,h=t.scrollbar.size-t.scrollbar.paddingEnd-c,u=t.content-t.viewport,p=s==="ltr"?[0,u]:[u*-1,0];return me([d,h],p)(e)}function re(e,r,t="ltr"){const s=V(r),n=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,l=r.scrollbar.size-n,a=r.content-r.viewport,c=l-s,d=t==="ltr"?[0,a]:[a*-1,0],h=ge(e,d);return me([0,a],[0,c])(h)}function me(e,r){return t=>{if(e[0]===e[1]||r[0]===r[1])return r[0];const s=(r[1]-r[0])/(e[1]-e[0]);return r[0]+s*(t-e[0])}}function be(e,r){return e>0&&e<r}var qe=(e,r=()=>{})=>{let t={left:e.scrollLeft,top:e.scrollTop},s=0;return function n(){const l={left:e.scrollLeft,top:e.scrollTop},a=t.left!==l.left,c=t.top!==l.top;(a||c)&&r(),t=l,s=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(s)};function B(e,r){const t=_(e),s=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(s.current),[]),i.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(t,r)},[t,r])}function W(e,r){const t=_(r);xe(()=>{let s=0;if(e){const n=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(t)});return n.observe(e),()=>{window.cancelAnimationFrame(s),n.unobserve(e)}}},[e,t])}var Qe=le,Je=ae,Ze=fe;function Ge({className:e,children:r,...t}){return o.jsxs(Qe,{"data-slot":"scroll-area",className:A("relative",e),...t,children:[o.jsx(Je,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:r}),o.jsx(Ke,{}),o.jsx(Ze,{})]})}function Ke({className:e,orientation:r="vertical",...t}){return o.jsx(ce,{"data-slot":"scroll-area-scrollbar",orientation:r,className:A("flex touch-none p-px transition-colors select-none",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...t,children:o.jsx(he,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const nt=({isOpen:e,onClose:r,columns:t=[],visibleColumns:s=[],onApplyFilter:n,tableName:l,setSelectedColumns:a,selectedColumns:c})=>{const[d,h]=i.useState(""),[u,p]=i.useState(!1),[f,S]=i.useState(null),x=G(m=>m.user),R=x.owner_id===null?x.id:x.owner_id,I=G(m=>m.user),[j,T]=i.useState(!1);i.useEffect(()=>{(async()=>{try{const b=`https://click.wa.expert/api/reference/setup/check?owner_id=${R}&product_name=${l}`,{data:g}=await ee.get(b);g.exists&&g.setup?(p(!0),S(g.setup),a(Array.isArray(g.setup.filter_form_columns)?g.setup.filter_form_columns:[])):(p(!1),s.length>0?a(s):t.length>0&&a(t.map(O=>O.name||O))),T(!0)}catch{p(!1),s.length>0?a(s):t.length>0&&a(t.map(g=>g.name||g)),T(!0)}})()},[I.id,l]);const X=async m=>{const b="https://click.wa.expert/api/data/createRecord",g={schemaName:"public",tableName:"dropdown_setup",record:{owner_id:R,product_name:l,us_id:`${R}_${l}`,filter_form_columns:JSON.stringify(m)}};try{const O=await ee.post(b,g)}catch{}},N=m=>m.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase()),D=m=>{a(b=>b.includes(m)?b.filter(g=>g!==m):[...b,m])},y=t.filter(m=>{const b=m.name||m;return N(b).toLowerCase().includes(d.toLowerCase())}),z=()=>{const m=y.map(b=>b.name||b);a(m)},k=()=>{a([])},v=()=>{n(c),X(c),r()},w=()=>{const m=t.map(b=>b.name||b);a(m)},E=y.length>0&&y.every(m=>c.includes(m.name||m)),Z=y.some(m=>c.includes(m.name||m))&&!E;return o.jsx(Ne,{open:e,onOpenChange:r,children:o.jsxs(De,{side:"right",className:"filter-sheet",children:[o.jsxs(ze,{children:[o.jsx(Oe,{className:"filter-title",children:"Column Visibility"}),o.jsx(We,{className:"filter-description",children:"Select which columns you want to display in the table"})]}),o.jsxs("div",{className:"filter-content",children:[o.jsxs("div",{className:"filter-search",children:[o.jsx(we,{className:"icon icon-sm icon-secondary search-icon"}),o.jsx(ye,{type:"text",placeholder:"Search columns...",value:d,onChange:m=>h(m.target.value),className:"search-input"}),d&&o.jsx("button",{onClick:()=>h(""),className:"clear-search-btn","aria-label":"Clear search",children:o.jsx(oe,{className:"icon icon-xs"})})]}),o.jsxs("div",{className:"filter-actions",children:[o.jsxs("div",{className:"select-all-wrapper",children:[o.jsx(te,{id:"select-all",checked:E,onCheckedChange:m=>{m?z():k()},className:Z?"checkbox-indeterminate":""}),o.jsxs(K,{htmlFor:"select-all",className:"select-all-label",children:["Select All (",c==null?void 0:c.length,"/",t.length,")"]})]}),o.jsx($,{variant:"ghost",size:"sm",onClick:w,className:"reset-btn",children:"Reset"})]}),o.jsx(Ge,{className:"filter-scroll-area",children:o.jsx("div",{className:"column-list",children:y.length>0?y.map(m=>{const b=m.name||m,g=N(b),O=c.includes(b);return o.jsxs("div",{className:"column-item",children:[o.jsx(te,{id:`column-${b}`,checked:O,onCheckedChange:()=>D(b)}),o.jsx(K,{htmlFor:`column-${b}`,className:"column-label",children:g})]},b)}):o.jsx("div",{className:"no-results",children:o.jsxs("p",{children:['No columns found matching "',d,'"']})})})})]}),o.jsxs(ke,{className:"filter-footer",children:[o.jsx($,{variant:"outline",onClick:r,className:"cancel-btn",children:"Cancel"}),o.jsxs($,{onClick:v,className:"apply-btn",disabled:c.length===0,children:["Apply (",c.length,")"]})]})]})})};export{nt as default};
