import{r as d,b as $,a as q,j as e,C as U,g as X,D as Y,h as G,i as K,k as O,L as f,I as C,S as g,l as Q,o as v,p as w,q as S,t as y,v as T,B as i,w as Z,c as k,a2 as ee}from"./index-BECPHSeM.js";import{T as D,a as F,b as o,c as r,d as V,e as l}from"./table-ClZeedXs.js";import{C as ae}from"./checkbox-CraTRF2W.js";import{L as _}from"./lock-HOwiW_Ci.js";import{X as se}from"./x-WtqlxTpi.js";import{P as te}from"./plus-BPHhOq-4.js";import{S as le}from"./save-DH-CNVZ5.js";const ce=["Text","Number","Date","Boolean"],A=[{name:"id",type:"Text",defaultValue:"Auto",locked:!0},{name:"us_id",type:"Text",locked:!0},{name:"assigned_to",type:"Text",defaultValue:"-",locked:!0}],be=({setShowDialog:I,columnFields:u})=>{const[re,de]=d.useState(""),B=$(),[m,L]=d.useState("jobstatus"),[n,h]=d.useState([]),[R,E]=d.useState(!1),j=q(a=>a.user),P=j.id,p=j.schema_name,[ne,ie]=d.useState(u),[b,z]=d.useState([]);function H(a){return a&&a.charAt(0).toUpperCase()+a.slice(1)}const N=a=>{const t={"character varying":"text",text:"text",character:"text","timestamp with time zone":"timestamp",ARRAY:"array"};return a.map(c=>({name:c.column_name,type:H(t[c.data_type]||c.data_type)}))};d.useEffect(()=>{(async()=>{const{data:t}=await k.post("https://click.wa.expert/api/secure/getTableStructure",{schemaName:p,tableName:"jobstatus"});z(N(t.data)),B(ee({jobStatusStructure:N(t.data)}))})()},[]);const x=(a,t,s)=>{const c=[...n];c[a][t]=s,h(c)},W=()=>{h([...n,{name:"",type:"Text",label:"",defaultValue:""}])},J=a=>{const t=n.filter((s,c)=>c!==a);h(t)},M=async()=>{const a=[...A,...n],t={table_name:m,fields:a,schema_name:p,id:P};try{const s=await k.post("https://click.wa.expert/api/secure/createTable",t);alert("Form submitted successfully!")}catch{alert("Creation failed! Please try again.")}};return e.jsxs(U,{className:"w-full max-w-4xl mx-auto shadow-md",children:[e.jsxs(X,{className:"pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-[#4285B4]"}),e.jsx(G,{children:"New Data Store"})]}),e.jsx(K,{children:"Configure your task management data store with custom fields"})]}),e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"title",children:"Data Store Title"}),e.jsx(C,{id:"title",placeholder:"Enter Data Store Title",value:m,disabled:!0,onChange:a=>L(a.target.value),className:"max-w-md"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{id:"showInChat",checked:R,onCheckedChange:E}),e.jsx(f,{htmlFor:"showInChat",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Show in Chat Interface"})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Predefined Fields"}),e.jsxs(Q,{variant:"outline",className:"bg-slate-100",children:[e.jsx(_,{className:"h-3 w-3 mr-1"})," Locked"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(D,{children:[e.jsx(F,{children:e.jsxs(o,{children:[e.jsx(r,{children:"Field Name"}),e.jsx(r,{children:"Type"}),e.jsx(r,{children:"Default Value"}),e.jsx(r,{className:"w-[50px]"})]})}),e.jsx(V,{children:(b.length>0?b:A).map((a,t)=>e.jsxs(o,{className:"bg-slate-50/50",children:[e.jsx(l,{className:"font-medium text-slate-500",children:a.name}),e.jsx(l,{className:"text-slate-500",children:a.type}),e.jsx(l,{className:"text-slate-500",children:a.label}),e.jsx(l,{className:"text-slate-500",children:a.defaultValue||"-"}),e.jsx(l,{children:e.jsx(_,{className:"h-3.5 w-3.5 text-slate-400"})})]},t))})]})})]}),e.jsx(g,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Custom Fields"}),n.length>0?e.jsx("div",{className:"rounded-md border mb-4",children:e.jsxs(D,{children:[e.jsx(F,{children:e.jsxs(o,{children:[e.jsx(r,{children:"Field Name"}),e.jsx(r,{children:"Type"}),e.jsx(r,{children:"Default Value"}),e.jsx(r,{className:"w-[80px]",children:"Actions"})]})}),e.jsx(V,{children:n.map((a,t)=>e.jsxs(o,{children:[e.jsxs(l,{children:[void 0,e.jsxs(v,{value:a.name,onValueChange:s=>x(t,"name",s),children:[e.jsx(w,{className:"w-full",children:e.jsx(S,{placeholder:"Type"})}),e.jsx(y,{children:u.map(s=>e.jsx(T,{value:s,children:s},s))})]})]}),e.jsx(l,{children:e.jsxs(v,{value:a.type,onValueChange:s=>x(t,"type",s),children:[e.jsx(w,{className:"w-full",children:e.jsx(S,{placeholder:"Type"})}),e.jsx(y,{children:ce.map(s=>e.jsx(T,{value:s,children:s},s))})]})}),e.jsx(l,{children:e.jsx(C,{placeholder:"Default Value",value:a.defaultValue,onChange:s=>x(t,"defaultValue",s.target.value)})}),e.jsx(l,{children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>J(t),className:"h-8 w-8 text-red-500 hover:text-red-600 hover:bg-red-50",children:e.jsx(se,{className:"h-4 w-4"})})})]},t))})]})}):e.jsxs("div",{className:"text-center py-8 border rounded-md bg-slate-50",children:[e.jsx("p",{className:"text-slate-500",children:"No custom fields added yet"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:'Click "Add Field" to create custom fields'})]}),e.jsxs(i,{variant:"outline",onClick:W,className:"gap-2 mt-2",children:[e.jsx(te,{className:"h-4 w-4"})," Add Field"]})]})]})}),e.jsxs(Z,{className:"flex justify-between border-t pt-4 mt-6",children:[e.jsx(i,{variant:"outline",onClick:()=>I(0),children:"Cancel"}),e.jsxs(i,{onClick:M,className:"gap-2 bg-[#4285B4] hover:bg-[#3778b4]",disabled:!m,children:[e.jsx(le,{className:"h-4 w-4"})," Create Data Store"]})]})]})};export{be as J};
