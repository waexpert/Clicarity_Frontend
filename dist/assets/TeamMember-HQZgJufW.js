import{e as $,u as G,r as c,a as J,j as e,C as K,g as X,x as Y,I as m,B as h,L as d,m as B,o as Z,p as q,q as ee,t as ae,v as u,k as se,l as b,c as I}from"./index-B9v0YaNK.js";import{D as re,a as te,b as ne,c as le,d as ie,e as ce,f as me}from"./dialog-CPc3Jo5t.js";import{T as de,a as oe,b as f,c as o,d as he,e as l}from"./table-B_CrrUnn.js";import{A as xe,a as pe}from"./alert-DHe3_cbN.js";import{P as je}from"./ProfileHeader-Bwd92inC.js";import{L as y}from"./loader-circle-BQyzDaOT.js";import{P as H}from"./plus-CPlSHrD4.js";import{B as ue}from"./building-DWymPPVE.js";import{C as fe}from"./circle-check-big-bWZg8RtU.js";import{S as ge}from"./square-pen-DmMf2spB.js";import{T as Ne}from"./trash-2-CeZ11CVa.js";import"./index--9-JJASu.js";import"./x-BdmiHPv3.js";/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],we=$("user-check",ve);/**
 * @license lucide-react v0.508.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_=$("user",be);function Ue(){G();const[C,R]=c.useState([]),[S,g]=c.useState([]),[M,z]=c.useState(""),[O,N]=c.useState(!0),[A,x]=c.useState(""),[V,v]=c.useState(!1),[s,i]=c.useState({first_name:"",last_name:"",email:"",password:"",phone_number:"",role:"member",department:"",manager_name:"",birthday:""}),[w,L]=c.useState(!1),n=J(a=>a.user),k=async()=>{var a;try{if(N(!0),x(""),!n||!n.schema_name)throw new Error("User schema not found. Please log in again.");const r=n.schema_name,p=(await I.post("https://click.wa.expert/api/data/getAllData",{schemaName:r,tableName:"team_member"})).data.data;R(p),g(p)}catch(r){let t="Failed to load team members. ";r.response?t+=`Server error (${r.response.status}): ${((a=r.response.data)==null?void 0:a.error)||r.response.statusText}`:r.request?t+="Please check if the server is running.":t+=r.message,x(t)}finally{N(!1)}},Q=async()=>{var a;try{if(L(!0),x(""),!n||!n.schema_name)throw new Error("User schema not found. Please log in again.");const r=n.schema_name,j=await I.post("https://click.wa.expert/api/secure/createTeamMember",{schemaName:r,userData:{first_name:s.first_name,last_name:s.last_name,email:s.email,password:s.password,phone_number:s.phone_number,role:s.role,department:s.department,manager_name:s.manager_name,birthday:s.birthday},owner:{country:n.country||"India",currency:n.currency||"INR",schemaName:n.schema_name,first_name:n.first_name||n.name||"Owner",id:n.id}});i({first_name:"",last_name:"",email:"",password:"",phone_number:"",role:"member",department:"",manager_name:"",birthday:""}),v(!1),await k()}catch(r){let t="Failed to add team member. ";r.response?t+=((a=r.response.data)==null?void 0:a.error)||r.response.statusText:t+=r.message,x(t)}finally{L(!1)}},D=a=>{if(z(a),!a.trim())g(C);else{const r=C.filter(t=>{var j,p,T,F,E,P,U;return((j=t.first_name)==null?void 0:j.toLowerCase().includes(a.toLowerCase()))||((p=t.last_name)==null?void 0:p.toLowerCase().includes(a.toLowerCase()))||((T=t.email)==null?void 0:T.toLowerCase().includes(a.toLowerCase()))||((F=t.role)==null?void 0:F.toLowerCase().includes(a.toLowerCase()))||((E=t.department)==null?void 0:E.toLowerCase().includes(a.toLowerCase()))||((P=t.manager_name)==null?void 0:P.toLowerCase().includes(a.toLowerCase()))||((U=t.phone_number)==null?void 0:U.includes(a))});g(r)}},W=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return a}};return c.useEffect(()=>{n&&n.schema_name?k():(x("User data not available. Please log in again."),N(!1))},[n]),n?e.jsxs("div",{className:"mx-[6rem] space-y-6 tableCard",children:[e.jsx(je,{}),A&&e.jsx(xe,{variant:"destructive",children:e.jsx(pe,{children:A})}),e.jsxs(K,{children:[e.jsxs(X,{children:[e.jsxs("div",{className:"space-y-1 mb-6",children:[e.jsx("h1",{className:"text-2xl font-medium text-slate-700",children:"Team Members"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Details of team member"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsx("div",{className:"flex-1 w-full sm:max-w-sm",children:e.jsxs("div",{className:"relative",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(m,{placeholder:"Search by name, email, department, or role",value:M,onChange:a=>D(a.target.value),className:"pl-10"})]})}),e.jsxs(re,{open:V,onOpenChange:v,children:[e.jsx(te,{asChild:!0,children:e.jsxs(h,{className:"w-full sm:w-auto",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Team Member"]})}),e.jsxs(ne,{className:"sm:max-w-[500px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(le,{children:[e.jsx(ie,{children:"Add New Team Member"}),e.jsx(ce,{children:"Fill in the details to add a new team member to your database."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Personal Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"first_name",children:"First Name *"}),e.jsx(m,{id:"first_name",value:s.first_name,onChange:a=>i({...s,first_name:a.target.value}),placeholder:"Enter first name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"last_name",children:"Last Name *"}),e.jsx(m,{id:"last_name",value:s.last_name,onChange:a=>i({...s,last_name:a.target.value}),placeholder:"Enter last name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email *"}),e.jsx(m,{id:"email",type:"email",value:s.email,onChange:a=>i({...s,email:a.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(m,{id:"phone_number",value:s.phone_number,onChange:a=>i({...s,phone_number:a.target.value}),placeholder:"Enter phone number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(d,{htmlFor:"birthday",className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-3 w-3"}),"Birthday"]}),e.jsx(m,{id:"birthday",type:"date",value:s.birthday,onChange:a=>i({...s,birthday:a.target.value})})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Account Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",children:"Password *"}),e.jsx(m,{id:"password",type:"password",value:s.password,onChange:a=>i({...s,password:a.target.value}),placeholder:"Enter password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"role",children:"Role *"}),e.jsxs(Z,{value:s.role,onValueChange:a=>i({...s,role:a}),children:[e.jsx(q,{children:e.jsx(ee,{placeholder:"Select role"})}),e.jsxs(ae,{children:[e.jsx(u,{value:"member",children:"Member"}),e.jsx(u,{value:"admin",children:"Admin"}),e.jsx(u,{value:"manager",children:"Manager"}),e.jsx(u,{value:"viewer",children:"Viewer"})]})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[e.jsxs("h3",{className:"text-sm font-semibold text-slate-700 flex items-center gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Work Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"department",children:"Department"}),e.jsx(m,{id:"department",value:s.department,onChange:a=>i({...s,department:a.target.value}),placeholder:"Enter department"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"manager_name",children:"Manager Name"}),e.jsx(m,{id:"manager_name",value:s.manager_name,onChange:a=>i({...s,manager_name:a.target.value}),placeholder:"Enter manager name"})]})]})]}),e.jsxs(me,{children:[e.jsx(h,{variant:"outline",onClick:()=>v(!1),disabled:w,children:"Cancel"}),e.jsx(h,{onClick:Q,disabled:w||!s.first_name.trim()||!s.last_name.trim()||!s.email.trim()||!s.password.trim(),children:w?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add Member"]})})]})]})]})]})]}),e.jsx(se,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(de,{children:[e.jsx(oe,{children:e.jsxs(f,{children:[e.jsx(o,{className:"w-[100px]",children:"Status"}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Email"}),e.jsx(o,{children:"Phone"}),e.jsx(o,{children:"Department"}),e.jsx(o,{children:"Manager"}),e.jsx(o,{children:"Role"}),e.jsx(o,{children:"Birthday"}),e.jsx(o,{className:"w-[100px]",children:"Actions"})]})}),e.jsx(he,{children:O?e.jsx(f,{children:e.jsx(l,{colSpan:9,className:"h-24 text-center",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(y,{className:"h-6 w-6 animate-spin mr-2"}),"Loading team members..."]})})}):S.length===0?e.jsx(f,{children:e.jsx(l,{colSpan:9,className:"h-24 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx(_,{className:"h-8 w-8 mb-2"}),e.jsx("p",{children:"No team members found."}),M&&e.jsx(h,{variant:"link",onClick:()=>D(""),className:"mt-1",children:"Clear search"})]})})}):S.map((a,r)=>e.jsxs(f,{children:[e.jsx(l,{children:e.jsxs(b,{variant:"secondary",className:"bg-green-100 text-green-700",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Active"]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:`${a.first_name||""} ${a.last_name||""}`.trim()||"N/A"})]})}),e.jsx(l,{children:e.jsx("span",{className:"text-sm",children:a.email||"N/A"})}),e.jsx(l,{children:e.jsx("span",{className:"font-mono text-sm",children:a.number||"N/A"})}),e.jsx(l,{children:e.jsx(b,{variant:"outline",children:a.department||"N/A"})}),e.jsx(l,{children:e.jsx("span",{className:"text-sm",children:a.manager_name||"N/A"})}),e.jsx(l,{children:e.jsx(b,{variant:"outline",className:"capitalize",children:a.role||"member"})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(B,{className:"h-3 w-3 text-muted-foreground"}),W(a.birthday)]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>{},children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>{},children:e.jsx(Ne,{className:"h-4 w-4 text-red-500"})})]})})]},a.id||r))})]})})})]})]}):e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(y,{className:"h-8 w-8 animate-spin mr-2"}),e.jsx("span",{children:"Loading user data..."})]})}export{Ue as default};
